<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Routines for the analysis of passive acoustic telemetry data • flapper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Routines for the analysis of passive acoustic telemetry data">
<meta property="og:description" content="Routines for the analysis of passive acoustic telemetry data, including for data processing, description (via detection statistics and movement metrics), modelling and simulation. These routines are supported by a series of helper functions (including distance calculators, spatial tools and parallelisation options). The main contribution is the provision of a family of algorithms for movement modelling in passive acoustic telemetry systems that permits the reconstruction of fine-scale movement paths and emergent patterns of space use. Package development has been motivated by passive acoustic telemetry data from a Critically Endangered benthic elasmobranch off the west coast of Scotland. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/flapper_algorithms_faqs.html">`flapper`: practitioner FAQs</a>
    </li>
    <li>
      <a href="articles/flapper_overview.html">`flapper`: an overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/edwardlavender/flapper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="flapper">flapper<a class="anchor" aria-label="anchor" href="#flapper"></a>
</h1></div>
<p><strong>Routines for the analysis of passive acoustic telemetry data, including the reconstruction of fine-scale movement paths and emergent patterns of space use. <a href="https://edwardlavender.github.io/flapper/" class="external-link uri">https://edwardlavender.github.io/flapper/</a></strong></p>
<p><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a> <a href="https://cran.r-project.org/package=flapper" class="external-link"><img src="http://www.r-pkg.org/badges/version/flapper" alt="CRAN_Status_Badge"></a></p>
<p><a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> is an <code>R</code> package which provides tools for passive acoustic telemetry data. The package has been particularly motivated by the collection of acoustic and archival data from a Critically Endangered elasmobranch, the flapper skate (<em>Dipturus intermedius</em>), off the west coast of Scotland where a static passive acoustic telemetry array was established to examine the movements of individuals within a Marine Protected Area. <a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> has been designed to complement existing packages for the analysis of these data (e.g. <a href="https://github.com/RossDwyer/VTrack" class="external-link">VTrack</a>, <a href="https://github.com/ocean-tracking-network/glatos" class="external-link">glatos</a> and <a href="https://github.com/aspillaga/fishtrack3d" class="external-link">fishtrack3d</a> and <a href="https://github.com/hugomflavio/actel" class="external-link">actel</a>), with a particular focus on the provision of movement modelling methods for passive acoustic telemetry systems that permit the reconstruction of fine-scale movement paths and emergent patterns of space use. To this end, <a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> contains functions in the following themes:</p>
<ul>
<li>
<strong>Data processing tools</strong>, including data assembly (e.g., range-testing datasets), the evaluation of false detections and quality checks;</li>
<li>
<strong>Spatial tools</strong>, including common spatial operations for the manipulation of spatial data, such as polygon inversion;</li>
<li>
<strong>Distance calculations</strong>, including the calculation of distances between receivers, along 3-dimensional movement paths, and of the shortest paths over a surface;</li>
<li>
<strong>Detection statistics</strong>, including metrics of sampling effort, such as detection area; and individual detection metrics, such as detection days and co-occurrence;</li>
<li>
<strong>Modelling methods</strong>, including a straightforward implementation of the mean-position algorithm for the estimation of centres of activity and new algorithms designed for improved estimates of space use and the reconstruction of movement paths;</li>
<li>
<strong>Simulation tools</strong>, including tools for the simulation of passive acoustic telemetry arrays, movement paths, detections and the comparison of simulated and reconstructed patterns of space use under different conditions;</li>
</ul>
<p><img src="articles/readme_context.png"><em>flapper: An <code>R</code> package of routines for the analysis of passive acoustic telemetry data, especially the reconstruction of fine-scale movement paths and emergent patterns of space use. Inserted sample depth and acoustic time series were collected as part of the Movement Ecology of Flapper Skate project by Marine Scotland Science and NatureScot. The insert of the flapper skate is also courtesy of this project. The bathymetry data are sourced from the Ireland, Northern Island and Scotland Hydrographic survey (Howe et al., 2014). Plots were produced using the <a href="https://github.com/edwardlavender/prettyGraphics" class="external-link">prettyGraphics</a> package.</em></p>
<p><strong>For full package details, vignettes and illustrated examples, go to <a href="https://edwardlavender.github.io/flapper/" class="external-link uri">https://edwardlavender.github.io/flapper/</a>.</strong></p>
<div class="section level2">
<h2 id="highlights">Highlights<a class="anchor" aria-label="anchor" href="#highlights"></a>
</h2>
<p>The main highlights of the package are the provision of routines for the rapid calculation of biologically meaningful distances in areas with complex barriers to movement (e.g., coastline) alongside algorithms (most of which are exclusive to <a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a>) for reconstructing movements and patterns of space use from discrete detections at receivers, especially:</p>
<ul>
<li>
<strong><code>lcp_*()</code>.</strong> These functions facilitate the calculation of shortest paths and their distances between and around points using efficient <code>C++</code> algorithms from the <a href="https://github.com/vlarmet/cppRouting" class="external-link">cppRouting</a> package. This makes it easy to use biologically meaningful distances (that account for the bathymetric surface over which a benthic animal must move, if applicable, and barriers to movement) in movement models.</li>
<li>
<strong><code><a href="reference/coa.html">coa()</a></code>.</strong> This function implements the arithmetic version of the mean-position algorithm to estimate centres of activity (COAs) from discrete detections at receivers, given a detection matrix and the locations of receivers.</li>
<li>
<strong><code><a href="reference/ac.html">ac()</a></code>.</strong> The function implements the acoustic-container (AC) algorithm. This is a new approach which utilises the information provided by acoustic detections in the form of acoustic containers to reconstruct the expected time spent in different parts of a study area over the period of observations. Key innovations of this approach include the natural incorporation of barriers to movement (such as coastline), detection probability and information provided by the gaps between detections.</li>
<li>
<strong><code><a href="reference/dc.html">dc()</a></code>.</strong> This function implements the ‘depth-contour’ (DC) algorithm. This relates one-dimensional depth time series to a two-dimensional bathymetry surface to determine the extent to which different parts of an area might have (or have not) been used, or effectively represent occupied depths, over time.</li>
<li>
<strong><code><a href="reference/acdc.html">acdc()</a></code>.</strong> This function implements the ‘acoustic-container depth-contour’ (ACDC) algorithm. This integrates the locational information provided by acoustic detections and concurrent depth observations to refine expectations of the time spent in different parts of a study area over the period of observations.</li>
<li>
<strong><code><a href="reference/pf.html">pf()</a></code></strong> is a particle filtering routine that refines time-specific maps of the possible locations of an animal (from <code><a href="reference/ac.html">ac()</a></code>, <code><a href="reference/dc.html">dc()</a></code> or <code><a href="reference/acdc.html">acdc()</a></code>) via a particle simulation and filtering process that permits the reconstruction of movement paths over landscape.</li>
<li>
<strong><code>sim_*()</code>.</strong> These functions provide flexible, joined-up routines for the simulation of receiver arrays, movement paths and detections.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>This package requires <code>R</code> version ≥ 4.0. You can check your current version with <code>R.version.string</code>. Subsequent installation steps (may) require the <code>devtools</code> and <code>pkgbuild</code> packages, which can be installed with <code>install.packages(c("devtools", "pkgbuild"))</code>. On Windows, package building requires <code>Rtools</code>. You can check whether <code>Rtools</code> is installed with <code><a href="https://pkgbuild.r-lib.org/reference/has_rtools.html" class="external-link">pkgbuild::has_rtools()</a></code>. If <code>Rtools</code> is not installed, it is necessary to download and install the appropriate version of <code>Rtools</code> before proceeding by following the instructions <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">here</a>.</p>
<p>Four packages (<a href="https://github.com/edwardlavender/prettyGraphics" class="external-link">prettyGraphics</a>, <a href="https://github.com/edwardlavender/Tools4ETS" class="external-link">Tools4ETS</a>, <a href="https://github.com/adamlilith/fasterRaster" class="external-link">fasterRaster</a> and <a href="https://github.com/ocean-tracking-network/glatos" class="external-link">glatos</a>) are required or suggested from <a href="https://github.com" class="external-link">GitHub</a> repositories (since they are not currently available from <a href="https://cran.r-project.org" class="external-link">CRAN</a>). These can be installed during the installation process (see below), but it is safer to install them sequentially as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"edwardlavender/prettyGraphics"</span>) <span class="co"># required</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"edwardlavender/Tools4ETS"</span>)      <span class="co"># required</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"adamlilith/fasterRaster"</span>)       <span class="co"># suggested</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"ocean-tracking-network/glatos"</span>) <span class="co"># suggested</span></span></code></pre></div>
<p>To install these packages with their vignettes, add <code>dependencies = TRUE</code> and <code>build_vignettes = TRUE</code> as arguments to the code above (see <code><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">?devtools::install_github</a></code> or <code><a href="https://remotes.r-lib.org/reference/install_url.html" class="external-link">?devtools::install_url</a></code> for further information). Then, you can install the development version of <a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> from <a href="https://github.com/edwardlavender/flapper" class="external-link">GitHub</a> as shown below:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"edwardlavender/flapper"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The <code>dependencies = TRUE</code> argument will also install any suggested packages, which are required by some functions/examples and to build vignettes (which will be added to the package in due course). To access the vignettes, use <code>vignette("flapper_intro", package = "flapper")</code> for a general introduction to the package. <em>Note that vignettes have not yet been added to the package.</em></p>
</div>
<div class="section level2">
<h2 id="example-datasets">Example datasets<a class="anchor" aria-label="anchor" href="#example-datasets"></a>
</h2>
<p>A key feature of the <a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> package is that most functions are designed to be implemented using standard object types (e.g., dataframes and matrices) rather than package-specific object classes. For simplicity, <a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> makes some assumptions about variable names that follow a consistent and logical structure (e.g., individual IDs are given as <code>individual_id</code> and receiver IDs are given as <code>receiver_id</code>) but, notwithstanding this framework, this structure means that the functions in the package are accessible and straightforward to use.</p>
<p>Functions are illustrated using simulated data and the following sample data collected from flapper skate off the west coast of Scotland:</p>
<ul>
<li>
<code>dat_ids</code> is a dataset containing the characteristics of a sample of tagged flapper skate;</li>
<li>
<code>dat_moorings</code> is a dataset containing some sample passive acoustic telemetry receiver locations and associated information;</li>
<li>
<code>dat_acoustics</code> is a dataset containing some sample detection time series;</li>
<li>
<code>dat_archival</code> is a dataset containing some sample depth time series;</li>
<li>
<code>dat_sentinel</code> is a dataset containing some sample transmission–detection time series assembled from sentinel tags;</li>
</ul>
<p>These example datasets were collected by Marine Scotland Science and NatureScot as part of the Movement Ecology of Flapper Skate project and belong to these organisations. If you wish to use these data, please contact Marine Scotland Science and NatureScot for further information.</p>
</div>
<div class="section level2">
<h2 id="data-processing-tools">Data processing tools<a class="anchor" aria-label="anchor" href="#data-processing-tools"></a>
</h2>
<p>A number of functions facilitate the acquisition, assembly, processing and checking of passive acoustic telemetry time series:</p>
<ul>
<li>
<strong>Data acquisition.</strong>
<ul>
<li>
<code>query_*()</code> functions query online databases:
<ul>
<li>
<code><a href="reference/query_open_topo.html">query_open_topo()</a></code> queries the Topo Data Application Programming Interface for elevation/bathymetry data;</li>
</ul>
</li>
</ul>
</li>
<li>
<strong>Data assembly.</strong>
<ul>
<li>
<code><a href="reference/assemble_sentinel_counts.html">assemble_sentinel_counts()</a></code> assembles counts of transmissions/detections from sentinel tags for modelling purposes (i.e., to model detection probability);</li>
<li>
<code>make_matrix_*()</code> functions create matrices of individual and receiver deployment time series and detection time series:
<ul>
<li>
<code><a href="reference/make_matrix_ids.html">make_matrix_ids()</a></code> matricises individual deployment time series;</li>
<li>
<code><a href="reference/make_matrix_receivers.html">make_matrix_receivers()</a></code> matricises receiver deployment time series;</li>
<li>
<code><a href="reference/make_matrix_detections.html">make_matrix_detections()</a></code> matricises detection time series;</li>
</ul>
</li>
<li>
<code>make_df_*()</code> functions (i.e., <code><a href="reference/make_df_detections.html">make_df_detections()</a></code>) reverse this process;</li>
</ul>
</li>
<li>
<strong>Data processing.</strong>
<ul>
<li>
<code><a href="reference/process_receiver_id.html">process_receiver_id()</a></code> adds unique receiver IDs to a dataframe (i.e., if the same receiver has been deployed more than once);</li>
<li>
<code><a href="reference/process_false_detections_sf.html">process_false_detections_sf()</a></code> passes putative false detections through a spatial filter which incorporates information on receiver locations and animal swimming speeds to interrogate their plausibility;</li>
<li>
<code><a href="reference/process_quality_check.html">process_quality_check()</a></code> passes acoustic data through some basic quality checks prior to analysis;</li>
<li>
<code><a href="reference/process_surface.html">process_surface()</a></code> determines an ‘optimum’ raster aggregation method and error induced by this process;</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="spatial-tools">Spatial tools<a class="anchor" aria-label="anchor" href="#spatial-tools"></a>
</h2>
<p>A number of functions facilitate spatial operations that support common tasks and modelling algorithms:</p>
<ul>
<li>
<code><a href="reference/buffer_and_crop.html">buffer_and_crop()</a></code> buffers a spatial object (e.g., receiver locations) and uses this buffered object to crop another (e.g., the local bathymetry);</li>
<li>
<code><a href="reference/get_intersection.html">get_intersection()</a></code> intersects spatial geometries;</li>
<li>
<code><a href="reference/xy_from_click.html">xy_from_click()</a></code> gets location coordinates from mouse clicks;</li>
<li>
<code><a href="reference/crop_from_click.html">crop_from_click()</a></code> crops a raster to an area defined by mouse clicks;</li>
<li>
<code><a href="reference/cells_from_val.html">cells_from_val()</a></code> returns the cells (or a raster of the cells) of a raster that are equal to a specified value or lie within a specified range of values;</li>
<li>
<code><a href="reference/invert_poly.html">invert_poly()</a></code> inverts a polygon (e.g, to define the ‘sea’ from a polygon of the ‘land’);</li>
<li>
<code><a href="reference/mask_io.html">mask_io()</a></code> masks values in a raster that lie inside or outside of a spatial mask (e.g., to mask the ‘land’ from the ‘sea’);</li>
<li>
<code><a href="reference/sim_surface.html">sim_surface()</a></code> populates a raster with simulated values;</li>
<li>
<code><a href="reference/split_raster_equally.html">split_raster_equally()</a></code> splits a raster into equal pieces (using code from the <a href="http://greenbrown.r-forge.r-project.org" class="external-link">greenbrown</a> package);</li>
<li>
<code><a href="reference/update_extent.html">update_extent()</a></code>shrinks or inflates an extent object;</li>
<li>
<code><a href="reference/segments_cross_barrier.html">segments_cross_barrier()</a></code> determines if Euclidean transects cross a barrier;</li>
</ul>
</div>
<div class="section level2">
<h2 id="distance-calculations">Distance calculations<a class="anchor" aria-label="anchor" href="#distance-calculations"></a>
</h2>
<p>Some functions facilitate standard distance calculations using Euclidean distances:</p>
<ul>
<li>
<code><a href="reference/dist_btw_clicks.html">dist_btw_clicks()</a></code> calculates distances and draws segments between sequential mouse clicks on a map;</li>
<li>
<code><a href="reference/dist_btw_receivers.html">dist_btw_receivers()</a></code> calculates the Euclidean distances between all combinations of receivers;</li>
<li>
<code><a href="reference/dist_btw_points_3d.html">dist_btw_points_3d()</a></code> calculates the Euclidean distances between points in three-dimensional space;</li>
<li>
<code><a href="reference/dist_over_surface.html">dist_over_surface()</a></code> calculates the total Euclidean distance along a path over a three-dimensional surface;</li>
</ul>
<p>Often, Euclidean distances may not be a suitable representation of distance. This is especially the case for coastal benthic/demersal species in bathymetrically complex environments, for which navigation between locations may require movement over hilly terrain and around coastline. For this reason, a number of functions facilitate the calculation of shortest paths/distances:</p>
<ul>
<li>
<code><a href="reference/lcp_costs.html">lcp_costs()</a></code> calculates the distances between connected cells in a raster, accounting for planar (x, y, diagonal) and vertical (z) distances;</li>
<li>
<code><a href="reference/lcp_graph_surface.html">lcp_graph_surface()</a></code> constructs connected graphs for least-cost paths analysis;</li>
<li>
<code><a href="reference/lcp_from_point.html">lcp_from_point()</a></code> calculates least-cost distances from a point on a raster to all of the other cells of a raster;</li>
<li>
<code><a href="reference/lcp_over_surface.html">lcp_over_surface()</a></code> calculates shortest path(s) and/or the distances of the shortest path(s) over a surface between origin and destination coordinates;</li>
<li>
<code><a href="reference/lcp_interp.html">lcp_interp()</a></code> interpolates paths between sequential locations using least-cost paths analysis;</li>
<li>
<code><a href="reference/lcp_comp.html">lcp_comp()</a></code> compares Euclidean and shortest-distance metrics for an area;</li>
</ul>
</div>
<div class="section level2">
<h2 id="detection-statistics">Detection statistics<a class="anchor" aria-label="anchor" href="#detection-statistics"></a>
</h2>
<p>A number of functions facilitate the calculation of detection statistics, including those related to sampling effort and to detections of individuals:</p>
<ul>
<li>
<code><a href="reference/get_detection_pr.html">get_detection_pr()</a></code> calculates detection probability given a model for detection probability with distance;</li>
<li>
<code><a href="reference/get_detection_containers.html">get_detection_containers()</a></code> defines detection containers (areas within the maximum detection range) around receivers;</li>
<li>
<code><a href="reference/get_detection_containers_overlap.html">get_detection_containers_overlap()</a></code> identifies receivers with overlapping detection containers in space and time;</li>
<li>
<code><a href="reference/get_detection_containers_envir.html">get_detection_containers_envir()</a></code> extracts environmental conditions from within receiver detection ranges, accounting for detection probability;</li>
<li>
<code><a href="reference/get_detection_area_sum.html">get_detection_area_sum()</a></code> calculates the total area surveyed by receivers;</li>
<li>
<code><a href="reference/get_detection_area_ts.html">get_detection_area_ts()</a></code> defines a time series of the area surveyed by receivers;</li>
<li>
<code><a href="reference/get_n_operational_ts.html">get_n_operational_ts()</a></code>defines a time series of the number of operational units (e.g., individuals at liberty or active receivers)</li>
<li>
<code><a href="reference/get_id_rec_overlap.html">get_id_rec_overlap()</a></code> calculates the overlap between the deployment periods of tagged individuals and receivers;</li>
<li>
<code><a href="reference/get_detection_days.html">get_detection_days()</a></code> calculates the total number of days during which each individual was detected (termed ‘detection days’);</li>
<li>
<code><a href="reference/get_detection_clumps.html">get_detection_clumps()</a></code> identifies detection ‘clumps’ and calculates their lengths;</li>
<li>
<code><a href="reference/get_detection_overlaps.html">get_detection_overlaps()</a></code> identifies ‘overlapping’ detections;</li>
<li>
<code><a href="reference/get_residents.html">get_residents()</a></code> identifies ‘resident’ individuals;</li>
<li>
<code><a href="reference/make_matrix_cooccurence.html">make_matrix_cooccurence()</a></code> computes a detection history similarity matrix across individuals;</li>
</ul>
</div>
<div class="section level2">
<h2 id="movement-metrics">Movement metrics<a class="anchor" aria-label="anchor" href="#movement-metrics"></a>
</h2>
<p>Building on the analysis of detection time series, some functions (<code>get_mvt_*()</code>) provide movement metrics:</p>
<ul>
<li>
<code>get_mvt_mobility_*()</code> functions estimate swimming speeds:
<ul>
<li>
<code><a href="reference/get_mvt_mobility.html">get_mvt_mobility_from_acoustics()</a></code> estimates swimming speeds from acoustic detections;</li>
<li>
<code><a href="reference/get_mvt_mobility.html">get_mvt_mobility_from_archival()</a></code> estimates swimming speeds from archival time series;</li>
</ul>
</li>
<li>
<code><a href="reference/get_mvt_resting.html">get_mvt_resting()</a></code> identifies ‘resting’ behaviour from archival time series;</li>
<li>
<code>get_hr_*()</code> functions get animal ‘home ranges’:
<ul>
<li>
<code><a href="reference/get_hr.html">get_hr_prop()</a></code> gets a custom range from a utilisation distribution (UD);</li>
<li>
<code><a href="reference/get_hr.html">get_hr_core()</a></code> gets the ‘core range’ from a UD;</li>
<li>
<code><a href="reference/get_hr.html">get_hr_home()</a></code> gets the ‘home range’ from a UD;</li>
<li>
<code><a href="reference/get_hr.html">get_hr_full()</a></code> gets the ‘full range’ from a UD;</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="modelling-algorithms">Modelling algorithms<a class="anchor" aria-label="anchor" href="#modelling-algorithms"></a>
</h2>
<p>The main thrust of <a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> is the implementation of algorithms designed to reconstruct fine-scale movement paths and emergent patterns of space use in passive acoustic telemetry systems.</p>
<div class="section level3">
<h3 id="the-centres-of-activity-coa-algorithm">The centres of activity (COA) algorithm<a class="anchor" aria-label="anchor" href="#the-centres-of-activity-coa-algorithm"></a>
</h3>
<p>Centres of activity (COA) are one of the most widely used metrics for the reconstruction of patterns of space use from passive acoustic telemetry data. Several methods have been developed to calculate COAs, but the mean-position algorithm is the commonest. To generate estimates of space use, COAs are usually taken as point estimates from which UDs (typically kernel UDs or KUDs) are estimated. <a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> facilitates the implementation of this approach with the following functions:</p>
<ul>
<li>
<code><a href="reference/coa_setup_delta_t.html">coa_setup_delta_t()</a></code> informs decisions as to an appropriate time interval over which to calculate COAs;</li>
<li>
<code><a href="reference/make_matrix_detections.html">make_matrix_detections()</a></code> summarises detections over time intervals (see above);</li>
<li>
<code><a href="reference/coa.html">coa()</a></code> implements the arithmetic version of the mean-position algorithm to calculate COAs;</li>
<li>
<code><a href="reference/kud_habitat.html">kud_habitat()</a></code>, <code><a href="reference/kud_around_coastline.html">kud_around_coastline()</a></code> and <code><a href="reference/kud_around_coastline.html">kud_around_coastline_fast()</a></code> facilitate the estimation of home ranges (e.g., from estimated COAs) in areas of complex coastline;</li>
</ul>
</div>
<div class="section level3">
<h3 id="the-flapper-family-of-algorithms">The <a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> family of algorithms<a class="anchor" aria-label="anchor" href="#the-flapper-family-of-algorithms"></a>
</h3>
<p>Alongside the COA algorithm, this package introduces the <a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> of algorithms for the inferring patterns of space use.</p>
<p><img src="articles/readme_flapper_family_implementation.png"><em>The ‘flapper’ family of algorithms. The acoustic-container (AC) branch utilises acoustic data (and/or ancillary information) to reconstruct the set of possible locations for an individual through time. The particle filtering (PF) branch refines this set via the implementation of a particle simulation and filtering approach for the reconstruction of possible movement paths.</em></p>
</div>
<div class="section level3">
<h3 id="acdc-branch-algorithms">AC/DC branch algorithms<a class="anchor" aria-label="anchor" href="#acdc-branch-algorithms"></a>
</h3>
<div class="section level4">
<h4 id="the-depth-contour-dc-algorithm">The depth-contour (DC) algorithm<a class="anchor" aria-label="anchor" href="#the-depth-contour-dc-algorithm"></a>
</h4>
<p>The depth-contour (DC) algorithm is the simplest. Whereas the COA approach only makes use of detections, the DC approach only uses depth observations. Specifically, this algorithm uses observed depths (± some error) to define the subset of possible locations of each individual within a defined area: for pelagic species, tagged individuals must be in an area where the seabed depth is at least as deep as the observed depth; for benthic/demersal species, tagged individuals must be in an area where the seabed depth is close to the observed depth. This is implemented via <code><a href="reference/dc.html">dc()</a></code>. The ‘quick’ depth-contour (DCQ) algorithm, implemented via <code><a href="reference/dcq.html">dcq()</a></code>, uses a modified version of this algorithm for quicker run times.</p>
</div>
<div class="section level4">
<h4 id="the-acoustic-container-ac-algorithms">The acoustic-container* (AC*) algorithm(s)<a class="anchor" aria-label="anchor" href="#the-acoustic-container-ac-algorithms"></a>
</h4>
<p>The <a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> family-equivalent of the COA algorithm is the acoustic-container (AC) algorithm. This approach represents the information from acoustic detections in the form of acoustic containers, which contract and expand in line with our uncertainty in an individual’s location when it is detected and in the gaps between detections. The acoustic-container depth-contour (ACDC) algorithm combines the AC and DC algorithms, using passive acoustic telemetry data to inform the area within which depth contours are most likely to be found. These algorithms are implemented with the <code>ac*()</code> family of functions:</p>
<ul>
<li>
<code><a href="reference/acs_setup_mobility.html">acs_setup_mobility()</a></code> examines the assumption of a constant ‘mobility’ parameter;</li>
<li>
<code><a href="reference/acs_setup_containers.html">acs_setup_containers()</a></code> defines the detection containers for the algorithm(s);</li>
<li>
<code><a href="reference/acs_setup_detection_kernels.html">acs_setup_detection_kernels()</a></code> defines detection probability kernels for the algorithm(s);</li>
<li>
<code><a href="reference/ac.html">ac()</a></code> and <code><a href="reference/acdc.html">acdc()</a></code> implement the algorithm(s), via the back-end functions <code><a href="reference/dot-acs_pl.html">.acs_pl()</a></code> and <code><a href="reference/dot-acs.html">.acs()</a></code>;</li>
</ul>
</div>
<div class="section level4">
<h4 id="acdc-post-processing-and-analysis">AC/DC post-processing and analysis<a class="anchor" aria-label="anchor" href="#acdc-post-processing-and-analysis"></a>
</h4>
<p>The AC-branch functions (<code><a href="reference/ac.html">ac()</a></code>, <code><a href="reference/dc.html">dc()</a></code> and <code><a href="reference/acdc.html">acdc()</a></code>) all return objects of class <code>acdc_archive</code>. These can be processed and analysed using several key functions:</p>
<ul>
<li>
<code><a href="reference/acdc_simplify.html">acdc_simplify()</a></code> simplifies <code>acdc_archive-class</code> objects into <code>acdc_record-class</code> objects;</li>
<li>
<code>acdc_access_*()</code> functions provide short-cuts to different elements of <code>acdc_record-class</code> objects:
<ul>
<li>
<code><a href="reference/acdc_access.html">acdc_access_dat()</a></code> accesses stored dataframes;</li>
<li>
<code><a href="reference/acdc_access.html">acdc_access_timesteps()</a></code> accesses the total number of time steps;</li>
<li>
<code><a href="reference/acdc_access.html">acdc_access_maps()</a></code> accesses stored maps;</li>
</ul>
</li>
<li>
<code><a href="reference/acdc_plot_trace.html">acdc_plot_trace()</a></code> plots acoustic container dynamics;</li>
<li>
<code><a href="reference/acdc_plot_record.html">acdc_plot_record()</a></code> plots the results of the algorithm(s);</li>
<li>
<code><a href="reference/acdc_animate_record.html">acdc_animate_record()</a></code> creates html animations of algorithm(s);</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="particle-filtering-branch-algorithms">Particle filtering branch algorithms<a class="anchor" aria-label="anchor" href="#particle-filtering-branch-algorithms"></a>
</h3>
<p>Each algorithm (AC, DC and ACDC) can be extended through incorporation of a movement model to reconstruct movement paths over a surface that are consistent with the observations (and model assumptions). The resultant algorithms are termed the ACPF, DCPF and ACDCPF algorithms. The approach is implemented via a particle simulation and filtering process provided by the <code>pf*()</code> family of functions:</p>
<ul>
<li>
<code>pf_setup_movement_pr</code> provides a simple movement model that defines the probability of movement between locations given the distance between them;</li>
<li>
<code><a href="reference/pf_setup_record.html">pf_setup_record()</a></code> creates an ordered list of input files;</li>
<li>
<code><a href="reference/pf_setup_optimisers.html">pf_setup_optimisers()</a></code> controls optimisation settings;</li>
<li>
<code><a href="reference/pf.html">pf()</a></code> implements the particle filtering routine;</li>
<li>
<code><a href="reference/pf_access_history_files.html">pf_access_history_files()</a></code> lists particle histories saved to file;</li>
<li>
<code><a href="reference/pf_access_history.html">pf_access_history()</a></code> accesses particle histories;</li>
<li>
<code><a href="reference/pf_access_particles_unique.html">pf_access_particles_unique()</a></code> accesses unique particle samples;</li>
<li>
<code><a href="reference/pf_plot_history.html">pf_plot_history()</a></code> plots particle histories;</li>
<li>
<code><a href="reference/pf_animate_history.html">pf_animate_history()</a></code> animates particle histories;</li>
<li>
<code><a href="reference/pf_simplify.html">pf_simplify()</a></code> processes particle histories and assembles movement paths;</li>
<li>
<code><a href="reference/pf_plot_map.html">pf_plot_map()</a></code> maps the expected ‘proportion-of-use’ (POU) across an area based on sampled particles or reconstructed paths;</li>
<li>
<code><a href="reference/pf_kud.html">pf_kud()</a></code> smooths POU maps using kernel smoothing;</li>
<li>
<code><a href="reference/pf_kud_.html">pf_kud_1()</a></code> and <code><a href="reference/pf_kud_.html">pf_kud_2()</a></code> apply kernel smoothing to sampled particles or reconstructed paths;</li>
<li>
<code><a href="reference/pf_loglik.html">pf_loglik()</a></code> calculates the log-probability of reconstructed paths, given the movement model;</li>
<li>
<code><a href="reference/pf_plot_1d.html">pf_plot_1d()</a></code> plots the depth time series from observed and reconstructed paths;</li>
<li>
<code><a href="reference/pf_plot_2d.html">pf_plot_2d()</a></code> maps the reconstructed paths in two-dimensions;</li>
<li>
<code><a href="reference/pf_plot_3d.html">pf_plot_3d()</a></code> maps the reconstructed paths in three-dimensions;</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="simulation-tools">Simulation tools<a class="anchor" aria-label="anchor" href="#simulation-tools"></a>
</h2>
<p><a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> provides joined-up routines for the simulation of acoustic arrays, movement paths and detections at receivers:</p>
<ul>
<li>
<code><a href="reference/sim_array.html">sim_array()</a></code> simulates alternative array designs;<br>
</li>
<li>
<code>sim_path_*()</code> functions simulate discrete-time movement paths, including:
<ul>
<li>
<code><a href="reference/sim_path_sa.html">sim_path_sa()</a></code>, supported by <code><a href="reference/sim_path_sa.html">sim_steps()</a></code> and <code><a href="reference/sim_path_sa.html">sim_angles()</a></code>, simulates movement paths (possibly in restricted areas) from step lengths and turning angles;</li>
<li>
<code><a href="reference/sim_path_ou_1.html">sim_path_ou_1()</a></code> simulates movement paths under Ornstein-Uhlenbeck processes;</li>
</ul>
</li>
<li>
<code><a href="reference/sim_detections.html">sim_detections()</a></code> simulates detections at receivers arising from movement paths under a diversity of detection probability models;</li>
</ul>
<p>To evaluate the performance of alternative algorithms for reconstructing patterns of space use under different array designs, movement models and detections models, <code><a href="reference/eval_by_kud.html">eval_by_kud()</a></code> compares patterns of space use reconstructed from simulated and estimated movement paths using KUDs.</p>
</div>
<div class="section level2">
<h2 id="parallelisation-routines">Parallelisation routines<a class="anchor" aria-label="anchor" href="#parallelisation-routines"></a>
</h2>
<p>Parallelisation in <a href="https://edwardlavender.github.io/flapper/" class="external-link"><code>flapper</code></a> is facilitated by the <code>cl_*()</code> function family:</p>
<ul>
<li>
<code><a href="reference/cl.html">cl_lapply()</a></code> is a wrapper for <code><a href="https://rdrr.io/pkg/pbapply/man/pbapply.html" class="external-link">pbapply::pblapply()</a></code> that handles cluster checking set up and closure, using the following functions:
<ul>
<li>
<code><a href="reference/cl.html">cl_check()</a></code> checks a cluster;</li>
<li>
<code><a href="reference/cl.html">cl_cores()</a></code> identifies the number of cores;</li>
<li>
<code><a href="reference/cl.html">cl_chunks()</a></code> defines chunks for parallelisation;</li>
<li>
<code><a href="reference/cl.html">cl_export()</a></code> exports objects required by a cluster;</li>
<li>
<code><a href="reference/cl.html">cl_stop()</a></code> closes a cluster;</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="associated-packages">Associated packages<a class="anchor" aria-label="anchor" href="#associated-packages"></a>
</h2>
<ul>
<li>
<strong><a href="https://github.com/edwardlavender/prettyGraphics" class="external-link">prettyGraphics</a></strong> facilitates the production of pretty, publication-quality and interactive visualisations, with a particular focus on time series. This makes it easy to create abacus plots, visualise time series (across factor levels, at different temporal scales and in relation to covariates), bathymetric landscapes and movement pathways in three-dimensions, and detection similarity matrices.</li>
<li>
<strong><a href="https://github.com/edwardlavender/Tools4ETS" class="external-link">Tools4ETS</a></strong> provides a set of general tools for ecological time series, including for the definition of time categories, matching time series (e.g., detection observations with temporally varying environmental covariates), flagging independent time series and simulations.</li>
<li>
<strong><a href="https://github.com/edwardlavender/fvcom.tbx" class="external-link">fvcom.tbx</a></strong> provides tools for the integration of hydrodynamic model predictions (from the Finite Volume Coastal Ocean Model) with ecological datasets (e.g., detection time series). This facilitates the inclusion of hydrodynamic model predictions as covariates in movement models and the validation of hydrodynamic model predictions with movement datasets or data collected from static acoustic receivers. This package was particularly motivated by the West Scotland Coastal Ocean Modelling System (WeStCOMS).</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Howe, J. A. et al. (2014). The seabed geomorphology and geological structure of the Firth of Lorn, western Scotland, UK, as revealed by multibeam echo-sounder survey. Earth Environ. Sci. Trans. R. Soc. Edinburgh 105, 273–284. <a href="https://doi.org/10.1017/S1755691015000146" class="external-link uri">https://doi.org/10.1017/S1755691015000146</a></p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Lavender, E. et al. (2023). An integrative modelling framework for passive acoustic telemetry. Methods in Ecology and Evolution. <a href="https://doi.org/10.1111/2041-210X.14193" class="external-link uri">https://doi.org/10.1111/2041-210X.14193</a></p>
<hr>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/edwardlavender/flapper/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/edwardlavender/flapper/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing flapper</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Edward Lavender <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
