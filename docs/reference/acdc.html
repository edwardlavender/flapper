<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The acoustic-container depth-contour (ACDC) algorithm — acdc • flapper</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="The acoustic-container depth-contour (ACDC) algorithm — acdc" />
<meta property="og:description" content="This function implements the acoustic-container depth-contour (ACDC) algorithm. This is an extension of the AC algorithm implemented by ac that that integrates acoustic detections and depth observations to the expected time spent in different parts of a study area over the period of observations. To implement the function, a dataframe (or list) of passive acoustic telemetry detections is required (acoustics), alongside a dataframe of depth observations (archival). At each time step, the algorithm integrates information from past and future acoustic detections in the form of acoustic containers and information from depth observations in the form of depth contours to determine the possible locations of an individual in an area (see Details). As for the AC algorithm (ac), the function can be implemented step-wise or chunk-wise and the outputs can be processed via acdc_simplify." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/flapper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/edwardlavender/flapper/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The acoustic-container depth-contour (ACDC) algorithm</h1>
    <small class="dont-index">Source: <a href='https://github.com/edwardlavender/flapper/blob/master/R/acdc.R'><code>R/acdc.R</code></a></small>
    <div class="hidden name"><code>acdc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function implements the acoustic-container depth-contour (ACDC) algorithm. This is an extension of the AC algorithm implemented by <code><a href='ac.html'>ac</a></code> that that integrates acoustic detections and depth observations to the expected time spent in different parts of a study area over the period of observations. To implement the function, a dataframe (or list) of passive acoustic telemetry detections is required (<code>acoustics</code>), alongside a dataframe of depth observations (<code>archival</code>). At each time step, the algorithm integrates information from past and future acoustic detections in the form of acoustic containers and information from depth observations in the form of depth contours to determine the possible locations of an individual in an area (see Details). As for the AC algorithm (<code><a href='ac.html'>ac</a></code>), the function can be implemented step-wise or chunk-wise and the outputs can be processed via <code><a href='acdc_simplify.html'>acdc_simplify</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>acdc</span><span class='op'>(</span>
  <span class='va'>acoustics</span>,
  <span class='va'>archival</span>,
  plot_ts <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>bathy</span>,
  <span class='va'>detection_containers</span>,
  detection_kernels <span class='op'>=</span> <span class='cn'>NULL</span>,
  detection_kernels_overlap <span class='op'>=</span> <span class='cn'>NULL</span>,
  detection_time_window <span class='op'>=</span> <span class='fl'>5</span>,
  <span class='va'>mobility</span>,
  calc_depth_error <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.5</span>, <span class='fl'>2.5</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
  normalise <span class='op'>=</span> <span class='cn'>TRUE</span>,
  save_record_spatial <span class='op'>=</span> <span class='fl'>1L</span>,
  write_record_spatial_for_pf <span class='op'>=</span> <span class='cn'>NULL</span>,
  save_args <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  con <span class='op'>=</span> <span class='st'>""</span>,
  progress <span class='op'>=</span> <span class='fl'>1L</span>,
  split <span class='op'>=</span> <span class='cn'>NULL</span>,
  cl <span class='op'>=</span> <span class='cn'>NULL</span>,
  varlist <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>acoustics</th>
      <td><p>A dataframe, or a list of dataframes, that contains passive acoustic telemetry detection time series (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>archival</th>
      <td><p>A dataframe that contains depth time series (see <code><a href='dat_archival.html'>dat_archival</a></code> for an example) for a specific individual. This should contain the following columns: a numeric vector of observed depths, named `depth'; and a POSIXct vector of time stamps when observations were made, named `timestamp'. Depths should be recorded in the same units and with the same sign as the bathymetry data (see <code>bathy</code>). Absolute depths (m) are suggested. Unlike the detection time series, archival time stamps are assumed to have occurred at regular intervals. Both acoustic and archival time series are rounded to the resolution of <code>archival</code> observations to ensure alignment (see Details). `Duplicate' observations (of the same individual at the same receiver, if applicable, in the same time step) are dropped.</p></td>
    </tr>
    <tr>
      <th>plot_ts</th>
      <td><p>A logical input that defines whether or not to plot the detection and depth time series before the algorithm is initiated. This provides a useful visualisation of the extent to which they overlap.</p></td>
    </tr>
    <tr>
      <th>bathy</th>
      <td><p>A <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> that defines the bathymetry across the area within which the individual could have moved. This must be recorded in the same units and with the same sign as the depth observations (see <code>archival</code>). The coordinate reference system should be the Universal Transverse Mercator system, with distances in metres (see also <code><a href='acs_setup_containers.html'>acs_setup_containers</a></code>).</p></td>
    </tr>
    <tr>
      <th>detection_containers</th>
      <td><p>A list of detection containers, with one element for each number from <code>1:max(acoustics$receiver_id)</code>, from <code><a href='acs_setup_containers.html'>acs_setup_containers</a></code>.</p></td>
    </tr>
    <tr>
      <th>detection_kernels</th>
      <td><p>A named list of detection probability kernels (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>detection_kernels_overlap</th>
      <td><p>(optional) A named list of detection probability kernel overlaps (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>detection_time_window</th>
      <td><p>A number that defines the detection time window (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>mobility</th>
      <td><p>The mobility parameter (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>calc_depth_error</th>
      <td><p>A function that returns the depth errors around a vector of depths. The function should accept vector of depths (from <code>archival$depth</code>) and return a matrix, with one row for each (lower and upper) error and one one column for each depth (if the error varies with depth). For each depth, the two numbers are added to the observed depth to define the range of depths on the bathymetry raster (<code>bathy</code>) that the individual could plausibly have occupied at any time. Since the depth errors are added to the individual's depth, the first number should be negative (i.e., the individual could have been shallower that observed) and the second positive (i.e., the individual could have been deeper than observed). The appropriate form for <code>calc_depth_error</code> depends on the species (pelagic versus demersal/benthic species), the measurement error for the depth observations in <code>archival</code> and bathymetry (<code>bathy</code>) data, as well as the tidal range (m) across the area (over the duration of observations). For example, for a pelagic species, the constant function <code>calc_depth_error = function(...) matrix(c(-2.5, Inf)</code> implies that the individual could have occupied bathymetric cells that are deeper than the observed depth + (-2.5) m and shallower than Inf m (i.e. the individual could have been in any location in which the depth was deeper than the shallow depth limit for the individual). In contrast, for a benthic species, the constant function <code>calc_depth_error = function(...) matrix(c(-2.5, 2.5), nrow = 2)</code> implies that the individual could have occupied bathymetric cells whose depth lies within the interval defined by the observed depth + (-2.5) and + (+2.5) m.</p></td>
    </tr>
    <tr>
      <th>normalise</th>
      <td><p>A logical input that defines whether or not to normalise maps (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>save_record_spatial</th>
      <td><p>An integer of the spatial layers to save (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>write_record_spatial_for_pf</th>
      <td><p>A named list used to write time step-specific maps to file (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>save_args</th>
      <td><p>A logical input that defines whether or not to save the list of function inputs (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical variable that defines whether or not to print messages to the console or to file to relay function progress (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>con</th>
      <td><p>If <code>verbose = TRUE</code>, <code>con</code> is character string defines how messages relaying function progress are returned (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>An integer controlling the progress bar (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>split</th>
      <td><p>A character string that defines the time unit used to split acoustic time series into chunks (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    <tr>
      <th>cl, varlist</th>
      <td><p>(optional) Parallelisation options (see <code><a href='ac.html'>ac</a></code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns an <code><a href='acdc_archive-class.html'>acdc_archive-class</a></code> object. If a connection to write files has also been specified, an overall log (acdc_log.txt) as well as chunk-specific logs from calls to <code><a href='.acs.html'>.acs</a></code>, if applicable, are written to file.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The acoustic-container depth-contour (ACDC) algorithm is an approach which integrates acoustic detections and depth observations to infer the possible locations of tagged animals within an area over some time interval. The locational information provided by acoustic detections is represented by acoustic containers, which are areas around receivers that define where an individual could have been at each time point given the spatiotemporal pattern of detections at receivers, a model of detection probability and a movement parameter (see <code><a href='ac.html'>ac</a></code>). The locational information provided by depth observations is represented by depth contours, which are areas that define where an individual could have been at each time point given its depth and the local bathymetry (see <code><a href='dc.html'>dc</a></code>).</p>
<p>In outline, the crux of the approach is the recognition that acoustic detections typically occur irregularly, while archival observations occur at regular intervals. Each detection anchors our knowledge of the location of an individual around a particular receiver (assuming that all detections are true detections). As time passes between acoustic detections, our uncertainty about the geographical location of an individual expands around the receiver at which it was detected before shrinking towards the receiver at which it was next detected. (This is the AC algorithm.) During this time, regular depth observations restrict the number of possible locations in which the individual could have been located at each time step, assuming that the bathymetric landscape is non-homogeneous. This is true both for pelagic species, which must be in an area where the depth of the seabed is at least as deep as the observed depth, and for benthic/demersal species, which must be in an area where the depth of the seabed is relatively close to the observed depth. (This is the DC algorithm.) In reality, the timing of acoustic and archival observations may not align perfectly; this is currently resolved by rounding the acoustic time series to the temporal resolution of depth observations (see also <code><a href='ac.html'>ac</a></code>). In this way, the ACDC algorithm moves over acoustic and archival time steps, summing the positions in which individuals could have been located based on these two sources of data, to generate a map of that shows expected time spent in different parts of the study area over the time interval under consideration.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>This function calls <code><a href='.acs_pl.html'>.acs_pl</a></code> and <code><a href='.acs.html'>.acs</a></code> to implement the ACDC algorithm. The AC component can be implemented via  <code><a href='ac.html'>ac</a></code> and the DC component via <code><a href='dc.html'>dc</a></code>. <code><a href='acs_setup_containers.html'>acs_setup_containers</a></code> defines the detection containers required by this function.  <code><a href='acs_setup_mobility.html'>acs_setup_mobility</a></code> is used to examine the assumption of the constant `mobility' parameter. <code><a href='acs_setup_detection_kernels.html'>acs_setup_detection_kernels</a></code> produces detection probability kernels for incorporation into the function. <code><a href='acdc_simplify.html'>acdc_simplify</a></code> simplifies the outputs and <code><a href='acdc_plot_trace.html'>acdc_plot_trace</a></code>, <code><a href='acdc_plot_record.html'>acdc_plot_record</a></code> and <code><a href='acdc_animate_record.html'>acdc_animate_record</a></code> visualise the results. Particle filtering can be used to reconstruct movement paths.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Edward Lavender</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#### Step (1) Implement setup_acdc_*() steps</span>
<span class='co'># ... Define detection containers required for ACDC algorithm (see setup_acdc_containers())</span>

<span class='co'>#### Step (2) Prepare movement time series for algorithm</span>
<span class='co'># Focus on an example individual</span>
<span class='va'>id</span> <span class='op'>&lt;-</span> <span class='fl'>25</span>
<span class='va'>acc</span> <span class='op'>&lt;-</span> <span class='va'>dat_acoustics</span><span class='op'>[</span><span class='va'>dat_acoustics</span><span class='op'>$</span><span class='va'>individual_id</span> <span class='op'>==</span> <span class='va'>id</span>, <span class='op'>]</span>
<span class='va'>arc</span> <span class='op'>&lt;-</span> <span class='va'>dat_archival</span><span class='op'>[</span><span class='va'>dat_archival</span><span class='op'>$</span><span class='va'>individual_id</span> <span class='op'>==</span> <span class='va'>id</span>, <span class='op'>]</span>
<span class='co'># Focus on the subset of data for which we have both acoustic and archival detections</span>
<span class='va'>acc</span> <span class='op'>&lt;-</span> <span class='va'>acc</span><span class='op'>[</span><span class='va'>acc</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&gt;=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>arc</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>2</span><span class='op'>*</span><span class='fl'>60</span> <span class='op'>&amp;</span>
             <span class='va'>acc</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&lt;=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>arc</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>*</span><span class='fl'>60</span>, <span class='op'>]</span>
<span class='va'>arc</span> <span class='op'>&lt;-</span> <span class='va'>arc</span><span class='op'>[</span><span class='va'>arc</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&gt;=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>acc</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>2</span><span class='op'>*</span><span class='fl'>60</span> <span class='op'>&amp;</span>
             <span class='va'>arc</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&lt;=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>acc</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>*</span><span class='fl'>60</span>, <span class='op'>]</span>
<span class='co'># We'll focus on a one day period with overlapping detection/depth time series for speed</span>
<span class='va'>end</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2016-03-18"</span><span class='op'>)</span>
<span class='va'>acc</span> <span class='op'>&lt;-</span> <span class='va'>acc</span><span class='op'>[</span><span class='va'>acc</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&lt;=</span> <span class='va'>end</span>, <span class='op'>]</span>
<span class='va'>arc</span> <span class='op'>&lt;-</span> <span class='va'>arc</span><span class='op'>[</span><span class='va'>arc</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&lt;=</span> <span class='va'>end</span>, <span class='op'>]</span>
<span class='va'>arc</span> <span class='op'>&lt;-</span> <span class='va'>arc</span><span class='op'>[</span><span class='va'>arc</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&gt;=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>acc</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>2</span><span class='op'>*</span><span class='fl'>60</span> <span class='op'>&amp;</span>
             <span class='va'>arc</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&lt;=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>acc</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>*</span><span class='fl'>60</span>, <span class='op'>]</span>
<span class='co'># Process time series (if necessary)</span>
<span class='co'># ... Observations should be processed to the nearest time step</span>
<span class='co'># ... Duplicate detections should be dropped</span>

<span class='co'>#### Example (1) Implement ACDC algorithm with default arguments</span>
<span class='co'># This implements the algorithm on a single core, printing messages</span>
<span class='co'># ... to the console to monitor function progress.</span>
<span class='va'>out_acdc</span> <span class='op'>&lt;-</span> <span class='fu'>acdc</span><span class='op'>(</span>acoustics <span class='op'>=</span> <span class='va'>acc</span>,
                 archival <span class='op'>=</span> <span class='va'>arc</span>,
                 bathy <span class='op'>=</span> <span class='va'>dat_gebco</span>,
                 detection_containers <span class='op'>=</span> <span class='va'>dat_containers</span>,
                 mobility <span class='op'>=</span> <span class='fl'>200</span>,
                 calc_depth_error <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.5</span>, <span class='fl'>2.5</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
                 <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>flapper::acdc() called (@ 2022-05-28 17:59:50)...</span></div><div class='output co'>#&gt; flapper::.acs_pl() called (@ 2022-05-28 17:59:50)... 
#&gt; ... Checking user inputs... </div><div class='output co'>#&gt; <span class='message'>'calc_depth_error' function taken to be independent of depth.</span></div><div class='output co'>#&gt; ... Processing movement time series... 
#&gt; ... Plotting movement time series (for each chunk)... </div><div class='output co'>#&gt; ... Calling .acs() to implement ACDC algorithm on one chunk... 
#&gt; flapper::.acs() called (@ 2022-05-28 17:59:50)... 
#&gt;   |                                                                              |                                                                      |   0%... Initiating algorithm: moving over acoustic and internal ('archival') time steps... 
#&gt; ... On acoustic time step ('timestep_detection') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=                                                                     |   1%... On acoustic time step ('timestep_detection') 2. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=                                                                     |   2%... On acoustic time step ('timestep_detection') 3. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |==                                                                    |   3%... On acoustic time step ('timestep_detection') 4. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===                                                                   |   4%... On acoustic time step ('timestep_detection') 5. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |===                                                                   |   5%... On acoustic time step ('timestep_detection') 6. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |====                                                                  |   6%... On acoustic time step ('timestep_detection') 7. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=====                                                                 |   7%... On acoustic time step ('timestep_detection') 8. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |======                                                                |   8%... On acoustic time step ('timestep_detection') 9. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |======                                                                |   9%... On acoustic time step ('timestep_detection') 10. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=======                                                               |  10%... On acoustic time step ('timestep_detection') 11. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |========                                                              |  11%... On acoustic time step ('timestep_detection') 12. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |========                                                              |  12%... On acoustic time step ('timestep_detection') 13. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=========                                                             |  13%... On acoustic time step ('timestep_detection') 14. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========                                                            |  14%... On acoustic time step ('timestep_detection') 15. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========                                                            |  15%... On acoustic time step ('timestep_detection') 16. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 3. 
#&gt; ... ... ... Acoustic container is constant ... 
#&gt;   |                                                                              |===========                                                           |  16%... On acoustic time step ('timestep_detection') 17. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |============                                                          |  17%... On acoustic time step ('timestep_detection') 18. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... On internal time step ('timestep_archival') 3. 
#&gt; ... ... On internal time step ('timestep_archival') 4. 
#&gt; ... ... On internal time step ('timestep_archival') 5. 
#&gt; ... ... On internal time step ('timestep_archival') 6. 
#&gt; ... ... On internal time step ('timestep_archival') 7. 
#&gt; ... ... On internal time step ('timestep_archival') 8. 
#&gt; ... ... On internal time step ('timestep_archival') 9. 
#&gt; ... ... On internal time step ('timestep_archival') 10. 
#&gt;   |                                                                              |============                                                          |  18%... On acoustic time step ('timestep_detection') 19. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=============                                                         |  19%... On acoustic time step ('timestep_detection') 20. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============                                                        |  20%... On acoustic time step ('timestep_detection') 21. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===============                                                       |  21%... On acoustic time step ('timestep_detection') 22. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===============                                                       |  22%... On acoustic time step ('timestep_detection') 23. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |================                                                      |  23%... On acoustic time step ('timestep_detection') 24. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=================                                                     |  24%... On acoustic time step ('timestep_detection') 25. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=================                                                     |  25%... On acoustic time step ('timestep_detection') 26. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==================                                                    |  26%... On acoustic time step ('timestep_detection') 27. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================                                                   |  27%... On acoustic time step ('timestep_detection') 28. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================                                                   |  28%... On acoustic time step ('timestep_detection') 29. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |====================                                                  |  29%... On acoustic time step ('timestep_detection') 30. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |=====================                                                 |  30%... On acoustic time step ('timestep_detection') 31. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=====================                                                 |  31%... On acoustic time step ('timestep_detection') 32. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |======================                                                |  32%... On acoustic time step ('timestep_detection') 33. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=======================                                               |  33%... On acoustic time step ('timestep_detection') 34. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |========================                                              |  34%... On acoustic time step ('timestep_detection') 35. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |========================                                              |  35%... On acoustic time step ('timestep_detection') 36. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=========================                                             |  36%... On acoustic time step ('timestep_detection') 37. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========================                                            |  37%... On acoustic time step ('timestep_detection') 38. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========================                                            |  38%... On acoustic time step ('timestep_detection') 39. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |===========================                                           |  39%... On acoustic time step ('timestep_detection') 40. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |============================                                          |  40%... On acoustic time step ('timestep_detection') 41. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |============================                                          |  41%... On acoustic time step ('timestep_detection') 42. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=============================                                         |  42%... On acoustic time step ('timestep_detection') 43. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============================                                        |  43%... On acoustic time step ('timestep_detection') 44. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============================                                        |  44%... On acoustic time step ('timestep_detection') 45. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===============================                                       |  45%... On acoustic time step ('timestep_detection') 46. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |================================                                      |  46%... On acoustic time step ('timestep_detection') 47. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |=================================                                     |  47%... On acoustic time step ('timestep_detection') 48. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 3. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 4. 
#&gt; ... ... ... Acoustic container is constant ... 
#&gt; ... ... On internal time step ('timestep_archival') 5. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt;   |                                                                              |=================================                                     |  48%... On acoustic time step ('timestep_detection') 49. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==================================                                    |  49%... On acoustic time step ('timestep_detection') 50. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================================                                   |  50%... On acoustic time step ('timestep_detection') 51. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... On acoustic time step ('timestep_detection') 52. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |====================================                                  |  51%... On acoustic time step ('timestep_detection') 53. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... On internal time step ('timestep_archival') 3. 
#&gt; ... ... On internal time step ('timestep_archival') 4. 
#&gt; ... ... On internal time step ('timestep_archival') 5. 
#&gt; ... ... On internal time step ('timestep_archival') 6. 
#&gt; ... ... On internal time step ('timestep_archival') 7. 
#&gt; ... ... On internal time step ('timestep_archival') 8. 
#&gt; ... ... On internal time step ('timestep_archival') 9. 
#&gt; ... ... On internal time step ('timestep_archival') 10. 
#&gt;   |                                                                              |=====================================                                 |  52%... On acoustic time step ('timestep_detection') 54. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=====================================                                 |  53%... On acoustic time step ('timestep_detection') 55. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |======================================                                |  54%... On acoustic time step ('timestep_detection') 56. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 3. 
#&gt; ... ... ... Acoustic container is constant ... 
#&gt;   |                                                                              |=======================================                               |  55%... On acoustic time step ('timestep_detection') 57. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |========================================                              |  56%... On acoustic time step ('timestep_detection') 58. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |========================================                              |  57%... On acoustic time step ('timestep_detection') 59. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |=========================================                             |  58%... On acoustic time step ('timestep_detection') 60. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========================================                            |  59%... On acoustic time step ('timestep_detection') 61. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========================================                            |  60%... On acoustic time step ('timestep_detection') 62. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===========================================                           |  61%... On acoustic time step ('timestep_detection') 63. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |============================================                          |  62%... On acoustic time step ('timestep_detection') 64. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |============================================                          |  63%... On acoustic time step ('timestep_detection') 65. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=============================================                         |  64%... On acoustic time step ('timestep_detection') 66. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============================================                        |  65%... On acoustic time step ('timestep_detection') 67. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============================================                        |  66%... On acoustic time step ('timestep_detection') 68. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===============================================                       |  67%... On acoustic time step ('timestep_detection') 69. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |================================================                      |  68%... On acoustic time step ('timestep_detection') 70. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=================================================                     |  69%... On acoustic time step ('timestep_detection') 71. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=================================================                     |  70%... On acoustic time step ('timestep_detection') 72. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==================================================                    |  71%... On acoustic time step ('timestep_detection') 73. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================================================                   |  72%... On acoustic time step ('timestep_detection') 74. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================================================                   |  73%... On acoustic time step ('timestep_detection') 75. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |====================================================                  |  74%... On acoustic time step ('timestep_detection') 76. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=====================================================                 |  75%... On acoustic time step ('timestep_detection') 77. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=====================================================                 |  76%... On acoustic time step ('timestep_detection') 78. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |======================================================                |  77%... On acoustic time step ('timestep_detection') 79. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=======================================================               |  78%... On acoustic time step ('timestep_detection') 80. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=======================================================               |  79%... On acoustic time step ('timestep_detection') 81. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |========================================================              |  80%... On acoustic time step ('timestep_detection') 82. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=========================================================             |  81%... On acoustic time step ('timestep_detection') 83. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========================================================            |  82%... On acoustic time step ('timestep_detection') 84. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========================================================            |  83%... On acoustic time step ('timestep_detection') 85. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===========================================================           |  84%... On acoustic time step ('timestep_detection') 86. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 3. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 4. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 5. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 6. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 7. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 8. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 9. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 10. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 11. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 12. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 13. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 14. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 15. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 16. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 17. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 18. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 19. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 20. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 21. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 22. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 23. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 24. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 25. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 26. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 27. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 28. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 29. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 30. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 31. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 32. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 33. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 34. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 35. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 36. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 37. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 38. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 39. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 40. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 41. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 42. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 43. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 44. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 45. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 46. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 47. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 48. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 49. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 50. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 51. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 52. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 53. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 54. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 55. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 56. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 57. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 58. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 59. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 60. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 61. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 62. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 63. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 64. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 65. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 66. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 67. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 68. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 69. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 70. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 71. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 72. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 73. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 74. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 75. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 76. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 77. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 78. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 79. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 80. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 81. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 82. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 83. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 84. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 85. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 86. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 87. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 88. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt;   |                                                                              |============================================================          |  85%... On acoustic time step ('timestep_detection') 87. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |============================================================          |  86%... On acoustic time step ('timestep_detection') 88. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=============================================================         |  87%... On acoustic time step ('timestep_detection') 89. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============================================================        |  88%... On acoustic time step ('timestep_detection') 90. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============================================================        |  89%... On acoustic time step ('timestep_detection') 91. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |===============================================================       |  90%... On acoustic time step ('timestep_detection') 92. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |================================================================      |  91%... On acoustic time step ('timestep_detection') 93. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |================================================================      |  92%... On acoustic time step ('timestep_detection') 94. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=================================================================     |  93%... On acoustic time step ('timestep_detection') 95. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==================================================================    |  94%... On acoustic time step ('timestep_detection') 96. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================================================================   |  95%... On acoustic time step ('timestep_detection') 97. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt;   |                                                                              |===================================================================   |  96%... On acoustic time step ('timestep_detection') 98. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |====================================================================  |  97%... On acoustic time step ('timestep_detection') 99. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================================================================== |  98%... On acoustic time step ('timestep_detection') 100. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================================================================== |  99%... On acoustic time step ('timestep_detection') 101. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |======================================================================| 100%
#&gt; ... Movement over acoustic and internal ('archival') time steps has been completed. 
#&gt; ... flapper::.acs() call completed (@ 2022-05-28 17:59:58) after ~0.13 minutes. 
#&gt; ... flapper::.acs_pl() call completed (@ 2022-05-28 17:59:58) after ~0.13 minutes. </div><div class='output co'>#&gt; <span class='message'>flapper::acdc() finished (@ 2022-05-28 17:59:58)...</span></div><div class='input'><span class='co'># The function returns a list with four elements</span>
<span class='co'># ... archive contains the results of the algorithm, implemented by the back-end</span>
<span class='co'># ... function .acs(). The other elements provide the time series</span>
<span class='co'># ... for each chunk, the time of the algorithm and a list of user inputs</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>out_acdc</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             Length Class      Mode
#&gt; archive      1     -none-     list
#&gt; ts_by_chunk  1     -none-     list
#&gt; time         4     data.frame list
#&gt; args        19     -none-     list</div><div class='input'>
<span class='co'>#### Example (2): Write messages to file to monitor function progress via 'con'</span>
<span class='va'>out_acdc</span> <span class='op'>&lt;-</span> <span class='fu'>acdc</span><span class='op'>(</span>acoustics <span class='op'>=</span> <span class='va'>acc</span>,
                 archival <span class='op'>=</span> <span class='va'>arc</span>,
                 bathy <span class='op'>=</span> <span class='va'>dat_gebco</span>,
                 detection_containers <span class='op'>=</span> <span class='va'>dat_containers</span>,
                 mobility <span class='op'>=</span> <span class='fl'>200</span>,
                 calc_depth_error <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.5</span>, <span class='fl'>2.5</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
                 con <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>
                 <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>flapper::acdc() called (@ 2022-05-28 17:59:58)...</span></div><div class='output co'>#&gt; <span class='message'>'/' added to the directory inputted to the argument 'con' ('/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E').</span></div><div class='output co'>#&gt; <span class='message'>/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E/acdc_log.txt does not exist: attempting to write file in specified directory...</span></div><div class='output co'>#&gt; <span class='message'>... Blank file successfully written to file.</span></div><div class='output co'>#&gt; <span class='message'>'calc_depth_error' function taken to be independent of depth.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</div><div class='output co'>#&gt; <span class='message'>flapper::acdc() finished (@ 2022-05-28 18:00:06)...</span></div><div class='img'><img src='acdc-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>acdc_log</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"/acdc_log.txt"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>utils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>acdc_log</span>, <span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] "flapper::.acs_pl() called (@ 2022-05-28 17:59:58)... "                                  
#&gt;  [2] "... Checking user inputs... "                                                           
#&gt;  [3] "... Processing movement time series... "                                                
#&gt;  [4] "... Plotting movement time series (for each chunk)... "                                 
#&gt;  [5] "... Calling .acs() to implement ACDC algorithm on one chunk... "                        
#&gt;  [6] "flapper::.acs() called (@ 2022-05-28 17:59:58)... "                                     
#&gt;  [7] "... Initiating algorithm: moving over acoustic and internal ('archival') time steps... "
#&gt;  [8] "... On acoustic time step ('timestep_detection') 1. "                                   
#&gt;  [9] "... ... On internal time step ('timestep_archival') 1. "                                
#&gt; [10] "... On acoustic time step ('timestep_detection') 2. "                                   </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.remove</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"/acdc_log.txt"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'>#### Example (3): Implement the algorithm and return spatial information</span>
<span class='co'># Specify save_record_spatial = NULL to include spatial information for all time steps</span>
<span class='co'># ... or a vector to include this information for specific time steps</span>
<span class='va'>out_acdc</span> <span class='op'>&lt;-</span> <span class='fu'>acdc</span><span class='op'>(</span>acoustics <span class='op'>=</span> <span class='va'>acc</span>,
                 archival <span class='op'>=</span> <span class='va'>arc</span>,
                 bathy <span class='op'>=</span> <span class='va'>dat_gebco</span>,
                 detection_containers <span class='op'>=</span> <span class='va'>dat_containers</span>,
                 mobility <span class='op'>=</span> <span class='fl'>200</span>,
                 calc_depth_error <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.5</span>, <span class='fl'>2.5</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
                 save_record_spatial <span class='op'>=</span> <span class='cn'>NULL</span>
                 <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>flapper::acdc() called (@ 2022-05-28 18:00:06)...</span></div><div class='output co'>#&gt; flapper::.acs_pl() called (@ 2022-05-28 18:00:06)... 
#&gt; ... Checking user inputs... </div><div class='output co'>#&gt; <span class='message'>'calc_depth_error' function taken to be independent of depth.</span></div><div class='output co'>#&gt; ... Processing movement time series... 
#&gt; ... Plotting movement time series (for each chunk)... </div><div class='output co'>#&gt; ... Calling .acs() to implement ACDC algorithm on one chunk... 
#&gt; flapper::.acs() called (@ 2022-05-28 18:00:06)... 
#&gt;   |                                                                              |                                                                      |   0%... Initiating algorithm: moving over acoustic and internal ('archival') time steps... 
#&gt; ... On acoustic time step ('timestep_detection') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=                                                                     |   1%... On acoustic time step ('timestep_detection') 2. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=                                                                     |   2%... On acoustic time step ('timestep_detection') 3. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |==                                                                    |   3%... On acoustic time step ('timestep_detection') 4. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===                                                                   |   4%... On acoustic time step ('timestep_detection') 5. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |===                                                                   |   5%... On acoustic time step ('timestep_detection') 6. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |====                                                                  |   6%... On acoustic time step ('timestep_detection') 7. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=====                                                                 |   7%... On acoustic time step ('timestep_detection') 8. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |======                                                                |   8%... On acoustic time step ('timestep_detection') 9. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |======                                                                |   9%... On acoustic time step ('timestep_detection') 10. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=======                                                               |  10%... On acoustic time step ('timestep_detection') 11. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |========                                                              |  11%... On acoustic time step ('timestep_detection') 12. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |========                                                              |  12%... On acoustic time step ('timestep_detection') 13. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=========                                                             |  13%... On acoustic time step ('timestep_detection') 14. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========                                                            |  14%... On acoustic time step ('timestep_detection') 15. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========                                                            |  15%... On acoustic time step ('timestep_detection') 16. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 3. 
#&gt; ... ... ... Acoustic container is constant ... 
#&gt;   |                                                                              |===========                                                           |  16%... On acoustic time step ('timestep_detection') 17. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |============                                                          |  17%... On acoustic time step ('timestep_detection') 18. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... On internal time step ('timestep_archival') 3. 
#&gt; ... ... On internal time step ('timestep_archival') 4. 
#&gt; ... ... On internal time step ('timestep_archival') 5. 
#&gt; ... ... On internal time step ('timestep_archival') 6. 
#&gt; ... ... On internal time step ('timestep_archival') 7. 
#&gt; ... ... On internal time step ('timestep_archival') 8. 
#&gt; ... ... On internal time step ('timestep_archival') 9. 
#&gt; ... ... On internal time step ('timestep_archival') 10. 
#&gt;   |                                                                              |============                                                          |  18%... On acoustic time step ('timestep_detection') 19. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=============                                                         |  19%... On acoustic time step ('timestep_detection') 20. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============                                                        |  20%... On acoustic time step ('timestep_detection') 21. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===============                                                       |  21%... On acoustic time step ('timestep_detection') 22. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===============                                                       |  22%... On acoustic time step ('timestep_detection') 23. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |================                                                      |  23%... On acoustic time step ('timestep_detection') 24. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=================                                                     |  24%... On acoustic time step ('timestep_detection') 25. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=================                                                     |  25%... On acoustic time step ('timestep_detection') 26. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==================                                                    |  26%... On acoustic time step ('timestep_detection') 27. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================                                                   |  27%... On acoustic time step ('timestep_detection') 28. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================                                                   |  28%... On acoustic time step ('timestep_detection') 29. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |====================                                                  |  29%... On acoustic time step ('timestep_detection') 30. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |=====================                                                 |  30%... On acoustic time step ('timestep_detection') 31. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=====================                                                 |  31%... On acoustic time step ('timestep_detection') 32. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |======================                                                |  32%... On acoustic time step ('timestep_detection') 33. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=======================                                               |  33%... On acoustic time step ('timestep_detection') 34. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |========================                                              |  34%... On acoustic time step ('timestep_detection') 35. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |========================                                              |  35%... On acoustic time step ('timestep_detection') 36. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=========================                                             |  36%... On acoustic time step ('timestep_detection') 37. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========================                                            |  37%... On acoustic time step ('timestep_detection') 38. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========================                                            |  38%... On acoustic time step ('timestep_detection') 39. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |===========================                                           |  39%... On acoustic time step ('timestep_detection') 40. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |============================                                          |  40%... On acoustic time step ('timestep_detection') 41. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |============================                                          |  41%... On acoustic time step ('timestep_detection') 42. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=============================                                         |  42%... On acoustic time step ('timestep_detection') 43. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============================                                        |  43%... On acoustic time step ('timestep_detection') 44. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============================                                        |  44%... On acoustic time step ('timestep_detection') 45. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===============================                                       |  45%... On acoustic time step ('timestep_detection') 46. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |================================                                      |  46%... On acoustic time step ('timestep_detection') 47. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |=================================                                     |  47%... On acoustic time step ('timestep_detection') 48. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 3. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 4. 
#&gt; ... ... ... Acoustic container is constant ... 
#&gt; ... ... On internal time step ('timestep_archival') 5. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt;   |                                                                              |=================================                                     |  48%... On acoustic time step ('timestep_detection') 49. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==================================                                    |  49%... On acoustic time step ('timestep_detection') 50. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================================                                   |  50%... On acoustic time step ('timestep_detection') 51. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... On acoustic time step ('timestep_detection') 52. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |====================================                                  |  51%... On acoustic time step ('timestep_detection') 53. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... On internal time step ('timestep_archival') 3. 
#&gt; ... ... On internal time step ('timestep_archival') 4. 
#&gt; ... ... On internal time step ('timestep_archival') 5. 
#&gt; ... ... On internal time step ('timestep_archival') 6. 
#&gt; ... ... On internal time step ('timestep_archival') 7. 
#&gt; ... ... On internal time step ('timestep_archival') 8. 
#&gt; ... ... On internal time step ('timestep_archival') 9. 
#&gt; ... ... On internal time step ('timestep_archival') 10. 
#&gt;   |                                                                              |=====================================                                 |  52%... On acoustic time step ('timestep_detection') 54. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=====================================                                 |  53%... On acoustic time step ('timestep_detection') 55. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |======================================                                |  54%... On acoustic time step ('timestep_detection') 56. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 3. 
#&gt; ... ... ... Acoustic container is constant ... 
#&gt;   |                                                                              |=======================================                               |  55%... On acoustic time step ('timestep_detection') 57. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |========================================                              |  56%... On acoustic time step ('timestep_detection') 58. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |========================================                              |  57%... On acoustic time step ('timestep_detection') 59. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |=========================================                             |  58%... On acoustic time step ('timestep_detection') 60. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========================================                            |  59%... On acoustic time step ('timestep_detection') 61. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========================================                            |  60%... On acoustic time step ('timestep_detection') 62. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===========================================                           |  61%... On acoustic time step ('timestep_detection') 63. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |============================================                          |  62%... On acoustic time step ('timestep_detection') 64. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |============================================                          |  63%... On acoustic time step ('timestep_detection') 65. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=============================================                         |  64%... On acoustic time step ('timestep_detection') 66. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============================================                        |  65%... On acoustic time step ('timestep_detection') 67. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============================================                        |  66%... On acoustic time step ('timestep_detection') 68. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===============================================                       |  67%... On acoustic time step ('timestep_detection') 69. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |================================================                      |  68%... On acoustic time step ('timestep_detection') 70. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=================================================                     |  69%... On acoustic time step ('timestep_detection') 71. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=================================================                     |  70%... On acoustic time step ('timestep_detection') 72. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==================================================                    |  71%... On acoustic time step ('timestep_detection') 73. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================================================                   |  72%... On acoustic time step ('timestep_detection') 74. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================================================                   |  73%... On acoustic time step ('timestep_detection') 75. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |====================================================                  |  74%... On acoustic time step ('timestep_detection') 76. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=====================================================                 |  75%... On acoustic time step ('timestep_detection') 77. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=====================================================                 |  76%... On acoustic time step ('timestep_detection') 78. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |======================================================                |  77%... On acoustic time step ('timestep_detection') 79. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=======================================================               |  78%... On acoustic time step ('timestep_detection') 80. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=======================================================               |  79%... On acoustic time step ('timestep_detection') 81. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |========================================================              |  80%... On acoustic time step ('timestep_detection') 82. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=========================================================             |  81%... On acoustic time step ('timestep_detection') 83. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========================================================            |  82%... On acoustic time step ('timestep_detection') 84. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==========================================================            |  83%... On acoustic time step ('timestep_detection') 85. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===========================================================           |  84%... On acoustic time step ('timestep_detection') 86. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 3. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 4. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 5. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 6. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 7. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 8. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 9. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 10. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 11. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 12. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 13. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 14. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 15. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 16. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 17. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 18. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 19. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 20. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 21. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 22. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 23. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 24. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 25. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 26. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 27. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 28. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 29. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 30. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 31. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 32. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 33. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 34. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 35. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 36. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 37. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 38. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 39. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 40. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 41. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 42. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 43. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 44. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 45. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt; ... ... On internal time step ('timestep_archival') 46. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 47. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 48. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 49. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 50. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 51. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 52. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 53. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 54. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 55. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 56. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 57. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 58. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 59. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 60. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 61. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 62. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 63. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 64. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 65. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 66. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 67. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 68. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 69. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 70. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 71. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 72. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 73. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 74. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 75. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 76. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 77. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 78. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 79. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 80. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 81. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 82. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 83. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 84. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 85. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 86. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 87. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt; ... ... On internal time step ('timestep_archival') 88. 
#&gt; ... ... ... Acoustic container is shrinking ... 
#&gt;   |                                                                              |============================================================          |  85%... On acoustic time step ('timestep_detection') 87. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |============================================================          |  86%... On acoustic time step ('timestep_detection') 88. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=============================================================         |  87%... On acoustic time step ('timestep_detection') 89. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============================================================        |  88%... On acoustic time step ('timestep_detection') 90. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==============================================================        |  89%... On acoustic time step ('timestep_detection') 91. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt; ... ... ... Acoustic container is expanding... 
#&gt;   |                                                                              |===============================================================       |  90%... On acoustic time step ('timestep_detection') 92. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |================================================================      |  91%... On acoustic time step ('timestep_detection') 93. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |================================================================      |  92%... On acoustic time step ('timestep_detection') 94. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |=================================================================     |  93%... On acoustic time step ('timestep_detection') 95. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |==================================================================    |  94%... On acoustic time step ('timestep_detection') 96. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================================================================   |  95%... On acoustic time step ('timestep_detection') 97. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt; ... ... On internal time step ('timestep_archival') 2. 
#&gt;   |                                                                              |===================================================================   |  96%... On acoustic time step ('timestep_detection') 98. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |====================================================================  |  97%... On acoustic time step ('timestep_detection') 99. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================================================================== |  98%... On acoustic time step ('timestep_detection') 100. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |===================================================================== |  99%... On acoustic time step ('timestep_detection') 101. 
#&gt; ... ... On internal time step ('timestep_archival') 1. 
#&gt;   |                                                                              |======================================================================| 100%
#&gt; ... Movement over acoustic and internal ('archival') time steps has been completed. 
#&gt; ... flapper::.acs() call completed (@ 2022-05-28 18:00:13) after ~0.13 minutes. 
#&gt; ... flapper::.acs_pl() call completed (@ 2022-05-28 18:00:13) after ~0.13 minutes. </div><div class='output co'>#&gt; <span class='message'>flapper::acdc() finished (@ 2022-05-28 18:00:13)...</span></div><div class='input'>
<span class='co'>#### Example (4): Implement the algorithm in parallel e.g. by supplying a cluster</span>
<span class='co'># If verbose = TRUE (the default), it is necessary to specify a directory</span>
<span class='co'># ... into which dot_acdc_log_*.txt files are saved (i.e., messages</span>
<span class='co'># ... cannot be written to the console in parallel)</span>
<span class='va'>out_acdc</span> <span class='op'>&lt;-</span> <span class='fu'>acdc</span><span class='op'>(</span>acoustics <span class='op'>=</span> <span class='va'>acc</span>,
                 archival <span class='op'>=</span> <span class='va'>arc</span>,
                 bathy <span class='op'>=</span> <span class='va'>dat_gebco</span>,
                 detection_containers <span class='op'>=</span> <span class='va'>dat_containers</span>,
                 mobility <span class='op'>=</span> <span class='fl'>200</span>,
                 calc_depth_error <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.5</span>, <span class='fl'>2.5</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
                 con <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>,
                 cl <span class='op'>=</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span><span class='op'>(</span><span class='fl'>2L</span><span class='op'>)</span>
                 <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>flapper::acdc() called (@ 2022-05-28 18:00:13)...</span></div><div class='output co'>#&gt; <span class='message'>'/' added to the directory inputted to the argument 'con' ('/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E').</span></div><div class='output co'>#&gt; <span class='message'>/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E/acdc_log.txt does not exist: attempting to write file in specified directory...</span></div><div class='output co'>#&gt; <span class='message'>... Blank file successfully written to file.</span></div><div class='output co'>#&gt; <span class='message'>'calc_depth_error' function taken to be independent of depth.</span></div><div class='output co'>#&gt; <span class='message'>'acoustics' dataframe split into 2 chunks of ~4 (0--7) hours across 2 core(s).</span></div><div class='output co'>#&gt; <span class='message'>Chunk 1 : 6 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='output co'>#&gt; <span class='message'>Chunk 2 : 210 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='output co'>#&gt; <span class='message'>/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E/dot_acdc_log_1.txt does not exist: attempting to write file in specified directory...</span></div><div class='output co'>#&gt; <span class='message'>... Blank file successfully written to file.</span></div><div class='output co'>#&gt; <span class='message'>/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E/dot_acdc_log_2.txt does not exist: attempting to write file in specified directory...</span></div><div class='output co'>#&gt; <span class='message'>... Blank file successfully written to file.</span></div><div class='output co'>#&gt; <span class='message'>flapper::acdc() finished (@ 2022-05-28 18:00:26)...</span></div><div class='img'><img src='acdc-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Check logs</span>
<span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "acdc_log.txt"         "dot_acdc_log_1.txt"   "dot_acdc_log_2.txt"  
#&gt; [4] "downlit"              "file16ae112203e38.so" "file16ae11339cbd2"   
#&gt; [7] "file16ae163a5a0bf"   </div><div class='input'><span class='co'># "acdc_log.txt" contains the log for the overall function</span>
<span class='va'>acdc_log</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"/acdc_log.txt"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>acdc_log</span>, <span class='fl'>20</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] "flapper::.acs_pl() called (@ 2022-05-28 18:00:13)... "                                                                                                      
#&gt;  [2] "... Checking user inputs... "                                                                                                                               
#&gt;  [3] "... Splitting 'acoustics' into chunks... "                                                                                                                  
#&gt;  [4] "... Processing acoustics chunks... "                                                                                                                        
#&gt;  [5] "... ... Checking for NULL/empty chunks... "                                                                                                                 
#&gt;  [6] "... ... Overlapping chunks... "                                                                                                                             
#&gt;  [7] "... Processing movement time series... "                                                                                                                    
#&gt;  [8] "... ... Chunk 1 : 6 archival observation(s) beyond the ranges of (processed) acoustic detections ignored. "                                                 
#&gt;  [9] "... ... Chunk 2 : 210 archival observation(s) beyond the ranges of (processed) acoustic detections ignored. "                                               
#&gt; [10] "... Plotting movement time series (for each chunk)... "                                                                                                     
#&gt; [11] "... Defining chunk-specific log files as dot_acdc_log_1.txt, dot_acdc_log_2.txt etc... "                                                                    
#&gt; [12] "... ... /var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E/dot_acdc_log_1.txt does not exist: attempting to write file in specified directory... "
#&gt; [13] "... ... ... Blank file successfully written to file. "                                                                                                      
#&gt; [14] "... ... /var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E/dot_acdc_log_2.txt does not exist: attempting to write file in specified directory... "
#&gt; [15] "... ... ... Blank file successfully written to file. "                                                                                                      
#&gt; [16] "... Calling .acs() to implement ACDC algorithm on 2 chunks, using 2 cores... "                                                                              
#&gt; [17] "... flapper::.acs_pl() call completed (@ 2022-05-28 18:00:26) after ~0.21 minutes. "                                                                        </div><div class='input'><span class='co'># "acdc_log_1.txt", "acdc_log_2.txt" etc contain chunk-specific logs</span>
<span class='va'>acdc_log_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"/dot_acdc_log_1.txt"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>utils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>acdc_log_1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "flapper::.acs() called (@ 2022-05-28 18:00:14)... "                                     
#&gt; [2] "... Initiating algorithm: moving over acoustic and internal ('archival') time steps... "
#&gt; [3] "... On acoustic time step ('timestep_detection') 1. "                                   
#&gt; [4] "... ... On internal time step ('timestep_archival') 1. "                                
#&gt; [5] "... On acoustic time step ('timestep_detection') 2. "                                   
#&gt; [6] "... ... On internal time step ('timestep_archival') 1. "                                </div><div class='input'><span class='fu'>utils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>acdc_log_1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "... On acoustic time step ('timestep_detection') 91. "                               
#&gt; [2] "... ... On internal time step ('timestep_archival') 1. "                             
#&gt; [3] "... ... On internal time step ('timestep_archival') 2. "                             
#&gt; [4] "... ... ... Acoustic container is expanding... "                                     
#&gt; [5] "... Movement over acoustic and internal ('archival') time steps has been completed. "
#&gt; [6] "... flapper::.acs() call completed (@ 2022-05-28 18:00:25) after ~0.18 minutes. "    </div><div class='input'><span class='co'>## Examine outputs</span>
<span class='co'># Note that there are now four elements in archive, one for each chunk</span>
<span class='co'># Likewise, there are four elements in ts_by_chunk,</span>
<span class='co'># ... containing the movement time series for each chunk.</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>out_acdc</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             Length Class      Mode
#&gt; archive      2     -none-     list
#&gt; ts_by_chunk  2     -none-     list
#&gt; time         4     data.frame list
#&gt; args        19     -none-     list</div><div class='input'><span class='co'># Note that the last observation of each time series overlaps with the</span>
<span class='co'># ... first observation for the next chunk, to prevent loss of information</span>
<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>out_acdc</span><span class='op'>$</span><span class='va'>ts_by_chunk</span>,
  <span class='kw'>function</span><span class='op'>(</span><span class='va'>chunk</span><span class='op'>)</span> <span class='va'>chunk</span><span class='op'>$</span><span class='va'>acoustics</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>chunk</span><span class='op'>$</span><span class='va'>acoustics</span><span class='op'>)</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [[1]]
#&gt;    individual_id transmitter_id index           timestamp receiver_id
#&gt; 1             25   A69-1303-555     1 2016-03-17 01:50:00          26
#&gt; 92            25   A69-1303-555   138 2016-03-17 08:50:00          26
#&gt;       receiver receiver_long receiver_lat receiver_depth   dup split_permit
#&gt; 1  VR2W-108163     -5.610733     56.37628             25 FALSE        FALSE
#&gt; 92 VR2W-108163     -5.610733     56.37628             25 FALSE         TRUE
#&gt;                    bin timestamp_num
#&gt; 1  2016-03-17 01:00:00    1458179400
#&gt; 92 2016-03-17 05:00:00    1458204600
#&gt; 
#&gt; [[2]]
#&gt;     individual_id transmitter_id index           timestamp receiver_id
#&gt; 92             25   A69-1303-555   138 2016-03-17 08:50:00          26
#&gt; 102            25   A69-1303-555   154 2016-03-17 09:02:00          26
#&gt;        receiver receiver_long receiver_lat receiver_depth   dup split_permit
#&gt; 92  VR2W-108163     -5.610733     56.37628             25 FALSE         TRUE
#&gt; 102 VR2W-108163     -5.610733     56.37628             25 FALSE        FALSE
#&gt;                     bin timestamp_num
#&gt; 92  2016-03-17 05:00:00    1458204600
#&gt; 102 2016-03-17 09:00:00    1458205320
#&gt; </div><div class='input'>
<span class='co'>#### Example (5) Biologically meaningful chunks can be specified via</span>
<span class='co'># .. the 'split' argument or by passing a list of acoustic time series</span>
<span class='co'># .. already split by list of dataframes to 'acoustics'</span>
<span class='co'>## Using the split argument:</span>
<span class='va'>out_acdc</span> <span class='op'>&lt;-</span> <span class='fu'>acdc</span><span class='op'>(</span>acoustics <span class='op'>=</span> <span class='va'>acc</span>,
                 archival <span class='op'>=</span> <span class='va'>arc</span>,
                 bathy <span class='op'>=</span> <span class='va'>dat_gebco</span>,
                 detection_containers <span class='op'>=</span> <span class='va'>dat_containers</span>,
                 mobility <span class='op'>=</span> <span class='fl'>200</span>,
                 calc_depth_error <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.5</span>, <span class='fl'>2.5</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
                 con <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>,
                 cl <span class='op'>=</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span><span class='op'>(</span><span class='fl'>2L</span><span class='op'>)</span>,
                 split <span class='op'>=</span> <span class='st'>"2 hours"</span>
                 <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>flapper::acdc() called (@ 2022-05-28 18:00:26)...</span></div><div class='output co'>#&gt; <span class='message'>'/' added to the directory inputted to the argument 'con' ('/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E').</span></div><div class='output co'>#&gt; <span class='message'>'calc_depth_error' function taken to be independent of depth.</span></div><div class='output co'>#&gt; <span class='message'>'acoustics' dataframe split into 3 chunks of ~1 (0--5) hours across 2 core(s).</span></div><div class='output co'>#&gt; <span class='message'>Chunk 1 : 171 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='output co'>#&gt; <span class='message'>Chunk 2 : 51 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='output co'>#&gt; <span class='message'>Chunk 3 : 210 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='output co'>#&gt; <span class='message'>/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E/dot_acdc_log_3.txt does not exist: attempting to write file in specified directory...</span></div><div class='output co'>#&gt; <span class='message'>... Blank file successfully written to file.</span></div><div class='output co'>#&gt; <span class='message'>flapper::acdc() finished (@ 2022-05-28 18:00:37)...</span></div><div class='img'><img src='acdc-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Passing a list of dataframes</span>
<span class='co'># This option can provide more flexibility than split.</span>
<span class='co'># ... This example could also be used using split, as described above,</span>
<span class='co'># ... but this is not the case for all time categories (e.g., seasons).</span>
<span class='va'>acc</span><span class='op'>$</span><span class='va'>chunk</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span><span class='va'>acc</span><span class='op'>$</span><span class='va'>timestamp</span>, <span class='st'>"2 hours"</span><span class='op'>)</span>
<span class='va'>acc_ls</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>acc</span>, <span class='va'>acc</span><span class='op'>$</span><span class='va'>chunk</span><span class='op'>)</span>
<span class='va'>out_acdc</span>  <span class='op'>&lt;-</span> <span class='fu'>acdc</span><span class='op'>(</span>acoustics <span class='op'>=</span> <span class='va'>acc_ls</span>,
                  archival <span class='op'>=</span> <span class='va'>arc</span>,
                  bathy <span class='op'>=</span> <span class='va'>dat_gebco</span>,
                  detection_containers <span class='op'>=</span> <span class='va'>dat_containers</span>,
                  mobility <span class='op'>=</span> <span class='fl'>200</span>,
                  calc_depth_error <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.5</span>, <span class='fl'>2.5</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
                  con <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>,
                  cl <span class='op'>=</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span><span class='op'>(</span><span class='fl'>2L</span><span class='op'>)</span>
                  <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>flapper::acdc() called (@ 2022-05-28 18:00:37)...</span></div><div class='output co'>#&gt; <span class='message'>'/' added to the directory inputted to the argument 'con' ('/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E').</span></div><div class='output co'>#&gt; <span class='message'>'calc_depth_error' function taken to be independent of depth.</span></div><div class='output co'>#&gt; <span class='message'>Chunk 1 : 181 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='output co'>#&gt; <span class='message'>Chunk 2 : 156 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='output co'>#&gt; <span class='message'>Chunk 3 : 108 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='output co'>#&gt; <span class='message'>Chunk 4 : 204 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='output co'>#&gt; <span class='message'>Chunk 5 : 215 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='output co'>#&gt; <span class='message'>/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E/dot_acdc_log_4.txt does not exist: attempting to write file in specified directory...</span></div><div class='output co'>#&gt; <span class='message'>... Blank file successfully written to file.</span></div><div class='output co'>#&gt; <span class='message'>/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E/dot_acdc_log_5.txt does not exist: attempting to write file in specified directory...</span></div><div class='output co'>#&gt; <span class='message'>... Blank file successfully written to file.</span></div><div class='output co'>#&gt; <span class='message'>flapper::acdc() finished (@ 2022-05-28 18:00:48)...</span></div><div class='img'><img src='acdc-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#### Example (5) Implement the algorithm for multiple individuals</span>
<span class='co'># ... To do this, it is necessary to apply the function iteratively</span>
<span class='co'># ... to each individual.</span>
<span class='co'># Pre-processing to define computation time</span>
<span class='co'># ... E.g., careful definition of time series</span>
<span class='kw'>if</span><span class='op'>(</span><span class='va'>flapper_run_slow</span><span class='op'>)</span><span class='op'>{</span>
  <span class='co'># Define cluster</span>
  <span class='va'>cluster</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>cluster</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>cl</span> <span class='op'>&lt;-</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span><span class='op'>(</span><span class='fl'>2L</span><span class='op'>)</span>
    <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/clusterApply.html'>clusterExport</a></span><span class='op'>(</span>cl <span class='op'>=</span> <span class='va'>cl</span>, varlist <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"acdc"</span>,
                                                 <span class='st'>"dat_archival"</span>,
                                                 <span class='st'>"dat_gebco"</span>,
                                                 <span class='st'>"dat_containers"</span>
                                                  <span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='va'>cl</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
  <span class='co'># Implement algorithm for each individual</span>
  <span class='va'>acdc_out_by_id</span> <span class='op'>&lt;-</span>
    <span class='fu'>pbapply</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pbapply/man/pbapply.html'>pblapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>dat_acoustics</span>, <span class='va'>dat_acoustics</span><span class='op'>$</span><span class='va'>individual_id</span><span class='op'>)</span>, cl <span class='op'>=</span> <span class='va'>cl</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>acc</span><span class='op'>)</span><span class='op'>{</span>
      <span class='co'># Define individual-specific folder in which to save function logs</span>
      <span class='va'>dir_global</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"/"</span><span class='op'>)</span>
      <span class='va'>dir_id</span>     <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>dir_global</span>, <span class='va'>acc</span><span class='op'>$</span><span class='va'>individual_id</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='st'>"/"</span><span class='op'>)</span>
      <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.exists</a></span><span class='op'>(</span><span class='va'>dir_id</span><span class='op'>)</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='va'>dir_id</span><span class='op'>)</span>
      <span class='co'># Focus on a small sample of time series for speed</span>
      <span class='va'>acc</span> <span class='op'>&lt;-</span> <span class='va'>acc</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='op'>]</span>
      <span class='co'># Isolate archival data for individual</span>
      <span class='va'>arc</span> <span class='op'>&lt;-</span> <span class='va'>dat_archival</span><span class='op'>[</span><span class='va'>dat_archival</span><span class='op'>$</span><span class='va'>individual_id</span> <span class='op'>==</span> <span class='va'>acc</span><span class='op'>$</span><span class='va'>id</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='op'>]</span>
      <span class='co'># Implement algorithm</span>
      <span class='va'>acdc_out</span> <span class='op'>&lt;-</span> <span class='fu'>acdc</span><span class='op'>(</span>acoustics <span class='op'>=</span> <span class='va'>acc</span>,
                       archival <span class='op'>=</span> <span class='va'>dat_archival</span>,
                       bathy <span class='op'>=</span> <span class='va'>dat_gebco</span>,
                       detection_containers <span class='op'>=</span> <span class='va'>dat_containers</span>,
                       mobility <span class='op'>=</span> <span class='fl'>200</span>,
                       calc_depth_error <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.5</span>, <span class='fl'>2.5</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
                       save_record_spatial <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10L</span>,
                       con <span class='op'>=</span> <span class='va'>dir_id</span>
                       <span class='op'>)</span>
      <span class='co'># Include logs in output</span>
      <span class='va'>acdc_log</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='va'>dir_id</span>, full.names <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, <span class='va'>readLines</span><span class='op'>)</span>
      <span class='co'># Simplify the results at this stage or outside of this loop</span>
      <span class='co'># ... using acdc_simplify()</span>
      <span class='co'># Return results for specified individual</span>
      <span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>acdc_id <span class='op'>=</span> <span class='va'>acc</span><span class='op'>$</span><span class='va'>individual_id</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, acdc_out <span class='op'>=</span> <span class='va'>acdc_out</span>, acdc_log <span class='op'>=</span> <span class='va'>acdc_log</span><span class='op'>)</span>
      <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span>
    <span class='op'>}</span><span class='op'>)</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>cl</span><span class='op'>)</span><span class='op'>)</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>stopCluster</a></span><span class='op'>(</span><span class='va'>cl</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>acdc_out_by_id</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'>flapper::acdc() called (@ 2022-05-28 18:00:48)...</span></div><div class='output co'>#&gt; <span class='message'>/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E/25/acdc_log.txt does not exist: attempting to write file in specified directory...</span></div><div class='output co'>#&gt; <span class='message'>... Blank file successfully written to file.</span></div><div class='output co'>#&gt; <span class='message'>'calc_depth_error' function taken to be independent of depth.</span></div><div class='output co'>#&gt; <span class='message'>archival$timestamp rounded to the nearest 120 second(s).</span></div><div class='output co'>#&gt; <span class='message'>Duplicate observations in 'archival' identified and dropped.</span></div><div class='output co'>#&gt; <span class='message'>Chunk 1 : 774 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</div><div class='output co'>#&gt; <span class='message'>flapper::acdc() finished (@ 2022-05-28 18:00:48)...</span></div><div class='output co'>#&gt; <span class='message'>flapper::acdc() called (@ 2022-05-28 18:00:48)...</span></div><div class='output co'>#&gt; <span class='message'>/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E/28/acdc_log.txt does not exist: attempting to write file in specified directory...</span></div><div class='output co'>#&gt; <span class='message'>... Blank file successfully written to file.</span></div><div class='output co'>#&gt; <span class='message'>'calc_depth_error' function taken to be independent of depth.</span></div><div class='output co'>#&gt; <span class='message'>archival$timestamp rounded to the nearest 120 second(s).</span></div><div class='output co'>#&gt; <span class='message'>Duplicate observations in 'archival' identified and dropped.</span></div><div class='output co'>#&gt; <span class='message'>Chunk 1 : 7268 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='img'><img src='acdc-5.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</div><div class='output co'>#&gt; <span class='message'>flapper::acdc() finished (@ 2022-05-28 18:00:49)...</span></div><div class='output co'>#&gt; <span class='message'>flapper::acdc() called (@ 2022-05-28 18:00:49)...</span></div><div class='output co'>#&gt; <span class='message'>/var/folders/lx/dhz6yx2n2b7bg93hwz8t97zr0000gq/T//Rtmpwmdj7E/35/acdc_log.txt does not exist: attempting to write file in specified directory...</span></div><div class='output co'>#&gt; <span class='message'>... Blank file successfully written to file.</span></div><div class='output co'>#&gt; <span class='message'>'calc_depth_error' function taken to be independent of depth.</span></div><div class='output co'>#&gt; <span class='message'>archival$timestamp rounded to the nearest 120 second(s).</span></div><div class='output co'>#&gt; <span class='message'>Duplicate observations in 'archival' identified and dropped.</span></div><div class='output co'>#&gt; <span class='message'>Chunk 1 : 1961 archival observation(s) beyond the ranges of (processed) acoustic detections ignored.</span></div><div class='img'><img src='acdc-6.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</div><div class='output co'>#&gt; <span class='message'>flapper::acdc() finished (@ 2022-05-28 18:05:06)...</span></div><div class='img'><img src='acdc-7.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;    Length Class  Mode
#&gt; 25 3      -none- list
#&gt; 28 3      -none- list
#&gt; 35 3      -none- list</div><div class='input'>
<span class='co'>#### Step (3) Simplify the function outputs</span>
<span class='co'># This step aggregates information across chunks, which is necessary to</span>
<span class='co'># ... plot information aggregated across all chunks (see below).</span>

<span class='co'>#### Step (4) Examine function outputs, e.g., via plotting</span>
<span class='co'># See acdc_plot_record() and acdc_animate_record() to visualise the results</span>
<span class='co'># ... (either for a specific chunk or aggregated across all chunks</span>
<span class='co'># ... using acdc_simplify() as described above).</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


