<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate detections — sim_detections • flapper</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate detections — sim_detections"><meta property="og:description" content="This function simulates detections at passive acoustic telemetry receivers under a detection model that depends on distance. To implement the function, the underlying movement path that gives rise to detections (or not) must be supplied (via path) along with the locations of receivers (xy) at which detections can be made. At each point along the movement path (i.e., time step), the function calculates the distances from that point to all of the receivers and evaluates a user-supplied detection probability function, based on distance, to determine detection probability at each receiver. The function then simulates binary detection outcomes from a binomial distribution conditional on this probability, and returns these in a matrix with one simulated outcome for each time step and receiver."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/flapper_algorithms_faqs.html">`flapper`: practitioner FAQs</a>
    </li>
    <li>
      <a href="../articles/flapper_overview.html">`flapper`: an overview</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edwardlavender/flapper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate detections</h1>
    <small class="dont-index">Source: <a href="https://github.com/edwardlavender/flapper/blob/HEAD/R/sims.R" class="external-link"><code>R/sims.R</code></a></small>
    <div class="hidden name"><code>sim_detections.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function simulates detections at passive acoustic telemetry receivers under a detection model that depends on distance. To implement the function, the underlying movement path that gives rise to detections (or not) must be supplied (via <code>path</code>) along with the locations of receivers (<code>xy</code>) at which detections can be made. At each point along the movement path (i.e., time step), the function calculates the distances from that point to all of the receivers and evaluates a user-supplied detection probability function, based on distance, to determine detection probability at each receiver. The function then simulates binary detection outcomes from a binomial distribution conditional on this probability, and returns these in a matrix with one simulated outcome for each time step and receiver.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sim_detections</span><span class="op">(</span></span>
<span>  <span class="va">path</span>,</span>
<span>  <span class="va">xy</span>,</span>
<span>  crs <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">calc_detection_pr</span>,</span>
<span>  by_timestep <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  delta_t <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  jitter <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  add_prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"royalblue"</span>, pch <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>path</dt>
<dd><p>A two-column matrix of the coordinates of the movement path (x, y).</p></dd>


<dt>xy</dt>
<dd><p>A two-column matrix of the coordinates of receivers (x, y).</p></dd>


<dt>crs</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></code> object that defines the coordinate reference system (CRS) for <code>path</code> and <code>xy</code> (if applicable).</p></dd>


<dt>calc_detection_pr</dt>
<dd><p>A function that takes in a vector of distances and returns a vector of detection probabilities.</p></dd>


<dt>by_timestep</dt>
<dd><p>A logical variable that defines whether or not <code>calc_detection_pr</code> needs to be applied to each time step separately. This may be necessary if some of the parameters of the detection model are vectors (see Examples).</p></dd>


<dt>delta_t</dt>
<dd><p>(optional) An integer that defines the number of time steps over which to aggregate detections. If provided, detections are summed over each <code>delta_t</code> interval and returned along with averaged distances and probabilities (see Value).</p></dd>


<dt>seed</dt>
<dd><p>An integer that is used to set the seed to enable reproducible simulations (see <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code>).</p></dd>


<dt>plot</dt>
<dd><p>A logical variable that defines whether or not to plot detections (and probabilities) against distances.</p></dd>


<dt>jitter, add_prob, xlim, ...</dt>
<dd><p>Plot customisation options. <code>jitter</code> is a function that jitters <code>n</code> simulated outcomes (0, 1) in the vertical direction. <code>add_prob</code> is a named list of arguments, passed to <code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></code>, used to customise the addition of calculated probabilities to the plot. (<code>add_prob = NULL</code> suppresses the addition of probabilities to the plot.) <code>xlim</code> is a vector of x axis limits. By default, <code>xlim = c(0, 1000)</code> to improve resolution in the area of the plot that is of interest (under a Universal Transverse Mercator CRS, for most realistic detection probability functions, detection probability beyond 1000 will be negligible) and plotting speed. Additional arguments can be passed to <code><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html" class="external-link">pretty_plot</a></code> to customise the plot via <code>...</code>.</p></dd>


<dt>verbose</dt>
<dd><p>A logical variable that defines whether or not to print messages to the console to relay function progress.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If <code>delta_t = NULL</code>, then function returns a named list with three matrices that define, for each path position (rows) and each receiver (columns), (a) the distance of that position from each receiver (`dist_mat'), (b) the probability of detection at that receiver (`prob_mat') and (c) the simulated outcome (0, no detection; 1, detection) (`det_mat'). If <code>delta_t</code> is specified, then the function returns a list with a `raw' and an `agg' element. The raw elements contains the matrices described above; the `agg' element contains the aggregated versions of these matrices, with detections summed over each <code>delta_t</code> interval and distances and probabilities averaged (using the arithmetic mean) over each interval. If <code>plot = TRUE</code>, the function also returns a plot of the (raw) detections (0, 1) and, if specified, the corresponding probabilities.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function assumes that the individual transmits an acoustic signal which has the capacity to be detected at each time step. In reality, acoustic transmitters are often programmed with a randomly varying delay, but this is not currently implemented. The function also assumes that all receivers that are supplied are able to make detections. If the receivers at which an individual could be detected change over time, it may be necessary to apply the function iteratively or post-process the outcomes to ensure that individuals are not detected at inactive receivers.</p>
<p>For coupled simulation--analysis workflows (such as <code><a href="sim_array.html">sim_array</a></code>, <code><a href="sim_path_sa.html">sim_path_sa</a></code> and <code>sim_detections</code> plus <code><a href="ac.html">ac</a></code>, <code><a href="dc.html">dc</a></code>,  <code><a href="acdc.html">acdc</a></code> and <code><a href="pf.html">pf</a></code>), it is important that receiver locations (from <code><a href="sim_array.html">sim_array</a></code>) and individual locations (from <code><a href="sim_path_sa.html">sim_path_sa</a></code>) are represented on the <code><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></code> grid used to reconstruct simulated movements before simulating detections. Receiver locations and movement distances must remain admissible according to the movement model when translated on the grid. Grid resolution should be sufficiently high to represent effectively simulated movement probabilities and detection probabilities.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="sim_array.html">sim_array</a></code>, <code><a href="sim_path_-times.html">sim_path_*</a></code> and <code>sim_detections</code> provide an integrated workflow for simulating acoustic arrays, movement paths in these areas and detections at receivers arising from movement. To convert the detection matrix to dataframe, see <code><a href="make_df_detections.html">make_df_detections</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edward Lavender</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#### Step (1) Simulate an array in an area</span></span></span>
<span class="r-in"><span><span class="va">array_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_array.html">sim_array</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  boundaries <span class="op">=</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="va">dat_coast</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  coastline <span class="op">=</span> <span class="va">dat_coast</span>,</span></span>
<span class="r-in"><span>  n_receivers <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  arrangement <span class="op">=</span> <span class="st">"regular"</span>,</span></span>
<span class="r-in"><span>  seed <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::sim_array() called (@ 2023-08-29 15:46:15)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining area... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Incorporating coastline... </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>GEOS support is provided by the sf and terra packages among others</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Incorporating receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Simulating receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Plotting array... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class "SpatialPolygonsDataFrame" (package sp):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of SpatialPolygons:  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variables measured:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GID_0         NAME_0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   GBR United Kingdom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class       : SpatialPolygons </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> features    : 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extent      : 697637.7, 712448.9, 6248627, 6270681  (xmin, xmax, ymin, ymax)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> crs         : +proj=utm +zone=29 +datum=WGS84 +units=m +no_defs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +datum=WGS84 +units=m +no_defs'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining outputs... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::sim_array() call completed (@ 2023-08-29 15:46:15) after ~0 minutes. </span>
<span class="r-in"><span><span class="fu">raster</span><span class="fu">::</span><span class="fu">lines</span><span class="op">(</span><span class="va">dat_coast</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Step (2) Simulate a movement path in this area</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="va">path_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_path_sa.html">sim_path_sa</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="va">n</span>,</span></span>
<span class="r-in"><span>  sim_step <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">1</span>, shape <span class="op">=</span> <span class="fl">25</span>, scale <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  area <span class="op">=</span> <span class="va">array_ls</span><span class="op">$</span><span class="va">array</span><span class="op">$</span><span class="va">sea</span>,</span></span>
<span class="r-in"><span>  seed <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  plot <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::sim_path_sa() called (@ 2023-08-29 15:46:15)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Simulating movement path... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%... flapper::sim_path_sa() call completed (@ 2023-08-29 15:46:16) after ~0.01 minutes. </span>
<span class="r-in"><span><span class="fu">prettyGraphics</span><span class="fu">::</span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/add_sp.html" class="external-link">add_sp_path</a></span><span class="op">(</span><span class="va">path_ls</span><span class="op">$</span><span class="va">xy_mat</span>, col <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_detections-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Step (3) Simulate detections</span></span></span>
<span class="r-in"><span><span class="co">## (A) Extract path and receiver coordinates from simulated outcomes above</span></span></span>
<span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="va">path_ls</span><span class="op">$</span><span class="va">xy_mat</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="va">array_ls</span><span class="op">$</span><span class="va">array</span><span class="op">$</span><span class="va">xy</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## (B) Simulate detections under different probability functions (see below).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (1) Threshold probability function</span></span></span>
<span class="r-in"><span><span class="co"># Define detection pr function</span></span></span>
<span class="r-in"><span><span class="va">calc_detection_pr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dist</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">&lt;</span> <span class="fl">425</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Simulate detections</span></span></span>
<span class="r-in"><span><span class="va">dets_sim</span> <span class="op">&lt;-</span> <span class="fu">sim_detections</span><span class="op">(</span></span></span>
<span class="r-in"><span>  path <span class="op">=</span> <span class="va">path</span>,</span></span>
<span class="r-in"><span>  xy <span class="op">=</span> <span class="va">xy</span>,</span></span>
<span class="r-in"><span>  calc_detection_pr <span class="op">=</span> <span class="va">calc_detection_pr</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::sim_detections() called (@ 2023-08-29 15:46:16)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Calculating distances... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Calculating probabilities... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Simulating detections... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Plotting detections... </span>
<span class="r-plt img"><img src="sim_detections-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::simulate_detections() call completed (@ 2023-08-29 15:46:16) after ~0 minutes. </span>
<span class="r-in"><span><span class="co"># The function returns a list of matrices that define the distances,</span></span></span>
<span class="r-in"><span><span class="co"># ... probabilities and detections for each time stamp (row) and each receiver</span></span></span>
<span class="r-in"><span><span class="co"># ... (column)</span></span></span>
<span class="r-in"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dets_sim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dist_mat: num [1:500, 1:116] 19067 18554 18094 17367 16872 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ prob_mat: num [1:500, 1:116] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ det_mat : int [1:500, 1:116] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-in"><span><span class="co"># Examine probabilities</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dets_sim</span><span class="op">$</span><span class="va">prob_mat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0     1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57852   148 </span>
<span class="r-in"><span><span class="co"># We can also aggregate detections via delta_t</span></span></span>
<span class="r-in"><span><span class="va">dets_sim</span> <span class="op">&lt;-</span> <span class="fu">sim_detections</span><span class="op">(</span></span></span>
<span class="r-in"><span>  path <span class="op">=</span> <span class="va">path</span>,</span></span>
<span class="r-in"><span>  xy <span class="op">=</span> <span class="va">xy</span>,</span></span>
<span class="r-in"><span>  calc_detection_pr <span class="op">=</span> <span class="va">calc_detection_pr</span>,</span></span>
<span class="r-in"><span>  delta_t <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::sim_detections() called (@ 2023-08-29 15:46:16)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Calculating distances... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Calculating probabilities... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Simulating detections... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Plotting detections... </span>
<span class="r-plt img"><img src="sim_detections-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... summarising detections over delta t... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::simulate_detections() call completed (@ 2023-08-29 15:46:16) after ~0 minutes. </span>
<span class="r-in"><span><span class="co"># In this case, the function returns a list with 'agg' and 'raw' elements</span></span></span>
<span class="r-in"><span><span class="co"># ... The 'agg' elements contain aggregated matrices and the 'raw' elements</span></span></span>
<span class="r-in"><span><span class="co"># ... contain the matrices described above.</span></span></span>
<span class="r-in"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dets_sim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ agg:List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ dist_mat: num [1:50, 1:116] 173735 163252 172967 184119 163313 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ prob_mat: num [1:50, 1:116] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ det_mat : num [1:50, 1:116] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ raw:List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ dist_mat_raw: num [1:500, 1:116] 19067 18554 18094 17367 16872 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ prob_mat_raw: num [1:500, 1:116] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ det_mat_raw : int [1:500, 1:116] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dets_sim</span><span class="op">$</span><span class="va">raw</span><span class="op">$</span><span class="va">det_mat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0     1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57852   148 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dets_sim</span><span class="op">$</span><span class="va">agg</span><span class="op">$</span><span class="va">det_mat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    1    2    3    4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5701   61   29    7    2 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (2) Logistic probability function</span></span></span>
<span class="r-in"><span><span class="va">calc_detection_pr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dist</span><span class="op">)</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">2.5</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.01</span> <span class="op">*</span> <span class="va">dist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dets_sim</span> <span class="op">&lt;-</span> <span class="fu">sim_detections</span><span class="op">(</span></span></span>
<span class="r-in"><span>  path <span class="op">=</span> <span class="va">path</span>,</span></span>
<span class="r-in"><span>  xy <span class="op">=</span> <span class="va">xy</span>,</span></span>
<span class="r-in"><span>  calc_detection_pr <span class="op">=</span> <span class="va">calc_detection_pr</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::sim_detections() called (@ 2023-08-29 15:46:16)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Calculating distances... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Calculating probabilities... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Simulating detections... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Plotting detections... </span>
<span class="r-plt img"><img src="sim_detections-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::simulate_detections() call completed (@ 2023-08-29 15:46:16) after ~0 minutes. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (3) Spatially varying probability function</span></span></span>
<span class="r-in"><span><span class="co"># Define spatially varying beta parameter (e.g., reflecting 2 habitat types)</span></span></span>
<span class="r-in"><span><span class="va">area</span> <span class="op">&lt;-</span> <span class="va">array_ls</span><span class="op">$</span><span class="va">array</span><span class="op">$</span><span class="va">area</span></span></span>
<span class="r-in"><span><span class="va">area_r</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  crs <span class="op">=</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">area_r</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0L</span></span></span>
<span class="r-in"><span><span class="va">beta_surface</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_surface.html">sim_surface</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  blank <span class="op">=</span> <span class="va">area_r</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">2L</span>,</span></span>
<span class="r-in"><span>  sim_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">-</span><span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>    <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">-</span><span class="fl">0.01</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  mask <span class="op">=</span> <span class="va">array_ls</span><span class="op">$</span><span class="va">array</span><span class="op">$</span><span class="va">sea</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +datum=WGS84 +units=m +no_defs'.</span>
<span class="r-plt img"><img src="sim_detections-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Extract receiver specific beta values</span></span></span>
<span class="r-in"><span><span class="va">xy_sp</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPoints</a></span><span class="op">(</span><span class="va">xy</span>, proj4string <span class="op">=</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">area_r</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">beta_surface</span>, <span class="va">xy_sp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Visualise simulated detection probability surface at some suitable distances</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">500</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">dist</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span><span class="va">beta_surface</span>, <span class="kw">function</span><span class="op">(</span><span class="va">beta</span><span class="op">)</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">2.5</span> <span class="op">+</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">dist</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim_detections-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Define detection probability function</span></span></span>
<span class="r-in"><span><span class="va">calc_detection_pr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dist</span><span class="op">)</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">2.5</span> <span class="op">+</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">dist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Simulate detections</span></span></span>
<span class="r-in"><span><span class="co"># ... Define by_timestep = TRUE so that that distances from each receiver</span></span></span>
<span class="r-in"><span><span class="co"># ... are combined appropriately with beta values for each receiver</span></span></span>
<span class="r-in"><span><span class="va">dets_sim</span> <span class="op">&lt;-</span> <span class="fu">sim_detections</span><span class="op">(</span></span></span>
<span class="r-in"><span>  path <span class="op">=</span> <span class="va">path</span>,</span></span>
<span class="r-in"><span>  xy <span class="op">=</span> <span class="va">xy</span>,</span></span>
<span class="r-in"><span>  calc_detection_pr <span class="op">=</span> <span class="va">calc_detection_pr</span>,</span></span>
<span class="r-in"><span>  by_timestep <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::sim_detections() called (@ 2023-08-29 15:46:16)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Calculating distances... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Calculating probabilities... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Simulating detections... </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NAs produced</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Plotting detections... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 26 observation pair(s) in x are NA; these are removed.</span>
<span class="r-plt img"><img src="sim_detections-7.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::simulate_detections() call completed (@ 2023-08-29 15:46:17) after ~0 minutes. </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

