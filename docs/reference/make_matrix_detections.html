<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Matricise detection time series — make_matrix_detections • flapper</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Matricise detection time series — make_matrix_detections" />
<meta property="og:description" content="This function creates a list of matrices that, for each individual (list element), defines the number of detections of that individual in each time interval (matrix row) at each receiver (matrix column). To implement the function, a dataframe with acoustic detection time series must be provided via acoustics. The time intervals over which to count detections are provided by optionally defining a start and end date (these can be taken from the range of times in acoustics if unspecified) and the interval (delta_t) between time steps. By default, matrix elements that are `outside' individual or receiver deployment periods are defined as 0 (not detected) but can be changed to another value (e.g., NA) via set_outside. In this case, the acoustics dataframe also needs to include the deployment times for each individual and an additional dataframe must be supplied with the same information for receivers via moorings." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/flapper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/edwardlavender/flapper/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Matricise detection time series</h1>
    <small class="dont-index">Source: <a href='https://github.com/edwardlavender/flapper/blob/master/R/make_matrices.R'><code>R/make_matrices.R</code></a></small>
    <div class="hidden name"><code>make_matrix_detections.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function creates a list of matrices that, for each individual (list element), defines the number of detections of that individual in each time interval (matrix row) at each receiver (matrix column). To implement the function, a dataframe with acoustic detection time series must be provided via <code>acoustics</code>. The time intervals over which to count detections are provided by optionally defining a <code>start</code> and <code>end</code> date (these can be taken from the range of times in <code>acoustics</code> if unspecified) and the interval (<code>delta_t</code>) between time steps. By default, matrix elements that are `outside' individual or receiver deployment periods are defined as 0 (not detected) but can be changed to another value (e.g., NA) via <code>set_outside</code>. In this case, the <code>acoustics</code> dataframe also needs to include the deployment times for each individual and an additional dataframe must be supplied with the same information for receivers via <code>moorings</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>make_matrix_detections</span><span class='op'>(</span>
  <span class='va'>acoustics</span>,
  moorings <span class='op'>=</span> <span class='cn'>NULL</span>,
  start <span class='op'>=</span> <span class='cn'>NULL</span>,
  end <span class='op'>=</span> <span class='cn'>NULL</span>,
  delta_t <span class='op'>=</span> <span class='st'>"120 mins"</span>,
  simplify <span class='op'>=</span> <span class='cn'>NULL</span>,
  set_outside <span class='op'>=</span> <span class='cn'>NULL</span>,
  as_POSIXct <span class='op'>=</span> <span class='va'>as.POSIXct</span>,
  set_names <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>acoustics</th>
      <td><p>A dataframe that defines passive acoustic telemetry detection time series. This should contain the following columns: a vector of individual IDs, named `individual_id'; a (factor) vector of receiver IDs, named `receiver_id'. If <code>set_outside</code> is specified, this should also contain POSIXct vectors of the start and end time of each individual's time at liberty, named `tag_start_date' and `tag_end_date' respectively.</p></td>
    </tr>
    <tr>
      <th>moorings</th>
      <td><p>(optional)  If <code>set_outside</code> is specified, <code>moorings</code> is dataframe that defines passive acoustic telemetry receiver metadata. This should contain the following columns: a vector of receiver IDs, named `receiver_id (as in <code>acoustics</code>); and POSIXct vectors of the start and end times of each receiver's deployment time, named `receiver_start_date' and `receiver_end_date' respectively.</p></td>
    </tr>
    <tr>
      <th>start, end</th>
      <td><p>POSIXct objects that define the start and end time. If unspecified, these are taken from the range of detection times in <code>acoustics</code>.</p></td>
    </tr>
    <tr>
      <th>delta_t</th>
      <td><p>A number or character that defines the time interval between successive time steps. This is passed to the `by' argument of <code><a href='https://rdrr.io/r/base/seq.POSIXt.html'>seq.POSIXt</a></code>.</p></td>
    </tr>
    <tr>
      <th>simplify</th>
      <td><p>(optional) A function that simplifies detection matrices, such as <code>function(x) (x &gt; 0) + 0</code> to convert counts into a boolean outcomes that define whether or a detection was made.</p></td>
    </tr>
    <tr>
      <th>set_outside</th>
      <td><p>(optional) A value (e.g., <code>NA</code>) that is assigned to any matrix element that is outside of an individual's or receiver's deployment period when detection was not possible.</p></td>
    </tr>
    <tr>
      <th>as_POSIXct</th>
      <td><p>A function that coerces any supplied times that are not POSIXct objects to POSIXct objects.</p></td>
    </tr>
    <tr>
      <th>set_names</th>
      <td><p>A logical variable that defines whether or not to set the row and column names of the matrix to the time steps and the receiver IDs respectively.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical variable that defines whether or not to print messages to the console to relay function progress.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A matrix, or a list of matrices (one for each individual in <code>acoustics</code> if there is more than one individual) with one column for each time step and one column for each receiver. Each cell defines whether (1) or not (0) the individual was detected (or, if <code>set_outside</code> is supplied, it could not have been detected) during that time step. All matrices are expressed across the same sequence of time steps and receivers.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Edward Lavender</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#### Example (1) Construct matrix from detected individuals using detection time series</span>
<span class='va'>dat_acoustics</span><span class='op'>$</span><span class='va'>receiver_id</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>dat_acoustics</span><span class='op'>$</span><span class='va'>receiver_id</span><span class='op'>)</span>
<span class='va'>mat_by_id</span> <span class='op'>&lt;-</span> <span class='fu'>make_matrix_detections</span><span class='op'>(</span><span class='va'>dat_acoustics</span><span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::make_matrix_detections() called (@ 2021-12-02 11:56:38)... 
#&gt; ... Checking user inputs... 
#&gt; ... Defining time bins given 'delta_t'... 
#&gt; ... Making detection matrix... 
#&gt; ... flapper::make_matrix_detections() call completed (@ 2021-12-02 11:56:38) after ~0 minutes. </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mat_by_id</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    Length Class Mode   
#&gt; 25 206505 table numeric
#&gt; 28 206505 table numeric
#&gt; 35 206505 table numeric</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>mat_by_id</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]   0 117</div><div class='input'>
<span class='co'>#### Example (2) Construct matrix across all receivers and use set_outside</span>
<span class='va'>dat_moorings</span><span class='op'>$</span><span class='va'>receiver_id</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>dat_moorings</span><span class='op'>$</span><span class='va'>receiver_id</span><span class='op'>)</span>
<span class='va'>dat_acoustics</span><span class='op'>$</span><span class='va'>receiver_id</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>dat_acoustics</span><span class='op'>$</span><span class='va'>receiver_id</span>,
                                    levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/factor.html'>levels</a></span><span class='op'>(</span><span class='va'>dat_moorings</span><span class='op'>$</span><span class='va'>receiver_id</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>match_index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/match.html'>match</a></span><span class='op'>(</span><span class='va'>dat_acoustics</span><span class='op'>$</span><span class='va'>individual_id</span>, <span class='va'>dat_ids</span><span class='op'>$</span><span class='va'>individual_id</span><span class='op'>)</span>
<span class='va'>dat_acoustics</span><span class='op'>$</span><span class='va'>tag_start_date</span> <span class='op'>&lt;-</span> <span class='va'>dat_ids</span><span class='op'>$</span><span class='va'>tag_start_date</span><span class='op'>[</span><span class='va'>match_index</span><span class='op'>]</span>
<span class='va'>dat_acoustics</span><span class='op'>$</span><span class='va'>tag_end_date</span>   <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='st'>"2017-06-02"</span><span class='op'>)</span>
<span class='va'>mat_by_id</span> <span class='op'>&lt;-</span> <span class='fu'>make_matrix_detections</span><span class='op'>(</span><span class='va'>dat_acoustics</span>,
                                    moorings <span class='op'>=</span> <span class='va'>dat_moorings</span>,
                                    set_outside <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::make_matrix_detections() called (@ 2021-12-02 11:56:38)... 
#&gt; ... Checking user inputs... </div><div class='output co'>#&gt; <span class='warning'>Warning: Argument 'acoustics$tag_start_date' coerced to class 'POSIXct' from class(es): 'Date'.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Argument 'acoustics$tag_end_date' coerced to class 'POSIXct' from class(es): 'Date'.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Argument 'moorings$receiver_start_date' coerced to class 'POSIXct' from class(es): 'Date'.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Argument 'moorings$receiver_end_date' coerced to class 'POSIXct' from class(es): 'Date'.</span></div><div class='output co'>#&gt; ... Defining time bins given 'delta_t'... 
#&gt; ... Making receiver matrix... 
#&gt; ... Making detection matrix... 
#&gt; ... flapper::make_matrix_detections() call completed (@ 2021-12-02 11:56:38) after ~0 minutes. </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mat_by_id</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    Length Class Mode   
#&gt; 25 211800 table numeric
#&gt; 28 211800 table numeric
#&gt; 35 211800 table numeric</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


