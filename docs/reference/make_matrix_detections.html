<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Matricise detection time series — make_matrix_detections • flapper</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Matricise detection time series — make_matrix_detections"><meta property="og:description" content="This function creates a list of matrices that, for each individual (list element), defines the number of detections of that individual in each time interval (matrix row) at each receiver (matrix column). To implement the function, a dataframe with acoustic detection time series must be provided via acoustics. The time intervals over which to count detections are provided by optionally defining a start and end date (these can be taken from the range of times in acoustics if unspecified) and the interval (delta_t) between time steps. By default, matrix elements that are `outside' individual or receiver deployment periods are defined as 0 (not detected) but can be changed to another value (e.g., NA) via set_outside. In this case, the acoustics dataframe also needs to include the deployment times for each individual and an additional dataframe must be supplied with the same information for receivers via moorings."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/flapper_algorithms_faqs.html">`flapper`: practitioner FAQs</a>
    </li>
    <li>
      <a href="../articles/flapper_overview.html">`flapper`: an overview</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edwardlavender/flapper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Matricise detection time series</h1>
    <small class="dont-index">Source: <a href="https://github.com/edwardlavender/flapper/blob/HEAD/R/make_matrices.R" class="external-link"><code>R/make_matrices.R</code></a></small>
    <div class="hidden name"><code>make_matrix_detections.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function creates a list of matrices that, for each individual (list element), defines the number of detections of that individual in each time interval (matrix row) at each receiver (matrix column). To implement the function, a dataframe with acoustic detection time series must be provided via <code>acoustics</code>. The time intervals over which to count detections are provided by optionally defining a <code>start</code> and <code>end</code> date (these can be taken from the range of times in <code>acoustics</code> if unspecified) and the interval (<code>delta_t</code>) between time steps. By default, matrix elements that are `outside' individual or receiver deployment periods are defined as 0 (not detected) but can be changed to another value (e.g., NA) via <code>set_outside</code>. In this case, the <code>acoustics</code> dataframe also needs to include the deployment times for each individual and an additional dataframe must be supplied with the same information for receivers via <code>moorings</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">make_matrix_detections</span><span class="op">(</span></span>
<span>  <span class="va">acoustics</span>,</span>
<span>  moorings <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  delta_t <span class="op">=</span> <span class="st">"120 mins"</span>,</span>
<span>  simplify <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  set_outside <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  as_POSIXct <span class="op">=</span> <span class="va">as.POSIXct</span>,</span>
<span>  set_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>acoustics</dt>
<dd><p>A dataframe that defines passive acoustic telemetry detection time series. This should contain the following columns: a vector of individual IDs, named `individual_id'; a (factor) vector of receiver IDs, named `receiver_id'. If <code>set_outside</code> is specified, this should also contain POSIXct vectors of the start and end time of each individual's time at liberty, named `tag_start_date' and `tag_end_date' respectively.</p></dd>


<dt>moorings</dt>
<dd><p>(optional)  If <code>set_outside</code> is specified, <code>moorings</code> is dataframe that defines passive acoustic telemetry receiver metadata. This should contain the following columns: a vector of receiver IDs, named `receiver_id (as in <code>acoustics</code>); and POSIXct vectors of the start and end times of each receiver's deployment time, named `receiver_start_date' and `receiver_end_date' respectively.</p></dd>


<dt>start, end</dt>
<dd><p>POSIXct objects that define the start and end time. If unspecified, these are taken from the range of detection times in <code>acoustics</code>.</p></dd>


<dt>delta_t</dt>
<dd><p>A number or character that defines the time interval between successive time steps. This is passed to the `by' argument of <code><a href="https://rdrr.io/r/base/seq.POSIXt.html" class="external-link">seq.POSIXt</a></code>.</p></dd>


<dt>simplify</dt>
<dd><p>(optional) A function that simplifies detection matrices, such as <code>function(x) (x &gt; 0) + 0</code> to convert counts into a boolean outcomes that define whether or a detection was made.</p></dd>


<dt>set_outside</dt>
<dd><p>(optional) A value (e.g., <code>NA</code>) that is assigned to any matrix element that is outside of an individual's or receiver's deployment period when detection was not possible.</p></dd>


<dt>as_POSIXct</dt>
<dd><p>A function that coerces any supplied times that are not POSIXct objects to POSIXct objects.</p></dd>


<dt>set_names</dt>
<dd><p>A logical variable that defines whether or not to set the row and column names of the matrix to the time steps and the receiver IDs respectively.</p></dd>


<dt>verbose</dt>
<dd><p>A logical variable that defines whether or not to print messages to the console to relay function progress.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A matrix, or a list of matrices (one for each individual in <code>acoustics</code> if there is more than one individual) with one column for each time step and one column for each receiver. Each cell defines whether (1) or not (0) the individual was detected (or, if <code>set_outside</code> is supplied, it could not have been detected) during that time step. All matrices are expressed across the same sequence of time steps and receivers.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edward Lavender</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#### Example (1) Construct matrix from detected individuals using detection time series</span></span></span>
<span class="r-in"><span><span class="va">dat_acoustics</span><span class="op">$</span><span class="va">receiver_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dat_acoustics</span><span class="op">$</span><span class="va">receiver_id</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat_by_id</span> <span class="op">&lt;-</span> <span class="fu">make_matrix_detections</span><span class="op">(</span><span class="va">dat_acoustics</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::make_matrix_detections() called (@ 2023-02-19 15:02:26)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Checking user inputs... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining time bins given 'delta_t'... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Making detection matrix... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::make_matrix_detections() call completed (@ 2023-02-19 15:02:26) after ~0 minutes. </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mat_by_id</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Length Class Mode   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 206505 table numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 206505 table numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 206505 table numeric</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">mat_by_id</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0 60</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (2) Construct matrix across all receivers and use set_outside</span></span></span>
<span class="r-in"><span><span class="va">dat_moorings</span><span class="op">$</span><span class="va">receiver_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dat_moorings</span><span class="op">$</span><span class="va">receiver_id</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat_acoustics</span><span class="op">$</span><span class="va">receiver_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dat_acoustics</span><span class="op">$</span><span class="va">receiver_id</span>,</span></span>
<span class="r-in"><span>                                    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">dat_moorings</span><span class="op">$</span><span class="va">receiver_id</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">match_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">dat_acoustics</span><span class="op">$</span><span class="va">individual_id</span>, <span class="va">dat_ids</span><span class="op">$</span><span class="va">individual_id</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat_acoustics</span><span class="op">$</span><span class="va">tag_start_date</span> <span class="op">&lt;-</span> <span class="va">dat_ids</span><span class="op">$</span><span class="va">tag_start_date</span><span class="op">[</span><span class="va">match_index</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">dat_acoustics</span><span class="op">$</span><span class="va">tag_end_date</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2017-06-02"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat_by_id</span> <span class="op">&lt;-</span> <span class="fu">make_matrix_detections</span><span class="op">(</span><span class="va">dat_acoustics</span>,</span></span>
<span class="r-in"><span>                                    moorings <span class="op">=</span> <span class="va">dat_moorings</span>,</span></span>
<span class="r-in"><span>                                    set_outside <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::make_matrix_detections() called (@ 2023-02-19 15:02:26)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Checking user inputs... </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Argument 'acoustics$tag_start_date' coerced to class 'POSIXct' from class(es): 'Date'.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Argument 'acoustics$tag_end_date' coerced to class 'POSIXct' from class(es): 'Date'.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Argument 'moorings$receiver_start_date' coerced to class 'POSIXct' from class(es): 'Date'.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Argument 'moorings$receiver_end_date' coerced to class 'POSIXct' from class(es): 'Date'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining time bins given 'delta_t'... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Making receiver matrix... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Making detection matrix... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::make_matrix_detections() call completed (@ 2023-02-19 15:02:27) after ~0 minutes. </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mat_by_id</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Length Class Mode   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 211800 table numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 211800 table numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 211800 table numeric</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

