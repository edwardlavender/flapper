<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Process a kernel utilisation distribution around a barrier — kud_around_coastline • flapper</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Process a kernel utilisation distribution around a barrier — kud_around_coastline"><meta property="og:description" content="Given an animal movement path over a gridded surface, kud_around_coastline estimates a `raw' kernel utilisation distribution (from kernelUD) and then processes the distribution to account for barriers to movement, such as coastline. kud_around_coastline_fast is a bare-bones implementation of this function for iterative applications. To implement these functions, the movement path(s) should be supplied as a SpatialPointsDataFrame and the grid over which estimation is implemented as a SpatialPixelsDataFrame with values 0 and 1 defining unsuitable and suitable habitat respectively."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/flapper_algorithms_faqs.html">`flapper`: practitioner FAQs</a>
    </li>
    <li>
      <a href="../articles/flapper_overview.html">`flapper`: an overview</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edwardlavender/flapper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Process a kernel utilisation distribution around a barrier</h1>
    <small class="dont-index">Source: <a href="https://github.com/edwardlavender/flapper/blob/HEAD/R/kud_tools.R" class="external-link"><code>R/kud_tools.R</code></a></small>
    <div class="hidden name"><code>kud_around_coastline.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given an animal movement path over a gridded surface, <code>kud_around_coastline</code> estimates a `raw' kernel utilisation distribution (from <code><a href="https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html" class="external-link">kernelUD</a></code>) and then processes the distribution to account for barriers to movement, such as coastline. <code>kud_around_coastline_fast</code> is a bare-bones implementation of this function for iterative applications. To implement these functions, the movement path(s) should be supplied as a SpatialPointsDataFrame and the grid over which estimation is implemented as a SpatialPixelsDataFrame with values 0 and 1 defining unsuitable and suitable habitat respectively.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">kud_around_coastline</span><span class="op">(</span><span class="va">xy</span>, <span class="va">grid</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kud_around_coastline_fast</span><span class="op">(</span><span class="va">xy</span>, <span class="va">grid</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="source">
    <h2>Source</h2>
    <p>This forum is a useful resource: http://r-sig-geo.2731867.n2.nabble.com/Walruses-and-adehabitatHR-class-estUDm-exclusion-of-non-habitat-pixels-and-summary-over-all-animals-td6497315.html.</p>
    </div>
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>xy</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></code> object that defines the movement path(s). This should contain a column that defines the individual ID(s) as a factor.  <code>kud_around_coastline_fast</code> can only handle one individual.</p></dd>


<dt>grid</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/sp/man/SpatialGridDataFrame.html" class="external-link">SpatialPixelsDataFrame</a></code> object that defines the grid over which estimation is implemented and binary habitat suitability (0, unsuitable; or 1, suitable).</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to <code><a href="https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html" class="external-link">kernelUD</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<ul><li><p><code>kud_around_coastline</code> returns an object of class `estUDm'. This is a list, with one component per animal, of <code><a href="https://rdrr.io/pkg/adehabitatHR/man/estUD-class.html" class="external-link">estUD-class</a></code> objects. The `h' slot of the output (<code>output@h</code>) has been modified so that the method (`meth') is given as `specified'.</p></li>
<li><p><code>kud_around_coastline_fast</code> returns an object of class `RasterLayer'.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Utilisation distributions (UDs) are bivariate probability distributions that describe the probability (density) of locating an individual in any given area at a randomly chosen time. These can be estimated using the <code><a href="https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html" class="external-link">kernelUD</a></code> function. The algorithms implemented by <code><a href="https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html" class="external-link">kernelUD</a></code> function can incorporate simple barriers, but restrictions on the shapes of barriers mean that in many real-world settings (e.g., in areas with complex coastline) barriers cannot be implemented. As a result, a pragmatic (if somewhat unsatisfactory) approach is to post-process the raw utilisation distribution by removing areas in which movement is impossible and then re-normalise the distribution (so that probabilities sum to one). These functions achieve this by implementing the estimation over a grid, which defines whether (1) or not (0) an area is `habitat'. After the estimation of the raw UD across the grid, probability density scores are combined (multiplied) with the habitat suitability score (0, 1) and then renormalised (by dividing by the total score across suitable areas).</p>
<p>To implement these routines, <code>kud_around_coastline</code> is typically the preferable option. <code>kud_around_coastline</code> is a bare-bones implementation of the routines within <code>kud_around_coastline</code> that has is designed to be (marginally) faster (e.g., for iterative applications). This function skips checks on user inputs, assuming that <code>xy</code> and <code>grid</code> have been correctly specified (as a <code><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></code> for a specific individual and a <code><a href="https://rdrr.io/pkg/sp/man/SpatialGridDataFrame.html" class="external-link">SpatialPixelsDataFrame</a></code> respectively), implements the estimation and returns a <code><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></code> rather than an `estUDm' object (see Value).</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edward Lavender</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#### Set up</span></span></span>
<span class="r-in"><span><span class="co">## (1) Simulate path for which to compute UD</span></span></span>
<span class="r-in"><span><span class="co"># Focus on a sample of the marine environment off Oban, West Scotland</span></span></span>
<span class="r-in"><span><span class="va">sea</span> <span class="op">&lt;-</span> <span class="fu"><a href="invert_poly.html">invert_poly</a></span><span class="op">(</span><span class="va">dat_coast</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>GEOS support is provided by the sf and terra packages among others</span>
<span class="r-in"><span><span class="va">sea</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">sea</span>, <span class="fu"><a href="update_extent.html">update_extent</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="va">sea</span><span class="op">)</span>, x_shift <span class="op">=</span> <span class="op">-</span><span class="fl">2500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">prettyGraphics</span><span class="fu">::</span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html" class="external-link">pretty_map</a></span><span class="op">(</span>add_polys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sea</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +datum=WGS84 +units=m +no_defs'.</span>
<span class="r-in"><span><span class="co"># Simulate path</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">path_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_path_sa.html">sim_path_sa</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>,</span></span>
<span class="r-in"><span>                       area <span class="op">=</span> <span class="va">sea</span>,</span></span>
<span class="r-in"><span>                       sim_step <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">1</span>, shape <span class="op">=</span> <span class="fl">20</span>, scale <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       seed <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                       plot <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>                       <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::sim_path_sa() called (@ 2023-02-19 15:00:04)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Simulating movement path... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%... flapper::sim_path_sa() call completed (@ 2023-02-19 15:00:05) after ~0.02 minutes. </span>
<span class="r-in"><span><span class="fu">prettyGraphics</span><span class="fu">::</span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/add_sp.html" class="external-link">add_sp_path</a></span><span class="op">(</span><span class="va">path_ls</span><span class="op">$</span><span class="va">xy_mat</span>,</span></span>
<span class="r-in"><span>                            col <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            length <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="kud_around_coastline-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">## (2) Define path as a SpatialPointsDataFrame (SpatialPoints is not allowed)</span></span></span>
<span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">path_ls</span><span class="op">$</span><span class="va">xy_mat</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">path_ls</span><span class="op">$</span><span class="va">xy_mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    proj4string <span class="op">=</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">dat_coast</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## (3) Define grid over which to implement estimation</span></span></span>
<span class="r-in"><span><span class="co"># ... The grid needs to be sufficiently small to capture the coastline</span></span></span>
<span class="r-in"><span><span class="co"># ... reasonably while being large enough to enable calculation</span></span></span>
<span class="r-in"><span><span class="co"># ... of the home range.</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="va">dat_coast</span><span class="op">)</span>, nrows <span class="op">=</span> <span class="fl">100</span>, ncols <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/mask.html" class="external-link">mask</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">dat_coast</span>, updatevalue <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">habitat</span> <span class="op">&lt;-</span> <span class="fu">methods</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">r</span>, <span class="st">"SpatialPixelsDataFrame"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">habitat</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="kud_around_coastline-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (1) Implement estimation and processing</span></span></span>
<span class="r-in"><span><span class="co">## Estimate raw UD</span></span></span>
<span class="r-in"><span><span class="va">ud_raw</span> <span class="op">&lt;-</span> <span class="fu">adehabitatHR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html" class="external-link">kernelUD</a></span><span class="op">(</span>xy <span class="op">=</span> <span class="va">path</span>, grid <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Object is of class estUDm, which is a list of estUD objects</span></span></span>
<span class="r-in"><span><span class="co"># The outputs for each animal can be accessed by indexing</span></span></span>
<span class="r-in"><span><span class="va">ud_raw</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class "SpatialPixelsDataFrame" (package sp):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grid parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      cellcentre.offset cellsize cells.dim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var2          697711.7 148.1125       100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var1         6248737.3 220.5348       100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variables measured:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ud</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Check smoothing parameters</span></span></span>
<span class="r-in"><span><span class="va">ud_raw</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">h</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $h</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 632.7372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $meth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "href"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## Estimate raw UD and post-process</span></span></span>
<span class="r-in"><span><span class="va">ud_pro</span> <span class="op">&lt;-</span> <span class="fu">kud_around_coastline</span><span class="op">(</span>xy <span class="op">=</span> <span class="va">path</span>, grid <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># The same type of object is returned</span></span></span>
<span class="r-in"><span><span class="va">ud_pro</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class "SpatialPixelsDataFrame" (package sp):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grid parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      cellcentre.offset cellsize cells.dim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var2          697711.7 148.1125       100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var1         6248737.3 220.5348       100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variables measured:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             ud</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2.610702e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Smoothing parameters have been modified</span></span></span>
<span class="r-in"><span><span class="va">ud_pro</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">h</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $h</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $meth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "specified"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## Compare plots</span></span></span>
<span class="r-in"><span><span class="co"># ... Notice that the processed version doesn't 'bleed' onto land</span></span></span>
<span class="r-in"><span><span class="co"># ... and the scale differs due to the re-normalisation</span></span></span>
<span class="r-in"><span><span class="va">ud_raw_r</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">ud_raw</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ud_pro_r</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">ud_pro</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">prettyGraphics</span><span class="fu">::</span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html" class="external-link">pretty_map</a></span><span class="op">(</span>add_rasters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ud_raw_r</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           add_polys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat_coast</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           add_paths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">path</span>,</span></span>
<span class="r-in"><span>                                            col <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            lwd <span class="op">=</span> <span class="fl">0.25</span>,</span></span>
<span class="r-in"><span>                                            length <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-in"><span>                           <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Spatial layers do not have identical CRS strings</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +datum=WGS84 +units=m +no_defs'.</span>
<span class="r-in"><span><span class="fu">prettyGraphics</span><span class="fu">::</span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html" class="external-link">pretty_map</a></span><span class="op">(</span>add_rasters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ud_pro_r</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           add_polys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat_coast</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           add_paths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">path</span>,</span></span>
<span class="r-in"><span>                                            col <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            lwd <span class="op">=</span> <span class="fl">0.25</span>,</span></span>
<span class="r-in"><span>                                            length <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-in"><span>                           <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Spatial layers do not have identical CRS strings</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +datum=WGS84 +units=m +no_defs'.</span>
<span class="r-plt img"><img src="kud_around_coastline-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Further analysis can be implemented as usual</span></span></span>
<span class="r-in"><span><span class="co"># For example we can compute the home range contours from the UD</span></span></span>
<span class="r-in"><span><span class="co"># ... using adehabitatHR::getvolumeUD(). In practice, this converts from the</span></span></span>
<span class="r-in"><span><span class="co"># ... probability density scale to a more intuitive % home range scale.</span></span></span>
<span class="r-in"><span><span class="co"># Get volume</span></span></span>
<span class="r-in"><span><span class="va">vol_raw</span> <span class="op">&lt;-</span> <span class="fu">adehabitatHR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html" class="external-link">getvolumeUD</a></span><span class="op">(</span><span class="va">ud_raw</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vol_pro</span> <span class="op">&lt;-</span> <span class="fu">adehabitatHR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html" class="external-link">getvolumeUD</a></span><span class="op">(</span><span class="va">ud_pro</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Get contours</span></span></span>
<span class="r-in"><span><span class="va">ver_raw</span> <span class="op">&lt;-</span> <span class="fu">adehabitatHR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html" class="external-link">getverticeshr</a></span><span class="op">(</span><span class="va">ud_raw</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ver_pro</span> <span class="op">&lt;-</span> <span class="fu">adehabitatHR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html" class="external-link">getverticeshr</a></span><span class="op">(</span><span class="va">ud_pro</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Rasterise</span></span></span>
<span class="r-in"><span><span class="va">vol_raw_r</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">vol_raw</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vol_pro_r</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">vol_pro</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># For neatness on the plot, it is convenient to exclude areas beyond 95 %</span></span></span>
<span class="r-in"><span><span class="va">vol_raw_r</span><span class="op">[</span><span class="va">vol_raw_r</span><span class="op">[</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">95</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">vol_pro_r</span><span class="op">[</span><span class="va">vol_pro_r</span><span class="op">[</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">95</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="co"># Plot</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">prettyGraphics</span><span class="fu">::</span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html" class="external-link">pretty_map</a></span><span class="op">(</span>add_rasters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">vol_raw_r</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           add_polys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat_coast</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ver_raw</span>,</span></span>
<span class="r-in"><span>                                                 border <span class="op">=</span> <span class="st">"blue"</span>,</span></span>
<span class="r-in"><span>                                                 lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           add_paths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">path</span>,</span></span>
<span class="r-in"><span>                                            col <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            lwd <span class="op">=</span> <span class="fl">0.25</span>,</span></span>
<span class="r-in"><span>                                            length <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-in"><span>                           <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Spatial layers do not have identical CRS strings</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +datum=WGS84 +units=m +no_defs'.</span>
<span class="r-in"><span><span class="fu">prettyGraphics</span><span class="fu">::</span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html" class="external-link">pretty_map</a></span><span class="op">(</span>add_rasters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">vol_pro_r</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           add_polys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat_coast</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ver_pro</span>,</span></span>
<span class="r-in"><span>                                                 border <span class="op">=</span> <span class="st">"blue"</span>,</span></span>
<span class="r-in"><span>                                                 lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           add_paths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">path</span>,</span></span>
<span class="r-in"><span>                                            col <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            lwd <span class="op">=</span> <span class="fl">0.25</span>,</span></span>
<span class="r-in"><span>                                            length <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></span>
<span class="r-in"><span>                           <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Spatial layers do not have identical CRS strings</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +datum=WGS84 +units=m +no_defs'.</span>
<span class="r-plt img"><img src="kud_around_coastline-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

