<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Process a kernel utilisation distribution around a barrier — kud_around_coastline • flapper</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Process a kernel utilisation distribution around a barrier — kud_around_coastline" />
<meta property="og:description" content="Given an animal movement path over a gridded surface, kud_around_coastline estimates a `raw' kernel utilisation distribution (from kernelUD) and then processes the distribution to account for barriers to movement, such as coastline. kud_around_coastline_fast is a bare-bones implementation of this function for iterative applications. To implement these functions, the movement path(s) should be supplied as a SpatialPointsDataFrame and the grid over which estimation is implemented as a SpatialPixelsDataFrame with values 0 and 1 defining unsuitable and suitable habitat respectively." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/flapper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/edwardlavender/flapper/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Process a kernel utilisation distribution around a barrier</h1>
    <small class="dont-index">Source: <a href='https://github.com/edwardlavender/flapper/blob/master/R/kud_tools.R'><code>R/kud_tools.R</code></a></small>
    <div class="hidden name"><code>kud_around_coastline.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given an animal movement path over a gridded surface, <code>kud_around_coastline</code> estimates a `raw' kernel utilisation distribution (from <code><a href='https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html'>kernelUD</a></code>) and then processes the distribution to account for barriers to movement, such as coastline. <code>kud_around_coastline_fast</code> is a bare-bones implementation of this function for iterative applications. To implement these functions, the movement path(s) should be supplied as a SpatialPointsDataFrame and the grid over which estimation is implemented as a SpatialPixelsDataFrame with values 0 and 1 defining unsuitable and suitable habitat respectively.</p>
    </div>

    <pre class="usage"><span class='fu'>kud_around_coastline</span><span class='op'>(</span><span class='va'>xy</span>, <span class='va'>grid</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>kud_around_coastline_fast</span><span class='op'>(</span><span class='va'>xy</span>, <span class='va'>grid</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>xy</th>
      <td><p>A <code><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPointsDataFrame</a></code> object that defines the movement path(s). This should contain a column that defines the individual ID(s) as a factor.  <code>kud_around_coastline_fast</code> can only handle one individual.</p></td>
    </tr>
    <tr>
      <th>grid</th>
      <td><p>A <code><a href='https://rdrr.io/pkg/sp/man/SpatialGridDataFrame.html'>SpatialPixelsDataFrame</a></code> object that defines the grid over which estimation is implemented and binary habitat suitability (0, unsuitable; or 1, suitable).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code><a href='https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html'>kernelUD</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>This forum is a useful resource: http://r-sig-geo.2731867.n2.nabble.com/Walruses-and-adehabitatHR-class-estUDm-exclusion-of-non-habitat-pixels-and-summary-over-all-animals-td6497315.html.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    
<ul>
<li><p><code>kud_around_coastline</code> returns an object of class `estUDm'. This is a list, with one component per animal, of <code><a href='https://rdrr.io/pkg/adehabitatHR/man/estUD-class.html'>estUD-class</a></code> objects. The `h' slot of the output (<code>output@h</code>) has been modified so that the method (`meth') is given as `specified'.</p></li>
<li><p><code>kud_around_coastline_fast</code> returns an object of class `RasterLayer'.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Utilisation distributions (UDs) are bivariate probability distributions that describe the probability (density) of locating an individual in any given area at a randomly chosen time. These can be estimated using the <code><a href='https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html'>kernelUD</a></code> function. The algorithms implemented by <code><a href='https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html'>kernelUD</a></code> function can incorporate simple barriers, but restrictions on the shapes of barriers mean that in many real-world settings (e.g., in areas with complex coastline) barriers cannot be implemented. As a result, a pragmatic (if somewhat unsatisfactory) approach is to post-process the raw utilisation distribution by removing areas in which movement is impossible and then re-normalise the distribution (so that probabilities sum to one). These functions achieve this by implementing the estimation over a grid, which defines whether (1) or not (0) an area is `habitat'. After the estimation of the raw UD across the grid, probability density scores are combined (multiplied) with the habitat suitability score (0, 1) and then renormalised (by dividing by the total score across suitable areas).</p>
<p>To implement these routines, <code>kud_around_coastline</code> is typically the preferable option. <code>kud_around_coastline</code> is a bare-bones implementation of the routines within <code>kud_around_coastline</code> that has is designed to be (marginally) faster (e.g., for iterative applications). This function skips checks on user inputs, assuming that <code>xy</code> and <code>grid</code> have been correctly specified (as a <code><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPointsDataFrame</a></code> for a specific individual and a <code><a href='https://rdrr.io/pkg/sp/man/SpatialGridDataFrame.html'>SpatialPixelsDataFrame</a></code> respectively), implements the estimation and returns a <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> rather than an `estUDm' object (see Value).</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Edward Lavender</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#### Set up</span>
<span class='co'>## (1) Simulate path for which to compute UD</span>
<span class='co'># Focus on a sample of the marine environment off Oban, West Scotland</span>
<span class='va'>sea</span> <span class='op'>&lt;-</span> <span class='fu'><a href='invert_poly.html'>invert_poly</a></span><span class='op'>(</span><span class='va'>dat_coast</span><span class='op'>)</span>
<span class='va'>sea</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/crop.html'>crop</a></span><span class='op'>(</span><span class='va'>sea</span>, <span class='fu'><a href='update_extent.html'>update_extent</a></span><span class='op'>(</span><span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></span><span class='op'>(</span><span class='va'>sea</span><span class='op'>)</span>, x_shift <span class='op'>=</span> <span class='op'>-</span><span class='fl'>2500</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>prettyGraphics</span><span class='fu'>::</span><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html'>pretty_map</a></span><span class='op'>(</span>add_polys <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>sea</span>, col <span class='op'>=</span> <span class='st'>"skyblue"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +datum=WGS84 +units=m +no_defs'.</span></div><div class='input'><span class='co'># Simulate path</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>path_ls</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sim_path_sa.html'>sim_path_sa</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n</span>,
                       area <span class='op'>=</span> <span class='va'>sea</span>,
                       sim_step <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>rgamma</a></span><span class='op'>(</span><span class='fl'>1</span>, shape <span class='op'>=</span> <span class='fl'>20</span>, scale <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>,
                       seed <span class='op'>=</span> <span class='fl'>1</span>,
                       plot <span class='op'>=</span> <span class='cn'>FALSE</span>
                       <span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::sim_path_sa() called (@ 2022-06-17 10:04:31)... 
#&gt; ... Setting up simulation... 
#&gt; ... Simulating movement path... 
#&gt;   |                                                                              |                                                                      |   0%</div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%... flapper::sim_path_sa() call completed (@ 2022-06-17 10:04:33) after ~0.04 minutes. </div><div class='input'><span class='fu'>prettyGraphics</span><span class='fu'>::</span><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/add_sp.html'>add_sp_path</a></span><span class='op'>(</span><span class='va'>path_ls</span><span class='op'>$</span><span class='va'>xy_mat</span>,
                            col <span class='op'>=</span> <span class='fu'>viridis</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/viridisLite/man/viridis.html'>viridis</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>,
                            length <span class='op'>=</span> <span class='fl'>0.02</span><span class='op'>)</span>
</div><div class='img'><img src='kud_around_coastline-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## (2) Define path as a SpatialPointsDataFrame (SpatialPoints is not allowed)</span>
<span class='va'>path</span> <span class='op'>&lt;-</span> <span class='fu'>sp</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPointsDataFrame</a></span><span class='op'>(</span>
  <span class='va'>path_ls</span><span class='op'>$</span><span class='va'>xy_mat</span>,
  data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/ncell.html'>nrow</a></span><span class='op'>(</span><span class='va'>path_ls</span><span class='op'>$</span><span class='va'>xy_mat</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
                    proj4string <span class='op'>=</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/projection.html'>crs</a></span><span class='op'>(</span><span class='va'>dat_coast</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>## (3) Define grid over which to implement estimation</span>
<span class='co'># ... The grid needs to be sufficiently small to capture the coastline</span>
<span class='co'># ... reasonably while being large enough to enable calculation</span>
<span class='co'># ... of the home range.</span>
<span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></span><span class='op'>(</span><span class='va'>dat_coast</span><span class='op'>)</span>, nrows <span class='op'>=</span> <span class='fl'>100</span>, ncols <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
<span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/getValues.html'>values</a></span><span class='op'>(</span><span class='va'>r</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
<span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/mask.html'>mask</a></span><span class='op'>(</span><span class='va'>r</span>, <span class='va'>dat_coast</span>, updatevalue <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>habitat</span> <span class='op'>&lt;-</span> <span class='fu'>methods</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/methods/as.html'>as</a></span><span class='op'>(</span><span class='va'>r</span>, <span class='st'>"SpatialPixelsDataFrame"</span><span class='op'>)</span>
<span class='fu'>sp</span><span class='fu'>::</span><span class='fu'>plot</span><span class='op'>(</span><span class='va'>habitat</span><span class='op'>)</span>
</div><div class='img'><img src='kud_around_coastline-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#### Example (1) Implement estimation and processing</span>
<span class='co'>## Estimate raw UD</span>
<span class='va'>ud_raw</span> <span class='op'>&lt;-</span> <span class='fu'>adehabitatHR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html'>kernelUD</a></span><span class='op'>(</span>xy <span class='op'>=</span> <span class='va'>path</span>, grid <span class='op'>=</span> <span class='va'>habitat</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='input'><span class='co'># Object is of class estUDm, which is a list of estUD objects</span>
<span class='co'># The outputs for each animal can be accessed by indexing</span>
<span class='va'>ud_raw</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
</div><div class='output co'>#&gt; ********** Utilization distribution of an Animal ************
#&gt; 
#&gt; Type: probability density
#&gt; Smoothing parameter estimated with a  href parameter
#&gt; This object inherits from the class SpatialPixelsDataFrame.
#&gt; See estUD-class for more information
#&gt; </div><div class='input'><span class='co'># Check smoothing parameters</span>
<span class='va'>ud_raw</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>@</span><span class='va'>h</span>
</div><div class='output co'>#&gt; $h
#&gt; [1] 632.7372
#&gt; 
#&gt; $meth
#&gt; [1] "href"
#&gt; </div><div class='input'><span class='co'>## Estimate raw UD and post-process</span>
<span class='va'>ud_pro</span> <span class='op'>&lt;-</span> <span class='fu'>kud_around_coastline</span><span class='op'>(</span>xy <span class='op'>=</span> <span class='va'>path</span>, grid <span class='op'>=</span> <span class='va'>habitat</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='input'><span class='co'># The same type of object is returned</span>
<span class='va'>ud_pro</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
</div><div class='output co'>#&gt; ********** Utilization distribution of an Animal ************
#&gt; 
#&gt; Type: probability density
#&gt; Smoothing parameter estimated with a  specified parameter
#&gt; This object inherits from the class SpatialPixelsDataFrame.
#&gt; See estUD-class for more information
#&gt; </div><div class='input'><span class='co'># Smoothing parameters have been modified</span>
<span class='va'>ud_pro</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>@</span><span class='va'>h</span>
</div><div class='output co'>#&gt; $h
#&gt; [1] 0
#&gt; 
#&gt; $meth
#&gt; [1] "specified"
#&gt; </div><div class='input'><span class='co'>## Compare plots</span>
<span class='co'># ... Notice that the processed version doesn't 'bleed' onto land</span>
<span class='co'># ... and the scale differs due to the re-normalisation</span>
<span class='va'>ud_raw_r</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='va'>ud_raw</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>ud_pro_r</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='va'>ud_pro</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>pp</span> <span class='op'>&lt;-</span> <span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>prettyGraphics</span><span class='fu'>::</span><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html'>pretty_map</a></span><span class='op'>(</span>add_rasters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>ud_raw_r</span><span class='op'>)</span>,
                           add_polys <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dat_coast</span><span class='op'>)</span>,
                           add_paths <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>path</span>,
                                            col <span class='op'>=</span> <span class='fu'>viridis</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/viridisLite/man/viridis.html'>viridis</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>,
                                            lwd <span class='op'>=</span> <span class='fl'>0.25</span>,
                                            length <span class='op'>=</span> <span class='fl'>0.02</span><span class='op'>)</span>
                           <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +datum=WGS84 +units=m +no_defs'.</span></div><div class='input'><span class='fu'>prettyGraphics</span><span class='fu'>::</span><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html'>pretty_map</a></span><span class='op'>(</span>add_rasters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>ud_pro_r</span><span class='op'>)</span>,
                           add_polys <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dat_coast</span><span class='op'>)</span>,
                           add_paths <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>path</span>,
                                            col <span class='op'>=</span> <span class='fu'>viridis</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/viridisLite/man/viridis.html'>viridis</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>,
                                            lwd <span class='op'>=</span> <span class='fl'>0.25</span>,
                                            length <span class='op'>=</span> <span class='fl'>0.02</span><span class='op'>)</span>
                           <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +datum=WGS84 +units=m +no_defs'.</span></div><div class='img'><img src='kud_around_coastline-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>pp</span><span class='op'>)</span>

<span class='co'>#### Further analysis can be implemented as usual</span>
<span class='co'># For example we can compute the home range contours from the UD</span>
<span class='co'># ... using adehabitatHR::getvolumeUD(). In practice, this converts from the</span>
<span class='co'># ... probability density scale to a more intuitive % home range scale.</span>
<span class='co'># Get volume</span>
<span class='va'>vol_raw</span> <span class='op'>&lt;-</span> <span class='fu'>adehabitatHR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html'>getvolumeUD</a></span><span class='op'>(</span><span class='va'>ud_raw</span>, standardize <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='input'><span class='va'>vol_pro</span> <span class='op'>&lt;-</span> <span class='fu'>adehabitatHR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/adehabitatHR/man/kernelUD.html'>getvolumeUD</a></span><span class='op'>(</span><span class='va'>ud_pro</span>, standardize <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='input'><span class='co'># Get contours</span>
<span class='va'>ver_raw</span> <span class='op'>&lt;-</span> <span class='fu'>adehabitatHR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html'>getverticeshr</a></span><span class='op'>(</span><span class='va'>ud_raw</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, standardize <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='input'><span class='va'>ver_pro</span> <span class='op'>&lt;-</span> <span class='fu'>adehabitatHR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/adehabitatHR/man/getverticeshr.html'>getverticeshr</a></span><span class='op'>(</span><span class='va'>ud_pro</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, standardize <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='output co'>#&gt; <span class='warning'>Warning: CRS object has comment, which is lost in output; in tests, see</span>
#&gt; <span class='warning'>https://cran.r-project.org/web/packages/sp/vignettes/CRS_warnings.html</span></div><div class='input'><span class='co'># Rasterise</span>
<span class='va'>vol_raw_r</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='va'>vol_raw</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>vol_pro_r</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='va'>vol_pro</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
<span class='co'># For neatness on the plot, it is convenient to exclude areas beyond 95 %</span>
<span class='va'>vol_raw_r</span><span class='op'>[</span><span class='va'>vol_raw_r</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='fl'>95</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='va'>vol_pro_r</span><span class='op'>[</span><span class='va'>vol_pro_r</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='fl'>95</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='co'># Plot</span>
<span class='va'>pp</span> <span class='op'>&lt;-</span> <span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>prettyGraphics</span><span class='fu'>::</span><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html'>pretty_map</a></span><span class='op'>(</span>add_rasters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>vol_raw_r</span><span class='op'>)</span>,
                           add_polys <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dat_coast</span><span class='op'>)</span>,
                                            <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>ver_raw</span>,
                                                 border <span class='op'>=</span> <span class='st'>"blue"</span>,
                                                 lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
                           add_paths <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>path</span>,
                                            col <span class='op'>=</span> <span class='fu'>viridis</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/viridisLite/man/viridis.html'>viridis</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>,
                                            lwd <span class='op'>=</span> <span class='fl'>0.25</span>,
                                            length <span class='op'>=</span> <span class='fl'>0.02</span><span class='op'>)</span>
                           <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +datum=WGS84 +units=m +no_defs'.</span></div><div class='input'><span class='fu'>prettyGraphics</span><span class='fu'>::</span><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html'>pretty_map</a></span><span class='op'>(</span>add_rasters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>vol_pro_r</span><span class='op'>)</span>,
                           add_polys <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dat_coast</span><span class='op'>)</span>,
                                            <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>ver_pro</span>,
                                                 border <span class='op'>=</span> <span class='st'>"blue"</span>,
                                                 lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
                           add_paths <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>path</span>,
                                            col <span class='op'>=</span> <span class='fu'>viridis</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/viridisLite/man/viridis.html'>viridis</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>,
                                            lwd <span class='op'>=</span> <span class='fl'>0.25</span>,
                                            length <span class='op'>=</span> <span class='fl'>0.02</span><span class='op'>)</span>
                           <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +datum=WGS84 +units=m +no_defs'.</span></div><div class='img'><img src='kud_around_coastline-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>pp</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


