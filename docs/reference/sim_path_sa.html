<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate discrete-time movement paths from step lengths and turning angles — sim_path_sa • flapper</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate discrete-time movement paths from step lengths and turning angles — sim_path_sa" />
<meta property="og:description" content="This function simulates movement paths from step lengths and turning angles. To implement the function, the number of time steps (n) needs to be specified and, if applicable, the area within which movement should occur. For example, in marine environments, the inclusion of the sea as a spatial layer would restrict movement within the sea*. The starting location (p_1) can be provided or simulated. At each time step, user-defined functions are used to simulate step lengths and turning angles, which can depend previous values of those variables via a lag parameter, from which the next position is calculated. This implementation enables movement paths to be simulated under a variety of movement models, including random walks and correlated random walks, providing that they are conceptualised in terms of step lengths and turning angles. The function returns a list of outputs that includes the simulated path and, if requested, produces a plot of the simulated path." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/flapper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/edwardlavender/flapper/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate discrete-time movement paths from step lengths and turning angles</h1>
    <small class="dont-index">Source: <a href='https://github.com/edwardlavender/flapper/blob/master/R/sims.R'><code>R/sims.R</code></a></small>
    <div class="hidden name"><code>sim_path_sa.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function simulates movement paths from step lengths and turning angles. To implement the function, the number of time steps (<code>n</code>) needs to be specified and, if applicable, the area within which movement should occur. For example, in marine environments, the inclusion of the sea as a spatial layer would restrict movement within the sea*. The starting location (<code>p_1</code>) can be provided or simulated. At each time step, user-defined functions are used to simulate step lengths and turning angles, which can depend previous values of those variables via a <code>lag</code> parameter, from which the next position is calculated. This implementation enables movement paths to be simulated under a variety of movement models, including random walks and correlated random walks, providing that they are conceptualised in terms of step lengths and turning angles. The function returns a list of outputs that includes the simulated path and, if requested, produces a plot of the simulated path.</p>
    </div>

    <pre class="usage"><span class='fu'>sim_path_sa</span><span class='op'>(</span>
  n <span class='op'>=</span> <span class='fl'>10</span>,
  area <span class='op'>=</span> <span class='cn'>NULL</span>,
  p_1 <span class='op'>=</span> <span class='cn'>NULL</span>,
  sim_angle <span class='op'>=</span> <span class='va'>sim_angles</span>,
  sim_step <span class='op'>=</span> <span class='va'>sim_steps</span>,
  lag <span class='op'>=</span> <span class='fl'>0L</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  add_points <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pch <span class='op'>=</span> <span class='fl'>21</span>, bg <span class='op'>=</span> <span class='st'>"darkgreen"</span><span class='op'>)</span>,
  add_path <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fl'>0.05</span>, col <span class='op'>=</span> <span class='fu'>viridis</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/viridisLite/man/viridis.html'>viridis</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span>,
  add_area <span class='op'>=</span> <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>area</span><span class='op'>)</span><span class='op'>)</span> <span class='cn'>NULL</span> <span class='kw'>else</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  seed <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>sim_steps</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span>

<span class='fu'>sim_angles</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>An integer that defines the number of time steps in the simulation.</p></td>
    </tr>
    <tr>
      <th>area</th>
      <td><p>(optional) A <code><a href='https://rdrr.io/pkg/sp/man/SpatialPolygons-class.html'>SpatialPolygons-class</a></code> or <code><a href='https://rdrr.io/pkg/sp/man/SpatialPolygonsDataFrame-class.html'>SpatialPolygonsDataFrame-class</a></code> object that defines the area(s) within which movement is allowed.</p></td>
    </tr>
    <tr>
      <th>p_1</th>
      <td><p>(optional) A matrix with one row and two columns that defines the starting location (x, y). If <code>p_1 = NULL</code>, then a random location is sampled from <code>area</code>, if applicable, or simulated from a uniform distribution with a minimum and maximum value of 0 and 1 respectively.</p></td>
    </tr>
    <tr>
      <th>sim_angle</th>
      <td><p>A function that is used to simulate turning angles. This must accept a single number that represents some previous turning angle (degrees), even if this is simply ignored (see <code>lag</code>, below). For example, <code>sim_angle = function() 1</code> will break but <code>sim_angle = function(...) 1</code> is fine. For convenience, a default function is included that simulates angles from a wrapped normal circular distribution with a mean and standard deviation of 1 (see <code><a href='https://rdrr.io/pkg/circular/man/wrappednormal.html'>rwrappednormal</a></code>). Functions that actually depend on some previous angle also need to be able to generate initial angles before enough previous angles have been generated for the function to depend on those (see <code>lag</code>, below). All functions should return a single number that defines the turning angle in degrees.</p></td>
    </tr>
    <tr>
      <th>sim_step</th>
      <td><p>A function that is used to simulate step lengths. This follows the same rules as for <code>sim_angle</code>. For convenience, a default function is included that simulates angles from a gamma distribution with shape and scale parameters of 15 (see <code><a href='https://rdrr.io/r/stats/GammaDist.html'>rgamma</a></code>).</p></td>
    </tr>
    <tr>
      <th>lag</th>
      <td><p>If <code>sim_angle</code> and/or <code>sim_step</code> have been defined such that they depend on some previous angle/step length, then <code>lag</code> is an integer that defines the number of time steps between the current time step and some previous time step that affects the current turning angle and/or step length.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>A logical variable that defines whether or not to produce a plot of the area (if provided) and the simulated movement path.</p></td>
    </tr>
    <tr>
      <th>add_area, add_points, add_path</th>
      <td><p>(optional) Named lists of arguments that are used to customise the appearance of the area, points (the starting location) and the path on the map, passed to the <code>add_polys</code>, <code>add_points</code> and <code>add_points</code> arguments of <code><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html'>pretty_map</a></code>.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>(optional) An integer that defines the seed (for reproducible simulations: see <code><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></code>).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical variable that defines whether or not to print messages to the console that relay function progress.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments. For <code>sim_path_sa</code>, these are passed to <code><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html'>pretty_map</a></code> to customise the map. For the default <code>sim_angles</code> and <code>sim_steps</code> functions, <code>...</code> is required but additional parameters are ignored.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns a named list of arguments that defines the simulated path (`xy_mat', `angle_mat', `step_mat' and `path') and a named list of arguments that were used to generate the path (`args'). `xy_mat' is an n-row, two-column matrix that defines the simulated position (x, y) at each time step; `angle_mat' and `step_mat' are n-row, one-column matrices that define the simulated turning angle (degrees) and step length (in map units) at each time step; and `path' is a <code><a href='https://rdrr.io/pkg/sp/man/SpatialLines.html'>SpatialLines</a></code> representation of the movement path.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>*Strictly speaking, only sequential positions are restricted to be within the allowed area. Yet since steps in the current implementation of the function are linear, the simulation of relatively large step lengths in an area with complex barriers to movement (e.g., convoluted coastlines), may lead to movement over inappropriate areas (e.g., over a peninsula) even through sequential positions are within the allowed area (e.g., either side of a peninsula). This problem can be mitigated by simulating time series for which sequential observations are closer in time (and thus for which step lengths are more constrained). For longer time series for which short time steps are undesirable, least-cost paths (e.g., see <code><a href='lcp_over_surface.html'>lcp_over_surface</a></code>) may be implemented to ensure biologically meaningful movements in future (but this is more computationally demanding for rapid simulations).</p>
<p>This function requires the <code><a href='https://rdrr.io/pkg/circular/man/circular.html'>circular</a></code> package.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>For movement simulations, see <code><a href='sim_path_*.html'>sim_path_*</a></code> for the full list of functions currently implemented in <code><a href='flapper.html'>flapper</a></code>. For example, <code><a href='sim_path_ou_1.html'>sim_path_ou_1</a></code> simulates a movement path based on past locations according to an Ornstein-Uhlenbeck process (which is not based on step lengths and turning angles). More broadly, <code><a href='sim_array.html'>sim_array</a></code>, <code><a href='sim_path_*.html'>sim_path_*</a></code> and <code><a href='sim_detections.html'>sim_detections</a></code> provide an integrated workflow for simulating acoustic arrays, movement paths in these areas and detections at receivers arising from movement.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Edward Lavender</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#### Example (1): Simulate movement path under default parameters</span>
<span class='co'># Simulate path</span>
<span class='va'>path</span> <span class='op'>&lt;-</span> <span class='fu'>sim_path_sa</span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::sim_path_sa() called (@ 2021-12-02 12:00:42)... 
#&gt; ... Setting up simulation... 
#&gt; ... Simulating movement path... 
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%... Plotting simulated path... </div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: 'NA'.</span></div><div class='img'><img src='sim_path_sa-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; ... flapper::sim_path_sa() call completed (@ 2021-12-02 12:00:42) after ~0 minutes. </div><div class='input'><span class='co'># The function returns a list of parameters that define the array and a plot</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>path</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           Length Class        Mode   
#&gt; xy_mat    20     -none-       numeric
#&gt; angle_mat 10     -none-       numeric
#&gt; step_mat  10     -none-       numeric
#&gt; path       1     SpatialLines S4     
#&gt; args      11     -none-       list   </div><div class='input'>
<span class='co'>#### Example (2): Change the number of time steps</span>
<span class='va'>path</span> <span class='op'>&lt;-</span> <span class='fu'>sim_path_sa</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::sim_path_sa() called (@ 2021-12-02 12:00:42)... 
#&gt; ... Setting up simulation... 
#&gt; ... Simulating movement path... 
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%... Plotting simulated path... </div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: 'NA'.</span></div><div class='img'><img src='sim_path_sa-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; ... flapper::sim_path_sa() call completed (@ 2021-12-02 12:00:42) after ~0 minutes. </div><div class='input'>
<span class='co'>#### Example (3): Change the characteristics of the study area</span>
<span class='co'># .. and define the starting location of the individual</span>
<span class='va'>sea</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='invert_poly.html'>invert_poly</a></span><span class='op'>(</span><span class='va'>dat_coast</span><span class='op'>)</span>
<span class='va'>path</span> <span class='op'>&lt;-</span> <span class='fu'>sim_path_sa</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>100</span>,
                    area <span class='op'>=</span> <span class='va'>sea</span>,
                    p_1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>706529.1</span>, <span class='fl'>6262293</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
                    add_area <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>sea</span>, col <span class='op'>=</span> <span class='st'>"skyblue"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::sim_path_sa() called (@ 2021-12-02 12:00:42)... 
#&gt; ... Setting up simulation... 
#&gt; ... Simulating movement path... 
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%... Plotting simulated path... </div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: '+proj=utm +zone=29 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs'.</span></div><div class='img'><img src='sim_path_sa-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; ... flapper::sim_path_sa() call completed (@ 2021-12-02 12:00:42) after ~0 minutes. </div><div class='input'>
<span class='co'>#### Example (4): Change the movement model(s) to use alternative distributions/parameters</span>

<span class='co'>## Step lengths</span>
<span class='co'># Define new function to simulate step lengths</span>
<span class='va'>sim_step_lengths</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>rgamma</a></span><span class='op'>(</span><span class='fl'>1</span>, shape <span class='op'>=</span> <span class='fl'>10</span>, scale <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='co'># Check outputs suitable values</span>
<span class='fu'>prettyGraphics</span><span class='fu'>::</span><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_hist.html'>pretty_hist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1000</span>, expr <span class='op'>=</span> <span class='fu'>sim_step_lengths</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='sim_path_sa-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Implement simulation</span>
<span class='va'>path</span> <span class='op'>&lt;-</span> <span class='fu'>sim_path_sa</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>100</span>, sim_step <span class='op'>=</span> <span class='va'>sim_step_lengths</span><span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::sim_path_sa() called (@ 2021-12-02 12:00:42)... 
#&gt; ... Setting up simulation... 
#&gt; ... Simulating movement path... 
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%... Plotting simulated path... </div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: 'NA'.</span></div><div class='img'><img src='sim_path_sa-5.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; ... flapper::sim_path_sa() call completed (@ 2021-12-02 12:00:42) after ~0 minutes. </div><div class='input'><span class='fu'>prettyGraphics</span><span class='fu'>::</span><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_hist.html'>pretty_hist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>path</span><span class='op'>$</span><span class='va'>step_mat</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='sim_path_sa-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Turning angles</span>
<span class='co'># E.g., Random walk: draw turning angle from von Mises distribution</span>
<span class='va'>sim_angles_vmd</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>angle</span> <span class='op'>&lt;-</span> <span class='fu'>circular</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/circular/man/vonmises.html'>rvonmises</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1</span>,
                               mu <span class='op'>=</span> <span class='fu'>circular</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/circular/man/circular.html'>circular</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>,
                               kappa <span class='op'>=</span> <span class='fl'>0</span>,
                               control.circular <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>units <span class='op'>=</span> <span class='st'>"degrees"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>angle</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>path</span> <span class='op'>&lt;-</span> <span class='fu'>sim_path_sa</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>100</span>, sim_angle <span class='op'>=</span> <span class='va'>sim_angles_vmd</span><span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::sim_path_sa() called (@ 2021-12-02 12:00:42)... 
#&gt; ... Setting up simulation... 
#&gt; ... Simulating movement path... 
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%... Plotting simulated path... </div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: 'NA'.</span></div><div class='img'><img src='sim_path_sa-7.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; ... flapper::sim_path_sa() call completed (@ 2021-12-02 12:00:42) after ~0 minutes. </div><div class='input'>
<span class='co'># E.g., Correlated random walk: draw turning angle from wrapped normal distribution</span>
<span class='va'>sim_angles_rwn</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>angle</span> <span class='op'>&lt;-</span> <span class='fu'>circular</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/circular/man/wrappednormal.html'>rwrappednormal</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1</span>,
                                    mu <span class='op'>=</span> <span class='fu'>circular</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/circular/man/circular.html'>circular</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>,
                                    rho <span class='op'>=</span> <span class='fl'>0.999</span>,
                                    sd <span class='op'>=</span> <span class='fl'>0</span>,
                                    control.circular <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>units <span class='op'>=</span> <span class='st'>"degrees"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>angle</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>path</span> <span class='op'>&lt;-</span> <span class='fu'>sim_path_sa</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>100</span>, sim_angle <span class='op'>=</span> <span class='va'>sim_angles_rwn</span><span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::sim_path_sa() called (@ 2021-12-02 12:00:42)... 
#&gt; ... Setting up simulation... 
#&gt; ... Simulating movement path... 
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%... Plotting simulated path... </div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: 'NA'.</span></div><div class='img'><img src='sim_path_sa-8.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; ... flapper::sim_path_sa() call completed (@ 2021-12-02 12:00:42) after ~0 minutes. </div><div class='input'>
<span class='co'>#### Example (5) Change the movement models to depend on some lagged value</span>
<span class='co'># ... of the variable in question</span>
<span class='co'># Define a sim_angle function that depends on some previous angle</span>
<span class='co'># While the time step is less than the lag, the function needs to be</span>
<span class='co'># ... able to handle missing angles and return sensible values in these</span>
<span class='co'># ... cases e.g., via an 'is.null' structure:</span>
<span class='va'>sim_angles_wrn_with_lag</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>angle</span> <span class='op'>=</span> <span class='cn'>NULL</span>,<span class='va'>...</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>angle</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"\n... ... method (1) activated...\n"</span><span class='op'>)</span> <span class='co'># useful check</span>
    <span class='va'>angle_out</span> <span class='op'>&lt;-</span> <span class='fu'>circular</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/circular/man/circular.html'>circular</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='kw'>else</span><span class='op'>{</span>
    <span class='va'>angle_out</span> <span class='op'>&lt;-</span> <span class='fu'>circular</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/circular/man/wrappednormal.html'>rwrappednormal</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>1</span>,
                                          mu <span class='op'>=</span> <span class='fu'>circular</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/circular/man/circular.html'>circular</a></span><span class='op'>(</span><span class='va'>angle</span>, units <span class='op'>=</span> <span class='st'>"degrees"</span><span class='op'>)</span>,
                                          rho <span class='op'>=</span> <span class='fl'>0.9</span>,
                                          sd <span class='op'>=</span> <span class='fl'>0.1</span>,
                                          control.circular <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>units <span class='op'>=</span> <span class='st'>"degrees"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>angle_out</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Check function</span>
<span class='fu'>sim_angles_wrn_with_lag</span><span class='op'>(</span><span class='cn'>NULL</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; ... ... method (1) activated...</div><div class='output co'>#&gt; [1] 0</div><div class='input'><span class='fu'>sim_angles_wrn_with_lag</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 341.3967</div><div class='input'><span class='co'># Implement algorithm</span>
<span class='va'>path</span> <span class='op'>&lt;-</span> <span class='fu'>sim_path_sa</span><span class='op'>(</span>sim_angle <span class='op'>=</span> <span class='va'>sim_angles_wrn_with_lag</span>, lag <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::sim_path_sa() called (@ 2021-12-02 12:00:42)... 
#&gt; ... Setting up simulation... 
#&gt; ... Simulating movement path... 
#&gt;   |                                                                              |                                                                      |   0%
#&gt; ... ... method (1) activated...
#&gt;   |                                                                              |========                                                              |  11%
#&gt; ... ... method (1) activated...
#&gt;   |                                                                              |================                                                      |  22%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================                                       |  44%  |                                                                              |=======================================                               |  56%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================                |  78%  |                                                                              |==============================================================        |  89%  |                                                                              |======================================================================| 100%... Plotting simulated path... </div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: 'NA'.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: zero-length arrow is of indeterminate angle and so skipped</span></div><div class='img'><img src='sim_path_sa-9.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; ... flapper::sim_path_sa() call completed (@ 2021-12-02 12:00:42) after ~0 minutes. </div><div class='input'><span class='va'>path</span> <span class='op'>&lt;-</span> <span class='fu'>sim_path_sa</span><span class='op'>(</span>sim_angle <span class='op'>=</span> <span class='va'>sim_angles_wrn_with_lag</span>, lag <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::sim_path_sa() called (@ 2021-12-02 12:00:42)... 
#&gt; ... Setting up simulation... 
#&gt; ... Simulating movement path... 
#&gt;   |                                                                              |                                                                      |   0%
#&gt; ... ... method (1) activated...
#&gt;   |                                                                              |=========                                                             |  12%
#&gt; ... ... method (1) activated...
#&gt;   |                                                                              |==================                                                    |  25%
#&gt; ... ... method (1) activated...
#&gt;   |                                                                              |==========================                                            |  38%  |                                                                              |===================================                                   |  50%  |                                                                              |============================================                          |  62%  |                                                                              |====================================================                  |  75%  |                                                                              |=============================================================         |  88%  |                                                                              |======================================================================| 100%... Plotting simulated path... </div><div class='output co'>#&gt; <span class='message'>prettyGraphics::pretty_map() CRS taken as: 'NA'.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: zero-length arrow is of indeterminate angle and so skipped</span></div><div class='output co'>#&gt; <span class='warning'>Warning: zero-length arrow is of indeterminate angle and so skipped</span></div><div class='img'><img src='sim_path_sa-10.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; ... flapper::sim_path_sa() call completed (@ 2021-12-02 12:00:42) after ~0 minutes. </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


