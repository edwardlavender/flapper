<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Query the Open Topo Data API for elevation data — query_open_topo • flapper</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Query the Open Topo Data API for elevation data — query_open_topo" />
<meta property="og:description" content="This function queries the Open Topo Data elevation Application Programming Interface (API) to extract elevation data for inputted coordinates, rasters, or areas." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/flapper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/edwardlavender/flapper/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Query the Open Topo Data API for elevation data</h1>
    <small class="dont-index">Source: <a href='https://github.com/edwardlavender/flapper/blob/master/R/queries.R'><code>R/queries.R</code></a></small>
    <div class="hidden name"><code>query_open_topo.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function queries the Open Topo Data elevation Application Programming Interface (API) to extract elevation data for inputted coordinates, rasters, or areas.</p>
    </div>

    <pre class="usage"><span class='fu'>query_open_topo</span><span class='op'>(</span>
  <span class='va'>x</span>,
  db <span class='op'>=</span> <span class='st'>"gebco2020"</span>,
  interpolation <span class='op'>=</span> <span class='st'>"bilinear"</span>,
  encoding <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A two-column matrix of coordinates (x, y), an <code><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></code> object or a <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> that defines the coordinates/area for which elevation data are desired. If a matrix is supplied, a query is sent for all pairs of coordinates in this matrix. If an <code><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></code> object is provided, a query is sent for all cells spanning this area, depending on the specified dimensions (see <code>...</code>). If a <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> is supplied, a query is only sent for non NA cells, which can be more efficient (since areas for which data are not required can be masked prior to function implementation). The coordinate reference system must be latitude/longitude.</p></td>
    </tr>
    <tr>
      <th>db</th>
      <td><p>A character string that defines the database to be queried. Any option supported by Open Topo Data can be inputted, including ASTER (<code>"aster30m"</code>), ETOPO1 (<code>"etopo1"</code>), EU-DEM (<code>"eudem25m"</code>), Mapzen (<code>"mapzen"</code>), NED (<code>"ned10m"</code>), NZ DEM (<code>"nzdem8m"</code>), SRTM (<code>"srtm90m"</code>), EMOD bathymetry (<code>"emod2018"</code>) and GEBCO bathymetry (<code>"gebco2020"</code>) (see https://www.opentopodata.org for further details).</p></td>
    </tr>
    <tr>
      <th>interpolation</th>
      <td><p>A character (<code>"nearest"</code>, <code>"bilinear"</code> or <code>"cubic"</code>) that defines the interpolation method that is used to interpolate elevation values to inputted <code>x</code> locations.</p></td>
    </tr>
    <tr>
      <th>encoding</th>
      <td><p>(optional) The character encoding (e.g., <code>UTF-8</code>).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical variable that defines whether or not to print messages to the console to relay function progress.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> if <code>x</code> is an <code><a href='https://rdrr.io/pkg/raster/man/Extent-class.html'>Extent</a></code> object, such as the <code>resolution</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns elevation (`z') values from the specified database as a matrix, if code <code>x</code> is a matrix, or a <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code>, if code <code>x</code> is a <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> or an <code><a href='https://rdrr.io/pkg/raster/man/Extent-class.html'>Extent</a></code> object. Coordinates/areas without data are returned as NAs.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Open Topo Data is an elevation API. Further information, including on supported datasets, supported numbers of locations (which, at the time of writing, is limited to 100) and other details are provided here: https://www.opentopodata.org/. This function requires the <code><a href='https://httr.r-lib.org/reference/httr-package.html'>httr</a></code> and <code><a href='https://rdrr.io/pkg/jsonlite/man/fromJSON.html'>jsonlite</a></code> packages to query databases.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Open Topo Data (https://www.opentopodata.org/).</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Edward Lavender</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>#### Set up example spatial data with lat/long projection</span>
<span class='va'>proj_wgs84</span> <span class='op'>&lt;-</span> <span class='fu'>sp</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/CRS-class.html'>CRS</a></span><span class='op'>(</span>SRS_string <span class='op'>=</span> <span class='st'>"EPSG:4326"</span><span class='op'>)</span>
<span class='va'>dat_gebco_wgs84</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/projectRaster.html'>projectRaster</a></span><span class='op'>(</span><span class='va'>dat_gebco</span>, crs <span class='op'>=</span> <span class='va'>proj_wgs84</span><span class='op'>)</span>
<span class='va'>dat_coast_wgs84</span> <span class='op'>&lt;-</span> <span class='fu'>sp</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/spTransform.html'>spTransform</a></span><span class='op'>(</span><span class='va'>dat_coast</span>, <span class='va'>proj_wgs84</span><span class='op'>)</span>

<span class='co'>#### Example (1): Queries with a single set of coordinates</span>
<span class='co'># Define coordinates</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>dat_gebco_wgs84</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>5.616532</span>, <span class='fl'>56.50279</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='co'># Plot area</span>
<span class='fu'>prettyGraphics</span><span class='fu'>::</span><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html'>pretty_map</a></span><span class='op'>(</span>add_rasters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dat_gebco_wgs84</span><span class='op'>)</span>,
                           add_polys <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dat_coast_wgs84</span><span class='op'>)</span>,
                           add_points <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span>,
                           verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='co'># Check depth in area using available data</span>
<span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extract.html'>extract</a></span><span class='op'>(</span><span class='va'>dat_gebco_wgs84</span>, <span class='va'>x</span><span class='op'>)</span>
<span class='co'># Query database</span>
<span class='fu'>query_open_topo</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, db <span class='op'>=</span> <span class='st'>"gebco2020"</span><span class='op'>)</span>

<span class='co'>#### Example (2): Use alternative options</span>
<span class='co'># Alternative databases, such as EMOD bathymetry</span>
<span class='fu'>query_open_topo</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, db <span class='op'>=</span> <span class='st'>"emod2018"</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='co'># Set interpolation</span>
<span class='fu'>query_open_topo</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, db <span class='op'>=</span> <span class='st'>"emod2018"</span>,
                interpolation <span class='op'>=</span> <span class='st'>"cubic"</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'>#### Example (2): Queries with multiple coordinates</span>
<span class='co'># Define a random sample of coordinates</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/xyFromCell.html'>coordinates</a></span><span class='op'>(</span><span class='va'>dat_gebco_wgs84</span><span class='op'>)</span>
<span class='va'>index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/ncell.html'>nrow</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, <span class='fl'>25</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>index</span>, <span class='op'>]</span>
<span class='co'># Query database</span>
<span class='va'>depth</span> <span class='op'>&lt;-</span> <span class='fu'>query_open_topo</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, db <span class='op'>=</span> <span class='st'>"gebco2020"</span><span class='op'>)</span>
<span class='co'># Compare to manually extracted values</span>
<span class='co'># ... (some of these are NA because dat_gebco has been masked over land)</span>
<span class='va'>depth</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>depth</span>, <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extract.html'>extract</a></span><span class='op'>(</span><span class='va'>dat_gebco_wgs84</span>, <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#### Example (3): Queries using an Extent object</span>
<span class='co'># Note that only 100 locations can be queried at a time</span>
<span class='co'># ... hence the restrictions on the resolution specified here.</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></span><span class='op'>(</span><span class='va'>dat_coast_wgs84</span><span class='op'>)</span>
<span class='va'>depth</span> <span class='op'>&lt;-</span> <span class='fu'>query_open_topo</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, nrows <span class='op'>=</span> <span class='fl'>10</span>, ncols <span class='op'>=</span> <span class='fl'>10</span>, db <span class='op'>=</span> <span class='st'>"gebco2020"</span><span class='op'>)</span>
<span class='fu'>prettyGraphics</span><span class='fu'>::</span><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html'>pretty_map</a></span><span class='op'>(</span>add_rasters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>depth</span><span class='op'>)</span>,
                           add_polys <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dat_coast_wgs84</span><span class='op'>)</span>,
                           verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'>#### Example (4): Queries from a masked raster</span>
<span class='co'># Focus on a small area</span>
<span class='va'>ext</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>5.709508</span>, <span class='op'>-</span><span class='fl'>5.648977</span>, <span class='fl'>56.48656</span>, <span class='fl'>56.50267</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/crop.html'>crop</a></span><span class='op'>(</span><span class='va'>dat_gebco_wgs84</span>, <span class='va'>ext</span><span class='op'>)</span>
<span class='fu'>prettyGraphics</span><span class='fu'>::</span><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html'>pretty_map</a></span><span class='op'>(</span>add_rasters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span>,
                           add_polys <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dat_coast_wgs84</span><span class='op'>)</span>,
                           verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='co'># Query database</span>
<span class='va'>depth</span> <span class='op'>&lt;-</span> <span class='fu'>query_open_topo</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, db <span class='op'>=</span> <span class='st'>"gebco2020"</span><span class='op'>)</span>
<span class='fu'>prettyGraphics</span><span class='fu'>::</span><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_map.html'>pretty_map</a></span><span class='op'>(</span>add_rasters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>depth</span><span class='op'>)</span>,
                           add_polys <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dat_coast_wgs84</span><span class='op'>)</span>,
                           verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


