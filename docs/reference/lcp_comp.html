<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compare Euclidean and shortest distances — lcp_comp • flapper</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compare Euclidean and shortest distances — lcp_comp"><meta property="og:description" content="This function compares Euclidean distances to shortest distances for randomly sampled pairs of points across a raster."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/flapper_algorithms_faqs.html">`flapper`: practitioner FAQs</a>
    </li>
    <li>
      <a href="../articles/flapper_overview.html">`flapper`: an overview</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edwardlavender/flapper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compare Euclidean and shortest distances</h1>
    <small class="dont-index">Source: <a href="https://github.com/edwardlavender/flapper/blob/HEAD/R/lcps.R" class="external-link"><code>R/lcps.R</code></a></small>
    <div class="hidden name"><code>lcp_comp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function compares Euclidean distances to shortest distances for randomly sampled pairs of points across a <code><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lcp_comp</span><span class="op">(</span></span>
<span>  <span class="va">surface</span>,</span>
<span>  barrier <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  interval <span class="op">=</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">res</a></span><span class="op">(</span><span class="va">surface</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  mobility <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  n_max <span class="op">=</span> <span class="va">n</span>,</span>
<span>  graph <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  varlist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>surface</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></code> from which to sample locations and calculate distances. The <code>surface</code> must be planar with units of metres in x, y and z directions. The <code>resolution</code>  must be the same in both x and y directions (see <code><a href="lcp_over_surface.html">lcp_over_surface</a></code>). If applicable, the <code>surface</code> should be masked by <code>barrier</code> (see <code><a href="mask_io.html">mask_io</a></code>) prior to implementation of this function.</p></dd>


<dt>barrier</dt>
<dd><p>(optional) A simple features geometry that defines a barrier (see <code><a href="segments_cross_barrier.html">segments_cross_barrier</a></code>). If supplied, the function determines whether or not each sampled pair of coordinates crosses the barrier.</p></dd>


<dt>distance</dt>
<dd><p>A numeric vector of distances. If supplied, for each distance, <code>n</code> location pairs that are that approximately that distance apart (see <code>interval</code>) are sampled and, for each pair, Euclidean and shortest distances are calculated. If supplied, <code>mobility</code> should not be supplied (see below).</p></dd>


<dt>interval</dt>
<dd><p>If <code>distance</code> is supplied, <code>interval</code> is a number that defines the range of distances around each distance that are admissible. For example, if <code>distance = 50</code> (m) and <code>interval = 5</code>, <code>n</code> location pairs that are within 45--55 m of each other are sampled.</p></dd>


<dt>mobility</dt>
<dd><p>(optional) A number that defines the maximum distance between sampled locations. If supplied, <code>n</code> locations are sampled; the Euclidean distances between all combinations of locations are calculated; and for the location pairs for which the Euclidean distance is less than <code>mobility</code> (up to a maximum of <code>n_max</code> pairs), shortest distances are calculated. This method is potentially fast the <code>distance</code>-vector-based method that is implemented is <code>distance</code> is supplied, but the final number of locations cannot be predetermined. If supplied, <code>distance</code> should not be supplied (see above).</p></dd>


<dt>n</dt>
<dd><p>An integer that defines (a) the number of location pairs for each <code>distance</code> or (b) the initial number of sampled locations if <code>mobility</code> is supplied.</p></dd>


<dt>n_max</dt>
<dd><p>If <code>mobility</code> is supplied, <code>n_max</code> is an integer that defines the maximum number of location pairs for which shortest distances are calculated.</p></dd>


<dt>graph</dt>
<dd><p>(optional) A graph object that defines cell nodes and edge costs for connected cells within the surface (see <code><a href="lcp_graph_surface.html">lcp_graph_surface</a></code>). This is used for shortest-distance calculations.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to <code><a href="https://rdrr.io/pkg/cppRouting/man/get_distance_pair.html" class="external-link">get_distance_pair</a></code> for shortest-distance calculations (<code>algorithm</code>, <code>constant</code> and/or <code>allcores</code>).</p></dd>


<dt>cl, varlist</dt>
<dd><p>(optional) Parallelisation options for distance-based location sampling (i.e., if <code>distance != NULL</code>). <code>cl</code> is (a) a cluster object from <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></code> or (b) an integer that defines the number of child processes. <code>varlist</code> is a character vector of variables for export (see <code><a href="cl.html">cl_export</a></code>). Exported variables must be located in the global environment. If a cluster is supplied, the connection to the cluster is closed within the function (see <code><a href="cl.html">cl_stop</a></code>). For further information, see <code><a href="cl.html">cl_lapply</a></code> and <code><a href="flapper-tips-parallel.html">flapper-tips-parallel</a></code>.</p></dd>


<dt>verbose</dt>
<dd><p>A logical input that defines whether or not to print messages to the console to monitor function progress.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function returns a dataframe with sampled location pairs and the Euclidean and shortest distances between them. This contains the following columns:</p><ul><li><p>index -- A number that defines the row.</p></li>
<li><p>id -- If <code>distance</code> is specified, <code>id</code> is number that defines the sample (from <code>1:n</code> for each <code>distance</code>).</p></li>
<li><p>cell_x0, cell_y0, cell_x1, cell_y1 -- Numbers that define the coordinates of sampled locations.</p></li>
<li><p>cell_id0, cell_id1 -- Integers that define the cell IDs for sampled locations.</p></li>
<li><p>dist_sim -- If <code>distance</code> is specified, <code>dist_sim</code> is a number that defines the specified distance.</p></li>
<li><p>dist_euclid -- A number that defines the Euclidean distance from <code>(cell_x0, cell_y0)</code> to <code>(cell_x1, cell_y1)</code>.</p></li>
<li><p>dist_lcp -- A number that defines the shortest distance from <code>(cell_x0, cell_y0)</code> to <code>(cell_x1, cell_y1)</code>.</p></li>
<li><p>barrier -- If applicable, <code>barrier</code> is factor that defines whether (<code>"1"</code>) or not (<code>"0"</code>) the Euclidean line connecting <code>(cell_x0, cell_y0)</code> and <code>(cell_x1, cell_y1)</code> crosses the <code>barrier</code>.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function was motivated by the need to determine the extent to which Euclidean distances are a suitable approximation of shortest distances in movement models for benthic animals.</p>
<p>To address this issue, this function samples multiple pairs of points on a <code><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></code> (<code>surface</code>) and compares the Euclidean and shortest distances between sampled locations.</p>
<p>Two sampling methods are implemented. The first method (implemented if <code>distance</code> is supplied), samples <code>n</code> pairs of points for each distance that are approximately that distance apart. (Sampling across a grid is approximate because grid resolution is finite. The approximation is controlled by the <code>interval</code> parameter.) The advantage of this method is that the number of sampled location pairs for which Euclidean and shortest distances are compared is predetermined (by <code>n</code>), but the method can be slow if <code>n</code> is large. The second method (implemented if <code>mobility</code> is supplied), simply samples <code>n</code> locations and calculates the Euclidean distances between all combinations of sampled locations. Any location pairs that are more than <code>mobility</code> apart are then dropped and for the remaining location pairs (up to a maximum of <code>n_max</code> randomly sampled pairs) shortest distances are calculated. A potential advantage of this method is speed, but the number of location pairs below <code>mobility</code> for which Euclidean and shortest distances can be compared is not predetermined.</p>
<p>Regardless of sampling method, the expectation for the analysis is that at short Euclidean distances, Euclidean distances are likely to approximate shortest distances well (unless there is a barrier, such as the coastline, in the way). At longer Euclidean distances, shortest distances are likely to become much longer than Euclidean distances. For some movement frameworks, especially the particle filtering (<code><a href="pf.html">pf</a></code>) and processing (<code><a href="pf_simplify.html">pf_simplify</a></code>) routines in <code><a href="flapper.html">flapper</a></code>, the Euclidean distance at which the shortest distances start to exceed the distance that an animal could move (over some time interval of interest) is an important parameter (termed <code>calc_distance_limit</code> in <code><a href="pf_simplify.html">pf_simplify</a></code>). For sampled locations that are a Euclidean distance less than this threshold apart, it is reasonable to assume that there exists a `valid' shortest path over the <code>surface</code>, given the animal's mobility, without having to calculate that path; for sampled locations that are a Euclidean distance more than this threshold apart, this assumption is not valid. For areas with a clear-cut threshold, for Euclidean-based sampling frameworks (see <code><a href="pf.html">pf</a></code>), it may be reasonable to reduce the animal's mobility to the threshold value to account for this difference; in other cases, it may be necessary to compute shortest distances for potentially problematic locations. Either way, an understanding of the extent to which Euclidean distances effectively approximate shortest distances at spatial scales relevant to an animal can help to minimise the number of shortest-distance calculations that are required within a movement modelling framework (which are much more computationally demanding than Euclidean-based calculations).</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edward Lavender</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#### Load packages</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://edwardlavender.github.io/prettyGraphics/" class="external-link">prettyGraphics</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: prettyGraphics</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘prettyGraphics’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:flapper’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     dat_gebco</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Define surface for examples</span></span></span>
<span class="r-in"><span><span class="co"># We will focus on a relatively small area for speed</span></span></span>
<span class="r-in"><span><span class="co"># The raster resolution should be equal in x and y directions</span></span></span>
<span class="r-in"><span><span class="va">bathy</span> <span class="op">&lt;-</span> <span class="fu">flapper</span><span class="fu">::</span><span class="va"><a href="dat_gebco.html">dat_gebco</a></span></span></span>
<span class="r-in"><span><span class="va">boundaries</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="fl">700652.2</span>, <span class="fl">708401.2</span>, <span class="fl">6262905</span>, <span class="fl">6270179</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">blank</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">boundaries</span>, res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bathy</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/resample.html" class="external-link">resample</a></span><span class="op">(</span><span class="va">bathy</span>, <span class="va">blank</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bathy</span> <span class="op">&lt;-</span> <span class="fu"><a href="mask_io.html">mask_io</a></span><span class="op">(</span><span class="va">bathy</span>, <span class="fu">flapper</span><span class="fu">::</span><span class="va"><a href="dat_coast.html">dat_coast</a></span>, mask_inside <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>GEOS support is provided by the sf and terra packages among others</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>spgeom1 and spgeom2 have different proj4 strings</span>
<span class="r-in"><span><span class="co"># raster::plot(bathy)</span></span></span>
<span class="r-in"><span><span class="co"># raster::lines(dat_coast)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Define barrier to movement</span></span></span>
<span class="r-in"><span><span class="va">coastline</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">dat_coast</span>, <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="va">bathy</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coastline</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">coastline</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Define graph for shortest-distance calculations</span></span></span>
<span class="r-in"><span><span class="va">bathy_costs</span> <span class="op">&lt;-</span> <span class="fu"><a href="lcp_costs.html">lcp_costs</a></span><span class="op">(</span><span class="va">bathy</span><span class="op">)</span> <span class="co"># ~0.38 mins</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::lcp_costs() called (@ 2023-08-29 15:42:40)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining transition matrices... </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>transition function gives negative values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Calculating distance matrices... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Assembling LCP costs... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::lcp_costs() call completed (@ 2023-08-29 15:42:59) after ~0.31 minutes. </span>
<span class="r-in"><span><span class="va">bathy_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="lcp_graph_surface.html">lcp_graph_surface</a></span><span class="op">(</span><span class="va">bathy</span>, <span class="va">bathy_costs</span><span class="op">$</span><span class="va">dist_total</span><span class="op">)</span> <span class="co"># ~0.26 mins</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::lcp_graph_surface() called (@ 2023-08-29 15:42:59)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining nodes, edges and costs to make graph... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Constructing graph object... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::lcp_graph_surface() call completed (@ 2023-08-29 15:43:08) after ~0.16 minutes. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (1): Distance-vector-based implementation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Implement function</span></span></span>
<span class="r-in"><span><span class="va">out_1</span> <span class="op">&lt;-</span> <span class="fu">lcp_comp</span><span class="op">(</span></span></span>
<span class="r-in"><span>  surface <span class="op">=</span> <span class="va">bathy</span>,</span></span>
<span class="r-in"><span>  distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  graph <span class="op">=</span> <span class="va">bathy_graph</span>,</span></span>
<span class="r-in"><span>  barrier <span class="op">=</span> <span class="va">coastline</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::lcp_comp() called (@ 2023-08-29 15:43:08)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining parameters... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Sampling n location pairs for each distance value... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Sampling for distance = 50... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Sampling starting locations... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Sampling ending locations... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Sampling for distance = 100... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Sampling starting locations... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Sampling ending locations... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Processing samples... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Determining barrier overlaps... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Implementing shortest-distance calculations... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Calculating shortest-distances via cppRouting::get_distance_pair() for 20 location pair(s) ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Cleaning results... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::lcp_comp() call completed (@ 2023-08-29 15:43:16) after ~0.13 minutes. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Examine outputs</span></span></span>
<span class="r-in"><span><span class="co"># The function returns a dataframe</span></span></span>
<span class="r-in"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">out_1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	20 obs. of  12 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ index      : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ id         : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ cell_x0    : num  701520 701955 705210 707355 703900 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ cell_y0    : num  6265956 6267946 6265682 6266712 6263782 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ cell_x1    : num  701475 701965 705210 707340 703945 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ cell_y1    : num  6265926 6267996 6265632 6266666 6263762 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ cell_id0   : num  1308374 691561 1394362 1075491 1983100 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ cell_id1   : num  1317665 676063 1409862 1089438 1989309 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dist_sim   : num  50 50 50 50 50 50 50 50 50 50 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dist_euclid: num  54.1 51 50 47.4 49.2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dist_lcp   : num  57.4 54.2 50 51.2 53.3 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ barrier    : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Visualise sampled locations on map</span></span></span>
<span class="r-in"><span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bathy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">raster</span><span class="fu">::</span><span class="fu">lines</span><span class="op">(</span><span class="va">dat_coast</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">out_1</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x0 <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">cell_x0</span>, y0 <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">cell_y0</span>,</span></span>
<span class="r-in"><span>    x1 <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">cell_x1</span>, y1 <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">cell_y1</span>, length <span class="op">=</span> <span class="fl">0.01</span>, lwd <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lcp_comp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Compare simulated, Euclidean and shortest distances</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html" class="external-link">pretty_plot</a></span><span class="op">(</span><span class="va">out_1</span><span class="op">$</span><span class="va">dist_sim</span>, <span class="va">out_1</span><span class="op">$</span><span class="va">dist_euclid</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Distance (simulated) [m]"</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">"Distance (Euclidean)[m]"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html" class="external-link">pretty_plot</a></span><span class="op">(</span><span class="va">out_1</span><span class="op">$</span><span class="va">dist_euclid</span>, <span class="va">out_1</span><span class="op">$</span><span class="va">dist_lcp</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Distance (Euclidean) [m]"</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">"Distance (shortest) [m]"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lcp_comp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (2): Distance-vector-based implementation in parallel</span></span></span>
<span class="r-in"><span><span class="va">out_2</span> <span class="op">&lt;-</span> <span class="fu">lcp_comp</span><span class="op">(</span></span></span>
<span class="r-in"><span>  surface <span class="op">=</span> <span class="va">bathy</span>,</span></span>
<span class="r-in"><span>  distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  graph <span class="op">=</span> <span class="va">bathy_graph</span>,</span></span>
<span class="r-in"><span>  barrier <span class="op">=</span> <span class="va">coastline</span>,</span></span>
<span class="r-in"><span>  cl <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::lcp_comp() called (@ 2023-08-29 15:43:16)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining parameters... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Sampling n location pairs for each distance value... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Processing samples... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Determining barrier overlaps... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Implementing shortest-distance calculations... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Calculating shortest-distances via cppRouting::get_distance_pair() for 20 location pair(s) ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Cleaning results... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::lcp_comp() call completed (@ 2023-08-29 15:43:27) after ~0.18 minutes. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (3): Mobility-based implementation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Implement function for mobility = 500</span></span></span>
<span class="r-in"><span><span class="va">mob</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="va">out_3</span> <span class="op">&lt;-</span> <span class="fu">lcp_comp</span><span class="op">(</span></span></span>
<span class="r-in"><span>  surface <span class="op">=</span> <span class="va">bathy</span>,</span></span>
<span class="r-in"><span>  mobility <span class="op">=</span> <span class="va">mob</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>  graph <span class="op">=</span> <span class="va">bathy_graph</span>,</span></span>
<span class="r-in"><span>  barrier <span class="op">=</span> <span class="va">coastline</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::lcp_comp() called (@ 2023-08-29 15:43:27)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining parameters... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Sampling n locations... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Calculating Euclidean distances between sampled locations... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Filtering by mobility... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Processing samples... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Determining barrier overlaps... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Implementing shortest-distance calculations... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Calculating shortest-distances via cppRouting::get_distance_pair() for 1000 location pair(s) ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Cleaning results... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::lcp_comp() call completed (@ 2023-08-29 15:43:29) after ~0.03 minutes. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Visualise sampled locations on map</span></span></span>
<span class="r-in"><span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bathy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">raster</span><span class="fu">::</span><span class="fu">lines</span><span class="op">(</span><span class="va">dat_coast</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">out_3</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x0 <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">cell_x0</span>, y0 <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">cell_y0</span>,</span></span>
<span class="r-in"><span>    x1 <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">cell_x1</span>, y1 <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">cell_y1</span>, length <span class="op">=</span> <span class="fl">0.01</span>, lwd <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lcp_comp-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Compare Euclidean and shortest distances</span></span></span>
<span class="r-in"><span><span class="co"># Extract the data for the paths that do not versus do cross a barrier</span></span></span>
<span class="r-in"><span><span class="va">out_3_barrier0</span> <span class="op">&lt;-</span> <span class="va">out_3</span><span class="op">[</span><span class="va">out_3</span><span class="op">$</span><span class="va">barrier</span> <span class="op">==</span> <span class="fl">0</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">out_3_barrier1</span> <span class="op">&lt;-</span> <span class="va">out_3</span><span class="op">[</span><span class="va">out_3</span><span class="op">$</span><span class="va">barrier</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># Set up plotting window</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Results for paths that do not cross a barrier</span></span></span>
<span class="r-in"><span><span class="co"># ... Visualisation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html" class="external-link">pretty_plot</a></span><span class="op">(</span><span class="va">out_3_barrier0</span><span class="op">$</span><span class="va">dist_euclid</span>, <span class="va">out_3_barrier0</span><span class="op">$</span><span class="va">dist_lcp</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Distance (Euclidean) [m]"</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">"Distance (shortest) [m]"</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="st">"."</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">mob</span>, col <span class="op">=</span> <span class="st">"royalblue"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># ... Euclidean distance parameter at which mobility is exceeded</span></span></span>
<span class="r-in"><span><span class="va">limit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">out_3_barrier0</span><span class="op">$</span><span class="va">dist_euclid</span><span class="op">[</span><span class="va">out_3_barrier0</span><span class="op">$</span><span class="va">dist_lcp</span> <span class="op">&gt;</span> <span class="va">mob</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">limit0</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 464.8656</span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">limit0</span>, col <span class="op">=</span> <span class="st">"royalblue"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Results for paths that cross a barrier</span></span></span>
<span class="r-in"><span><span class="co"># ... Visualisation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html" class="external-link">pretty_plot</a></span><span class="op">(</span><span class="va">out_3_barrier1</span><span class="op">$</span><span class="va">dist_euclid</span>, <span class="va">out_3_barrier1</span><span class="op">$</span><span class="va">dist_lcp</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Distance (Euclidean) [m]"</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">"Distance (shortest) [m]"</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="st">"."</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">mob</span>, col <span class="op">=</span> <span class="st">"royalblue"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># ... Euclidean distance parameter at which mobility is exceeded</span></span></span>
<span class="r-in"><span><span class="va">limit1</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">out_3_barrier1</span><span class="op">$</span><span class="va">dist_euclid</span><span class="op">[</span><span class="va">out_3_barrier1</span><span class="op">$</span><span class="va">dist_lcp</span> <span class="op">&gt;</span> <span class="va">mob</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">limit1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 466.1545</span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">limit1</span>, col <span class="op">=</span> <span class="st">"royalblue"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lcp_comp-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the difference between Euclidean and shortest distances with distance</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html" class="external-link">pretty_plot</a></span><span class="op">(</span><span class="va">out_3_barrier0</span><span class="op">$</span><span class="va">dist_euclid</span>,</span></span>
<span class="r-in"><span>  <span class="va">out_3_barrier0</span><span class="op">$</span><span class="va">dist_lcp</span> <span class="op">-</span> <span class="va">out_3_barrier0</span><span class="op">$</span><span class="va">dist_euclid</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Distance (Euclidean) [m]"</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">"Distance (shortest - Euclidean) [m]"</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="st">"."</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html" class="external-link">pretty_plot</a></span><span class="op">(</span><span class="va">out_3_barrier1</span><span class="op">$</span><span class="va">dist_euclid</span>,</span></span>
<span class="r-in"><span>  <span class="va">out_3_barrier1</span><span class="op">$</span><span class="va">dist_lcp</span> <span class="op">-</span> <span class="va">out_3_barrier1</span><span class="op">$</span><span class="va">dist_euclid</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Distance (Euclidean) [m]"</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">"Distance (shortest - Euclidean) [m]"</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="st">"."</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lcp_comp-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Approximate shortest distances using a model based on Euclidean distances</span></span></span>
<span class="r-in"><span><span class="co"># Fit model</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">dist_lcp</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">dist_euclid</span><span class="op">:</span><span class="va">barrier</span>, data <span class="op">=</span> <span class="va">out_3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Examine model predictions</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>barrier <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">0</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, dist_euclid <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/list_CIs.html" class="external-link">list_CIs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">nd</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html" class="external-link">pretty_plot</a></span><span class="op">(</span><span class="va">out_3</span><span class="op">$</span><span class="va">dist_euclid</span>, <span class="va">out_3</span><span class="op">$</span><span class="va">dist_lcp</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey"</span>, <span class="st">"darkred"</span><span class="op">)</span><span class="op">[</span><span class="va">out_3</span><span class="op">$</span><span class="va">barrier</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">[</span><span class="va">out_3</span><span class="op">$</span><span class="va">barrier</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/add_error_envelope.html" class="external-link">add_error_envelope</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">ci</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nd</span><span class="op">$</span><span class="va">barrier</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/list_CIs.html" class="external-link">list_CIs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">nd</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edwardlavender.github.io/prettyGraphics/reference/add_error_envelope.html" class="external-link">add_error_envelope</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">ci</span>,</span></span>
<span class="r-in"><span>  add_fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  add_ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    border <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lcp_comp-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Define predictive model based on this analysis</span></span></span>
<span class="r-in"><span><span class="va">lcp_predict</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">m</span>, <span class="va">barrier</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2L</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">barrier</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">m</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">x</span> <span class="op">*</span> <span class="op">(</span><span class="va">barrier</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="va">m</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">x</span> <span class="op">*</span> <span class="op">(</span><span class="va">barrier</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

