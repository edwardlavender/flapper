<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compare Euclidean and shortest distances — lcp_comp • flapper</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compare Euclidean and shortest distances — lcp_comp" />
<meta property="og:description" content="This function compares Euclidean distances to shortest distances for randomly sampled pairs of points across a raster." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/flapper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/edwardlavender/flapper/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compare Euclidean and shortest distances</h1>
    <small class="dont-index">Source: <a href='https://github.com/edwardlavender/flapper/blob/master/R/lcps.R'><code>R/lcps.R</code></a></small>
    <div class="hidden name"><code>lcp_comp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function compares Euclidean distances to shortest distances for randomly sampled pairs of points across a <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>lcp_comp</span><span class='op'>(</span>
  <span class='va'>surface</span>,
  barrier <span class='op'>=</span> <span class='cn'>NULL</span>,
  distance <span class='op'>=</span> <span class='cn'>NULL</span>,
  interval <span class='op'>=</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/resolution.html'>res</a></span><span class='op'>(</span><span class='va'>surface</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  mobility <span class='op'>=</span> <span class='cn'>NULL</span>,
  n <span class='op'>=</span> <span class='fl'>10L</span>,
  n_max <span class='op'>=</span> <span class='va'>n</span>,
  graph <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>,
  cl <span class='op'>=</span> <span class='cn'>NULL</span>,
  varlist <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>surface</th>
      <td><p>A <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> from which to sample locations and calculate distances. The <code>surface</code> must be planar with units of metres in x, y and z directions. The <code>resolution</code>  must be the same in both x and y directions (see <code><a href='lcp_over_surface.html'>lcp_over_surface</a></code>). If applicable, the <code>surface</code> should be masked by <code>barrier</code> (see <code><a href='mask_io.html'>mask_io</a></code>) prior to implementation of this function.</p></td>
    </tr>
    <tr>
      <th>barrier</th>
      <td><p>(optional) A simple features geometry that defines a barrier (see <code><a href='segments_cross_barrier.html'>segments_cross_barrier</a></code>). If supplied, the function determines whether or not each sampled pair of coordinates crosses the barrier.</p></td>
    </tr>
    <tr>
      <th>distance</th>
      <td><p>A numeric vector of distances. If supplied, for each distance, <code>n</code> location pairs that are that approximately that distance apart (see <code>interval</code>) are sampled and, for each pair, Euclidean and shortest distances are calculated. If supplied, <code>mobility</code> should not be supplied (see below).</p></td>
    </tr>
    <tr>
      <th>interval</th>
      <td><p>If <code>distance</code> is supplied, <code>interval</code> is a number that defines the range of distances around each distance that are admissible. For example, if <code>distance = 50</code> (m) and <code>interval = 5</code>, <code>n</code> location pairs that are within 45--55 m of each other are sampled.</p></td>
    </tr>
    <tr>
      <th>mobility</th>
      <td><p>(optional) A number that defines the maximum distance between sampled locations. If supplied, <code>n</code> locations are sampled; the Euclidean distances between all combinations of locations are calculated; and for the location pairs for which the Euclidean distance is less than <code>mobility</code> (up to a maximum of <code>n_max</code> pairs), shortest distances are calculated. This method is potentially fast the <code>distance</code>-vector-based method that is implemented is <code>distance</code> is supplied, but the final number of locations cannot be predetermined. If supplied, <code>distance</code> should not be supplied (see above).</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>An integer that defines (a) the number of location pairs for each <code>distance</code> or (b) the initial number of sampled locations if <code>mobility</code> is supplied.</p></td>
    </tr>
    <tr>
      <th>n_max</th>
      <td><p>If <code>mobility</code> is supplied, <code>n_max</code> is an integer that defines the maximum number of location pairs for which shortest distances are calculated.</p></td>
    </tr>
    <tr>
      <th>graph</th>
      <td><p>(optional) A graph object that defines cell nodes and edge costs for connected cells within the surface (see <code><a href='lcp_graph_surface.html'>lcp_graph_surface</a></code>). This is used for shortest-distance calculations.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code><a href='https://rdrr.io/pkg/cppRouting/man/get_distance_pair.html'>get_distance_pair</a></code> for shortest-distance calculations (<code>algorithm</code>, <code>constant</code> and/or <code>allcores</code>).</p></td>
    </tr>
    <tr>
      <th>cl, varlist</th>
      <td><p>(optional) Parallelisation options for distance-based location sampling (i.e., if <code>distance != NULL</code>). <code>cl</code> is (a) a cluster object from <code><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></code> or (b) an integer that defines the number of child processes. <code>varlist</code> is a character vector of variables for export (see <code><a href='cl.html'>cl_export</a></code>). Exported variables must be located in the global environment. If a cluster is supplied, the connection to the cluster is closed within the function (see <code><a href='cl.html'>cl_stop</a></code>). For further information, see <code><a href='cl.html'>cl_lapply</a></code> and <code><a href='flapper-tips-parallel.html'>flapper-tips-parallel</a></code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical input that defines whether or not to print messages to the console to monitor function progress.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns a dataframe with sampled location pairs and the Euclidean and shortest distances between them. This contains the following columns:</p><ul>
<li><p>index -- A number that defines the row.</p></li>
<li><p>id -- If <code>distance</code> is specified, <code>id</code> is number that defines the sample (from <code>1:n</code> for each <code>distance</code>).</p></li>
<li><p>cell_x0, cell_y0, cell_x1, cell_y1 -- Numbers that define the coordinates of sampled locations.</p></li>
<li><p>cell_id0, cell_id1 -- Integers that define the cell IDs for sampled locations.</p></li>
<li><p>dist_sim -- If <code>distance</code> is specified, <code>dist_sim</code> is a number that defines the specified distance.</p></li>
<li><p>dist_euclid -- A number that defines the Euclidean distance from <code>(cell_x0, cell_y0)</code> to <code>(cell_x1, cell_y1)</code>.</p></li>
<li><p>dist_lcp -- A number that defines the shortest distance from <code>(cell_x0, cell_y0)</code> to <code>(cell_x1, cell_y1)</code>.</p></li>
<li><p>barrier -- If applicable, <code>barrier</code> is factor that defines whether (<code>"1"</code>) or not (<code>"0"</code>) the Euclidean line connecting <code>(cell_x0, cell_y0)</code> and <code>(cell_x1, cell_y1)</code> crosses the <code>barrier</code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function was motivated by the need to determine the extent to which Euclidean distances are a suitable approximation of shortest distances in movement models for benthic animals.</p>
<p>To address this issue, this function samples multiple pairs of points on a <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> (<code>surface</code>) and compares the Euclidean and shortest distances between sampled locations.</p>
<p>Two sampling methods are implemented. The first method (implemented if <code>distance</code> is supplied), samples <code>n</code> pairs of points for each distance that are approximately that distance apart. (Sampling across a grid is approximate because grid resolution is finite. The approximation is controlled by the <code>interval</code> parameter.) The advantage of this method is that the number of sampled location pairs for which Euclidean and shortest distances are compared is predetermined (by <code>n</code>), but the method can be slow if <code>n</code> is large. The second method (implemented if <code>mobility</code> is supplied), simply samples <code>n</code> locations and calculates the Euclidean distances between all combinations of sampled locations. Any location pairs that are more than <code>mobility</code> apart are then dropped and for the remaining location pairs (up to a maximum of <code>n_max</code> randomly sampled pairs) shortest distances are calculated. A potential advantage of this method is speed, but the number of location pairs below <code>mobility</code> for which Euclidean and shortest distances can be compared is not predetermined.</p>
<p>Regardless of sampling method, the expectation for the analysis is that at short Euclidean distances, Euclidean distances are likely to approximate shortest distances well (unless there is a barrier, such as the coastline, in the way). At longer Euclidean distances, shortest distances are likely to become much longer than Euclidean distances. For some movement frameworks, especially the particle filtering (<code><a href='pf.html'>pf</a></code>) and processing (<code><a href='pf_simplify.html'>pf_simplify</a></code>) routines in <code><a href='flapper.html'>flapper</a></code>, the Euclidean distance at which the shortest distances start to exceed the distance that an animal could move (over some time interval of interest) is an important parameter (termed <code>calc_distance_limit</code> in <code><a href='pf_simplify.html'>pf_simplify</a></code>). For sampled locations that are a Euclidean distance less than this threshold apart, it is reasonable to assume that there exists a `valid' shortest path over the <code>surface</code>, given the animal's mobility, without having to calculate that path; for sampled locations that are a Euclidean distance more than this threshold apart, this assumption is not valid. For areas with a clear-cut threshold, for Euclidean-based sampling frameworks (see <code><a href='pf.html'>pf</a></code>), it may be reasonable to reduce the animal's mobility to the threshold value to account for this difference; in other cases, it may be necessary to compute shortest distances for potentially problematic locations. Either way, an understanding of the extent to which Euclidean distances effectively approximate shortest distances at spatial scales relevant to an animal can help to minimise the number of shortest-distance calculations that are required within a movement modelling framework (which are much more computationally demanding than Euclidean-based calculations).</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Edward Lavender</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#### Load packages</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://edwardlavender.github.io/prettyGraphics/'>prettyGraphics</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: prettyGraphics</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘prettyGraphics’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:flapper’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    dat_gebco</span></div><div class='input'>
<span class='co'>#### Define surface for examples</span>
<span class='co'># We will focus on a relatively small area for speed</span>
<span class='co'># The raster resolution should be equal in x and y directions</span>
<span class='va'>bathy</span>      <span class='op'>&lt;-</span> <span class='fu'>flapper</span><span class='fu'>::</span><span class='va'><a href='dat_gebco.html'>dat_gebco</a></span>
<span class='va'>boundaries</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></span><span class='op'>(</span><span class='fl'>700652.2</span>, <span class='fl'>708401.2</span>, <span class='fl'>6262905</span>, <span class='fl'>6270179</span><span class='op'>)</span>
<span class='va'>blank</span>      <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='va'>boundaries</span>, res <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>bathy</span>      <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/resample.html'>resample</a></span><span class='op'>(</span><span class='va'>bathy</span>, <span class='va'>blank</span><span class='op'>)</span>
<span class='va'>bathy</span>      <span class='op'>&lt;-</span> <span class='fu'><a href='mask_io.html'>mask_io</a></span><span class='op'>(</span><span class='va'>bathy</span>, <span class='fu'>flapper</span><span class='fu'>::</span><span class='va'><a href='dat_coast.html'>dat_coast</a></span>, mask_inside <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: spgeom1 and spgeom2 have different proj4 strings</span></div><div class='input'><span class='co'># raster::plot(bathy)</span>
<span class='co'># raster::lines(dat_coast)</span>

<span class='co'>#### Define barrier to movement</span>
<span class='va'>coastline</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/crop.html'>crop</a></span><span class='op'>(</span><span class='va'>dat_coast</span>, <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></span><span class='op'>(</span><span class='va'>bathy</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>coastline</span> <span class='op'>&lt;-</span> <span class='fu'>sf</span><span class='fu'>::</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_as_sf.html'>st_as_sf</a></span><span class='op'>(</span><span class='va'>coastline</span><span class='op'>)</span>

<span class='co'>#### Define graph for shortest-distance calculations</span>
<span class='va'>bathy_costs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='lcp_costs.html'>lcp_costs</a></span><span class='op'>(</span><span class='va'>bathy</span><span class='op'>)</span>                                 <span class='co'># ~0.38 mins</span>
</div><div class='output co'>#&gt; flapper::lcp_costs() called (@ 2022-05-28 18:11:52)... 
#&gt; ... Defining transition matrices... </div><div class='output co'>#&gt; <span class='warning'>Warning: transition function gives negative values</span></div><div class='output co'>#&gt; ... Calculating distance matrices... 
#&gt; ... Assembling LCP costs... 
#&gt; ... flapper::lcp_costs() call completed (@ 2022-05-28 18:12:20) after ~0.46 minutes. </div><div class='input'><span class='va'>bathy_graph</span> <span class='op'>&lt;-</span> <span class='fu'><a href='lcp_graph_surface.html'>lcp_graph_surface</a></span><span class='op'>(</span><span class='va'>bathy</span>, <span class='va'>bathy_costs</span><span class='op'>$</span><span class='va'>dist_total</span><span class='op'>)</span> <span class='co'># ~0.26 mins</span>
</div><div class='output co'>#&gt; flapper::lcp_graph_surface() called (@ 2022-05-28 18:12:20)... 
#&gt; ... Defining nodes, edges and costs to make graph... 
#&gt; ... Constructing graph object... 
#&gt; ... flapper::lcp_graph_surface() call completed (@ 2022-05-28 18:12:36) after ~0.27 minutes. </div><div class='input'>
<span class='co'>#### Example (1): Distance-vector-based implementation</span>

<span class='co'>## Implement function</span>
<span class='va'>out_1</span> <span class='op'>&lt;-</span> <span class='fu'>lcp_comp</span><span class='op'>(</span>surface <span class='op'>=</span> <span class='va'>bathy</span>,
                  distance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>100</span><span class='op'>)</span>,
                  graph <span class='op'>=</span> <span class='va'>bathy_graph</span>,
                  barrier <span class='op'>=</span> <span class='va'>coastline</span><span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::lcp_comp() called (@ 2022-05-28 18:12:36)... 
#&gt; ... Defining parameters... 
#&gt; ... Sampling n location pairs for each distance value... 
#&gt; ... ... Sampling for distance = 50... 
#&gt; ... ... ... Sampling starting locations... 
#&gt; ... ... ... Sampling ending locations... 
#&gt; ... ... Sampling for distance = 100... 
#&gt; ... ... ... Sampling starting locations... 
#&gt; ... ... ... Sampling ending locations... 
#&gt; ... Processing samples... 
#&gt; ... Determining barrier overlaps... 
#&gt; ... Implementing shortest-distance calculations... 
#&gt; ... ... Calculating shortest-distances via cppRouting::get_distance_pair() for 20 location pair(s) ... </div><div class='output co'>#&gt; <span class='message'>Running bidirectional Dijkstra...</span></div><div class='output co'>#&gt; ... Cleaning results... 
#&gt; ... flapper::lcp_comp() call completed (@ 2022-05-28 18:12:49) after ~0.22 minutes. </div><div class='input'>
<span class='co'>## Examine outputs</span>
<span class='co'># The function returns a dataframe</span>
<span class='fu'>utils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>out_1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 'data.frame':	20 obs. of  12 variables:
#&gt;  $ index      : int  1 2 3 4 5 6 7 8 9 10 ...
#&gt;  $ id         : int  1 2 3 4 5 6 7 8 9 10 ...
#&gt;  $ cell_x0    : num  705640 708160 705715 708340 707570 ...
#&gt;  $ cell_y0    : num  6265966 6268636 6266456 6268022 6265452 ...
#&gt;  $ cell_x1    : num  705675 708130 705710 708375 707530 ...
#&gt;  $ cell_y1    : num  6265926 6268682 6266406 6268056 6265426 ...
#&gt;  $ cell_id0   : num  1306098 478902 1154213 669588 1466134 ...
#&gt;  $ cell_id1   : num  1318505 464946 1169712 658745 1473876 ...
#&gt;  $ dist_sim   : num  50 50 50 50 50 50 50 50 50 50 ...
#&gt;  $ dist_euclid: num  53.2 54.1 50.2 49.5 47.2 ...
#&gt;  $ dist_lcp   : num  54.5 58.3 52.1 49.5 50.4 ...
#&gt;  $ barrier    : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...</div><div class='input'>
<span class='co'>## Visualise sampled locations on map</span>
<span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>bathy</span><span class='op'>)</span>
</div><div class='input'><span class='fu'>raster</span><span class='fu'>::</span><span class='fu'>lines</span><span class='op'>(</span><span class='va'>dat_coast</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>out_1</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/ncell.html'>nrow</a></span><span class='op'>(</span><span class='va'>out_1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>d</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/arrows.html'>arrows</a></span><span class='op'>(</span>x0 <span class='op'>=</span> <span class='va'>d</span><span class='op'>$</span><span class='va'>cell_x0</span>, y0 <span class='op'>=</span> <span class='va'>d</span><span class='op'>$</span><span class='va'>cell_y0</span>,
         x1 <span class='op'>=</span> <span class='va'>d</span><span class='op'>$</span><span class='va'>cell_x1</span>, y1 <span class='op'>=</span> <span class='va'>d</span><span class='op'>$</span><span class='va'>cell_y1</span>, length <span class='op'>=</span> <span class='fl'>0.01</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='lcp_comp-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Compare simulated, Euclidean and shortest distances</span>
<span class='va'>pp</span> <span class='op'>&lt;-</span> <span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html'>pretty_plot</a></span><span class='op'>(</span><span class='va'>out_1</span><span class='op'>$</span><span class='va'>dist_sim</span>, <span class='va'>out_1</span><span class='op'>$</span><span class='va'>dist_euclid</span>,
            xlab <span class='op'>=</span> <span class='st'>"Distance (simulated) [m]"</span>,
            ylab <span class='op'>=</span> <span class='st'>"Distance (Euclidean)[m]"</span><span class='op'>)</span>
<span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html'>pretty_plot</a></span><span class='op'>(</span><span class='va'>out_1</span><span class='op'>$</span><span class='va'>dist_euclid</span>, <span class='va'>out_1</span><span class='op'>$</span><span class='va'>dist_lcp</span>,
            xlab <span class='op'>=</span> <span class='st'>"Distance (Euclidean) [m]"</span>,
            ylab <span class='op'>=</span> <span class='st'>"Distance (shortest) [m]"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>
</div><div class='img'><img src='lcp_comp-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>pp</span><span class='op'>)</span>

<span class='co'>#### Example (2): Distance-vector-based implementation in parallel</span>
<span class='va'>out_2</span> <span class='op'>&lt;-</span> <span class='fu'>lcp_comp</span><span class='op'>(</span>surface <span class='op'>=</span> <span class='va'>bathy</span>,
                  distance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>100</span><span class='op'>)</span>,
                  graph <span class='op'>=</span> <span class='va'>bathy_graph</span>,
                  barrier <span class='op'>=</span> <span class='va'>coastline</span>,
                  cl <span class='op'>=</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span><span class='op'>(</span><span class='fl'>2L</span><span class='op'>)</span>
                  <span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::lcp_comp() called (@ 2022-05-28 18:12:49)... 
#&gt; ... Defining parameters... 
#&gt; ... Sampling n location pairs for each distance value... 
#&gt; ... Processing samples... 
#&gt; ... Determining barrier overlaps... 
#&gt; ... Implementing shortest-distance calculations... 
#&gt; ... ... Calculating shortest-distances via cppRouting::get_distance_pair() for 20 location pair(s) ... </div><div class='output co'>#&gt; <span class='message'>Running bidirectional Dijkstra...</span></div><div class='output co'>#&gt; ... Cleaning results... 
#&gt; ... flapper::lcp_comp() call completed (@ 2022-05-28 18:13:09) after ~0.33 minutes. </div><div class='input'>
<span class='co'>#### Example (3): Mobility-based implementation</span>

<span class='co'>## Implement function for mobility = 500</span>
<span class='va'>mob</span> <span class='op'>&lt;-</span> <span class='fl'>500</span>
<span class='va'>out_3</span> <span class='op'>&lt;-</span> <span class='fu'>lcp_comp</span><span class='op'>(</span>surface <span class='op'>=</span> <span class='va'>bathy</span>,
                  mobility <span class='op'>=</span> <span class='va'>mob</span>,
                  n <span class='op'>=</span> <span class='fl'>1000</span>,
                  graph <span class='op'>=</span> <span class='va'>bathy_graph</span>,
                  barrier <span class='op'>=</span> <span class='va'>coastline</span>
                  <span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::lcp_comp() called (@ 2022-05-28 18:13:09)... 
#&gt; ... Defining parameters... 
#&gt; ... Sampling n locations... 
#&gt; ... Calculating Euclidean distances between sampled locations... 
#&gt; ... Filtering by mobility... 
#&gt; ... Processing samples... 
#&gt; ... Determining barrier overlaps... 
#&gt; ... Implementing shortest-distance calculations... 
#&gt; ... ... Calculating shortest-distances via cppRouting::get_distance_pair() for 1000 location pair(s) ... </div><div class='output co'>#&gt; <span class='message'>Running bidirectional Dijkstra...</span></div><div class='output co'>#&gt; ... Cleaning results... 
#&gt; ... flapper::lcp_comp() call completed (@ 2022-05-28 18:13:15) after ~0.09 minutes. </div><div class='input'>
<span class='co'>## Visualise sampled locations on map</span>
<span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>bathy</span><span class='op'>)</span>
</div><div class='input'><span class='fu'>raster</span><span class='fu'>::</span><span class='fu'>lines</span><span class='op'>(</span><span class='va'>dat_coast</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>out_3</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/ncell.html'>nrow</a></span><span class='op'>(</span><span class='va'>out_3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>d</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/arrows.html'>arrows</a></span><span class='op'>(</span>x0 <span class='op'>=</span> <span class='va'>d</span><span class='op'>$</span><span class='va'>cell_x0</span>, y0 <span class='op'>=</span> <span class='va'>d</span><span class='op'>$</span><span class='va'>cell_y0</span>,
         x1 <span class='op'>=</span> <span class='va'>d</span><span class='op'>$</span><span class='va'>cell_x1</span>, y1 <span class='op'>=</span> <span class='va'>d</span><span class='op'>$</span><span class='va'>cell_y1</span>, length <span class='op'>=</span> <span class='fl'>0.01</span>, lwd <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='lcp_comp-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Compare Euclidean and shortest distances</span>
<span class='co'># Extract the data for the paths that do not versus do cross a barrier</span>
<span class='va'>out_3_barrier0</span> <span class='op'>&lt;-</span> <span class='va'>out_3</span><span class='op'>[</span><span class='va'>out_3</span><span class='op'>$</span><span class='va'>barrier</span> <span class='op'>==</span> <span class='fl'>0</span>, <span class='op'>]</span>
<span class='va'>out_3_barrier1</span> <span class='op'>&lt;-</span> <span class='va'>out_3</span><span class='op'>[</span><span class='va'>out_3</span><span class='op'>$</span><span class='va'>barrier</span> <span class='op'>==</span> <span class='fl'>1</span>, <span class='op'>]</span>
<span class='co'># Set up plotting window</span>
<span class='va'>pp</span> <span class='op'>&lt;-</span> <span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, oma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>)</span>, mar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>4</span>, <span class='fl'>4</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Results for paths that do not cross a barrier</span>
<span class='co'># ... Visualisation</span>
<span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html'>pretty_plot</a></span><span class='op'>(</span><span class='va'>out_3_barrier0</span><span class='op'>$</span><span class='va'>dist_euclid</span>, <span class='va'>out_3_barrier0</span><span class='op'>$</span><span class='va'>dist_lcp</span>,
            xlab <span class='op'>=</span> <span class='st'>"Distance (Euclidean) [m]"</span>,
            ylab <span class='op'>=</span> <span class='st'>"Distance (shortest) [m]"</span>,
            pch <span class='op'>=</span> <span class='st'>"."</span><span class='op'>)</span>
<span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
<span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='va'>mob</span>, col <span class='op'>=</span> <span class='st'>"royalblue"</span>, lty <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='co'># ... Euclidean distance parameter at which mobility is exceeded</span>
<span class='va'>limit0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>out_3_barrier0</span><span class='op'>$</span><span class='va'>dist_euclid</span><span class='op'>[</span><span class='va'>out_3_barrier0</span><span class='op'>$</span><span class='va'>dist_lcp</span> <span class='op'>&gt;</span> <span class='va'>mob</span><span class='op'>]</span><span class='op'>)</span>; <span class='va'>limit0</span>
</div><div class='output co'>#&gt; [1] 451.276</div><div class='input'><span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v <span class='op'>=</span> <span class='va'>limit0</span>, col <span class='op'>=</span> <span class='st'>"royalblue"</span>, lty <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='co'># Results for paths that cross a barrier</span>
<span class='co'># ... Visualisation</span>
<span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html'>pretty_plot</a></span><span class='op'>(</span><span class='va'>out_3_barrier1</span><span class='op'>$</span><span class='va'>dist_euclid</span>, <span class='va'>out_3_barrier1</span><span class='op'>$</span><span class='va'>dist_lcp</span>,
           xlab <span class='op'>=</span> <span class='st'>"Distance (Euclidean) [m]"</span>,
           ylab <span class='op'>=</span> <span class='st'>"Distance (shortest) [m]"</span>,
           pch <span class='op'>=</span> <span class='st'>"."</span><span class='op'>)</span>
</div><div class='input'><span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='va'>mob</span>, col <span class='op'>=</span> <span class='st'>"royalblue"</span>, lty <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='input'><span class='co'># ... Euclidean distance parameter at which mobility is exceeded</span>
<span class='va'>limit1</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>out_3_barrier1</span><span class='op'>$</span><span class='va'>dist_euclid</span><span class='op'>[</span><span class='va'>out_3_barrier1</span><span class='op'>$</span><span class='va'>dist_lcp</span> <span class='op'>&gt;</span> <span class='va'>mob</span><span class='op'>]</span><span class='op'>)</span>; <span class='va'>limit1</span>
</div><div class='output co'>#&gt; [1] 404.0111</div><div class='input'><span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v <span class='op'>=</span> <span class='va'>limit1</span>, col <span class='op'>=</span> <span class='st'>"royalblue"</span>, lty <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='img'><img src='lcp_comp-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>pp</span><span class='op'>)</span>

<span class='co'>## Plot the difference between Euclidean and shortest distances with distance</span>
<span class='va'>pp</span> <span class='op'>&lt;-</span> <span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, oma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>)</span>, mar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>4</span>, <span class='fl'>4</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html'>pretty_plot</a></span><span class='op'>(</span><span class='va'>out_3_barrier0</span><span class='op'>$</span><span class='va'>dist_euclid</span>,
            <span class='va'>out_3_barrier0</span><span class='op'>$</span><span class='va'>dist_lcp</span> <span class='op'>-</span> <span class='va'>out_3_barrier0</span><span class='op'>$</span><span class='va'>dist_euclid</span>,
            xlab <span class='op'>=</span> <span class='st'>"Distance (Euclidean) [m]"</span>,
            ylab <span class='op'>=</span> <span class='st'>"Distance (shortest - Euclidean) [m]"</span>,
            pch <span class='op'>=</span> <span class='st'>"."</span><span class='op'>)</span>
<span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html'>pretty_plot</a></span><span class='op'>(</span><span class='va'>out_3_barrier1</span><span class='op'>$</span><span class='va'>dist_euclid</span>,
            <span class='va'>out_3_barrier1</span><span class='op'>$</span><span class='va'>dist_lcp</span> <span class='op'>-</span> <span class='va'>out_3_barrier1</span><span class='op'>$</span><span class='va'>dist_euclid</span>,
            xlab <span class='op'>=</span> <span class='st'>"Distance (Euclidean) [m]"</span>,
            ylab <span class='op'>=</span> <span class='st'>"Distance (shortest - Euclidean) [m]"</span>,
            pch <span class='op'>=</span> <span class='st'>"."</span><span class='op'>)</span>
</div><div class='img'><img src='lcp_comp-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>pp</span><span class='op'>)</span>

<span class='co'>## Approximate shortest distances using a model based on Euclidean distances</span>
<span class='co'># Fit model</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>dist_lcp</span> <span class='op'>~</span> <span class='fl'>0</span> <span class='op'>+</span> <span class='va'>dist_euclid</span><span class='op'>:</span><span class='va'>barrier</span>, data <span class='op'>=</span> <span class='va'>out_3</span><span class='op'>)</span>
<span class='co'># Examine model predictions</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>500</span><span class='op'>)</span>
<span class='va'>nd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>barrier <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fl'>0</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>, dist_euclid <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span>
<span class='va'>ci</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/list_CIs.html'>list_CIs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>mod</span>, <span class='va'>nd</span>, se.fit <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/pretty_plot.html'>pretty_plot</a></span><span class='op'>(</span><span class='va'>out_3</span><span class='op'>$</span><span class='va'>dist_euclid</span>, <span class='va'>out_3</span><span class='op'>$</span><span class='va'>dist_lcp</span>,
                            col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"grey"</span>, <span class='st'>"darkred"</span><span class='op'>)</span><span class='op'>[</span><span class='va'>out_3</span><span class='op'>$</span><span class='va'>barrier</span><span class='op'>]</span>,
                            cex <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>1.5</span><span class='op'>)</span><span class='op'>[</span><span class='va'>out_3</span><span class='op'>$</span><span class='va'>barrier</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/add_error_envelope.html'>add_error_envelope</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>ci</span><span class='op'>)</span>
</div><div class='input'><span class='va'>nd</span><span class='op'>$</span><span class='va'>barrier</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fl'>1</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ci</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/list_CIs.html'>list_CIs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>mod</span>, <span class='va'>nd</span>, se.fit <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://edwardlavender.github.io/prettyGraphics/reference/add_error_envelope.html'>add_error_envelope</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>ci</span>,
                   add_fit <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>,
                   add_ci <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/alpha.html'>alpha</a></span><span class='op'>(</span><span class='st'>"red"</span>, <span class='fl'>0.5</span><span class='op'>)</span>,
                                 border <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='lcp_comp-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Define predictive model based on this analysis</span>
<span class='va'>lcp_predict</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>m</span>, <span class='va'>barrier</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/stopifnot.html'>stopifnot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>2L</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/stopifnot.html'>stopifnot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>barrier</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>*</span> <span class='va'>x</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>barrier</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>m</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>*</span> <span class='va'>x</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>barrier</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


