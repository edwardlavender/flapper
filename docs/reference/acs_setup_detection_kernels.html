<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Setup detection probability kernels for the AC* algorithm(s) — acs_setup_detection_kernels • flapper</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Setup detection probability kernels for the AC* algorithm(s) — acs_setup_detection_kernels"><meta property="og:description" content="This function produces detection probability kernels for incorporation into the acoustic-container* (AC*) algorithms. Within acoustic containers, the incorporation of detection probability kernels reduces uncertainty and increases precision in simulated patterns of space use by up-weighting areas nearer to receivers when an individual is detected and down-weighing areas nearer to receivers when an individual is not detected (see Details).
To implement the function, a SpatialPointsDataFrame that defines receiver IDs, locations and deployment dates must be supplied (via xy). A record of servicing events for receivers can also be supplied (via services). Detection probability kernels are calculated around each receiver, using a user-defined function based on Euclidean distances (calc_detection_pr) across a raster (bathy). Kernels can be restricted by barriers to movement as defined by NAs in bathy and the boundaries of the area. These kernels are used to weight possible locations around a receiver when an individual is detected.
For each unique array design (i.e. set of active receivers, given receiver deployment dates and servicing events, if applicable), a detection probability surface across the whole area is also created, which is used to weight possible locations of the individual in the time steps between detections (up-weighting locations away from receivers). By default, these calculations account for any areas of overlap in the detection probability kernels of multiple receivers. This step is computationally demanding, but it can be suppressed or sped-up via the overlaps argument. Outputs are returned in a named list that is designed to be incorporated into the AC* algorithm(s)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/flapper_algorithms_faqs.html">`flapper`: practitioner FAQs</a>
    </li>
    <li>
      <a href="../articles/flapper_overview.html">`flapper`: an overview</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edwardlavender/flapper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Setup detection probability kernels for the AC* algorithm(s)</h1>
    <small class="dont-index">Source: <a href="https://github.com/edwardlavender/flapper/blob/HEAD/R/acs_setup.R" class="external-link"><code>R/acs_setup.R</code></a></small>
    <div class="hidden name"><code>acs_setup_detection_kernels.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function produces detection probability kernels for incorporation into the acoustic-container* (AC*) algorithms. Within acoustic containers, the incorporation of detection probability kernels reduces uncertainty and increases precision in simulated patterns of space use by up-weighting areas nearer to receivers when an individual is detected and down-weighing areas nearer to receivers when an individual is not detected (see Details).</p>
<p>To implement the function, a <code><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></code> that defines receiver IDs, locations and deployment dates must be supplied (via <code>xy</code>). A record of servicing events for receivers can also be supplied (via <code>services</code>). Detection probability kernels are calculated around each receiver, using a user-defined function based on Euclidean distances (<code>calc_detection_pr</code>) across a <code><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></code> (<code>bathy</code>). Kernels can be restricted by barriers to movement as defined by <code>NAs</code> in <code>bathy</code> and the boundaries of the area. These kernels are used to weight possible locations around a receiver when an individual is detected.</p>
<p>For each unique array design (i.e. set of active receivers, given receiver deployment dates and servicing events, if applicable), a detection probability surface across the whole area is also created, which is used to weight possible locations of the individual in the time steps between detections (up-weighting locations away from receivers). By default, these calculations account for any areas of overlap in the detection probability kernels of multiple receivers. This step is computationally demanding, but it can be suppressed or sped-up via the <code>overlaps</code> argument. Outputs are returned in a named list that is designed to be incorporated into the AC* algorithm(s).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">acs_setup_detection_kernels</span><span class="op">(</span></span>
<span>  <span class="va">xy</span>,</span>
<span>  services <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">containers</span>,</span>
<span>  overlaps <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">calc_detection_pr</span>,</span>
<span>  <span class="va">bathy</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>xy</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></code> that defines receiver IDs, locations and deployment dates. The <code>data</code> slot must include a dataframe with the following columns: an unique, integer identifier for each receiver (`receiver_id') and receiver deployment <code><a href="https://rdrr.io/r/base/Dates.html" class="external-link">Dates</a></code> (`receiver_start_date' and `receiver_end_date'). For receiver locations, the coordinate reference system should be the Universal Transverse Mercator system with distances in metres (as for <code>bathy</code>, below).</p></dd>


<dt>services</dt>
<dd><p>(optional) A dataframe that defines receiver IDs and servicing <code><a href="https://rdrr.io/r/base/Dates.html" class="external-link">Dates</a></code> (times during the deployment period of a receiver when it was not active due to servicing). If provided, this must contain the following columns: an integer identifier for serviced receivers (named ‘receiver_id’) and two columns that define the time of the service(s) (‘service_start_date’ and ‘service_end_date’) (see <code><a href="make_matrix_receivers.html">make_matrix_receivers</a></code>).</p></dd>


<dt>containers</dt>
<dd><p>The list of detection containers, with one element for each number from <code>1:max(xy$receiver_id)</code>, from <code><a href="acs_setup_containers.html">acs_setup_containers</a></code>.</p></dd>


<dt>overlaps</dt>
<dd><p>(optional) A named list, from <code><a href="get_detection_containers_overlap.html">get_detection_containers_overlap</a></code>, that defines, for each receiver, for each day over its deployment period, whether or not its detection container overlapped with those of other receivers. If provided, this speeds up detection probability calculations in overlapping regions by focusing on only the subset of receivers with overlapping detection probability kernels. If there are no overlapping receivers, <code>FALSE</code> can be supplied instead to suppress these calculations.</p></dd>


<dt>calc_detection_pr</dt>
<dd><p>A function that takes in a vector of distances and returns a vector of detection probabilities (around a receiver). Detection probability should decline to 0 after the <code>detection_range</code> distance from a receiver (see <code><a href="acs_setup_containers.html">acs_setup_containers</a></code>).</p></dd>


<dt>bathy</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></code> of the bathymetry across an area (see <code><a href="ac.html">ac</a></code>). Receiver locations and detection probability kernels are represented across this <code><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></code>. As for <code>xy</code>, the coordinate reference system should be the Universal Transverse Mercator system with distances in metres. Resolution needs to be sufficiently high such that detection probability can be represented effectively, given <code>calc_detection_pr</code>, but sufficiently low for convenient run times. If <code>bathy</code> contains NAs, it is also taken as a mask that is applied to detection probability kernels to remove `impossible` areas (e.g., on land).</p></dd>


<dt>verbose</dt>
<dd><p>A logical input that defines whether or not to print messages to the console to relay function progress.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function returns a named list with five elements:</p><ol><li><p><strong>receiver_specific_kernels.</strong> A list, with one element for all integers from 1 to the maximum receiver number. Any elements that do not correspond to receivers contain a <code>NULL</code> element. List elements that correspond to receivers contain a <code><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></code> of the detection probability kernel around the relevant receiver. Cells values define the detection probability around a receiver, given <code>calc_detection_pr</code>. In the AC* algorithm(s), these kernels are used to up-weight location probabilities near to a receiver when it is detected (following modification to account for overlapping areas, if necessary).</p></li>
<li><p><strong>receiver_specific_inv_kernels.</strong> A list, as for <code>receiver_specific_kernels</code>, but in which elements contain the inverse detection probability kernels (i.e., 1 - detection probability). In the AC* algorithm(s), these is used to down-weight-weight location probabilities in the overlapping regions between a receiver that recorded detections and others that did not at the same time.</p></li>
<li><p><strong>array_design_intervals.</strong> A dataframe that defines the number and deployment times of each unique array design, resulting from receiver deployment, servicing and removal. In the times between detections, this is used to select the appropriate `background' detection probability surface (see below). This contains the following columns:</p><ul><li><p><code>array_id</code> An integer vector that defines each unique array design.</p></li>
<li><p><code>array_start_date</code> A Date that defines the start date of each array design.</p></li>
<li><p><code>array_end_date</code> A Date that defines the end date of each array design.</p></li>
<li><p><code>array_interval</code> An <code><a href="https://lubridate.tidyverse.org/reference/Interval-class.html" class="external-link">Interval-class</a></code> vector that defines the deployment period of each array design.</p></li>
</ul></li>
<li><p><strong>bkg_surface_by_design.</strong> A list, with one element for each array design, that defines the detection probability surface across all receivers deployed in that phase of the study. In areas that are covered by the detection probability kernel of a single receiver, the detection probability depends only on distance to that receiver (via <code>calc_detection_pr</code>). In areas covered by multiple, overlapping kernels, detection probability represents the combined detection probability across all overlapping kernels (see Details).</p></li>
<li><p><strong>bkg_inv_surface_by_design.</strong> A list, as above for <code>bkg_surface_by_design</code>, but which contains the inverse detection probability surface (i.e., 1 - <code>bkg_surface_by_design</code>). In the AC* algorithm(s), this is used to up-weight areas away from receivers (or, equivalently, down-weight areas near to receivers) in the time steps between detections.</p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    <p>A detection probability kernel is a bivariate probability density function that describes detection probability around a receiver. Typically, this takes the shape of a dome whereby detection probability declines uniformly around a receiver with increasing distance. Accordingly, this function assumes that detection probability kernels only depend on distance (via <code>calc_detection_pr</code>) and are constant in space and time. Spatially variable detection probability kernels can be incorporated just as easily into the AC* algorithm(s) but need to be created manually. For example, in areas of complex coastline, narrow peninsulas that punctuate detection containers may effectively block transmissions from the outer regions of detection containers from being detected at receivers, in which case a model that incorporates the `line of sight' between receivers and the surrounding regions may be appropriate. However, temporally variable detection probability kernels are not currently supported by the AC* algorithm(s).</p>
<p>The purpose of detection probability kernels within the AC* algorithm(s) is to reduce the uncertainty of the possible positions of an individual within the acoustic containers, both when an individual is detected and when it is not. When an individual is detected at a receiver, a central assumption of the AC* algorithm(s) is that the individual is within a finite radius of that receiver in an area defined as the ‘detection container’. Under the simplest implementation of the algorithm, this represents a threshold detection probability model in which the probability of detection is certain within the container and zero outside. Under this model, the individual is equally likely to have been in any location within the container and all possible locations of the individual are weighted equally. This approach is suitable for the most conservative analyses, since even unlikely positions of the individual receive equal weighting. However, detection probability typically declines with distance around a receiver and the incorporation of this information in the form of kernels around the receiver at which is detected (and any receivers with overlapping kernels) improve precision by increasing the weighting for some areas over others. The way in which this increase in precision is realised over space depends on whether or not detection probability kernels and the timing of detections at multiple receivers overlap.</p>
<p>In the simplest scenario, an individual is detected at a receiver whose container does not overlap with any other receiver and the kernel simply increases the weight of locations nearest to the receiver (according to a user-specified detection probability function). For some array designs, an alternative possibility is that an individual is detected at a receiver whose container overlaps with other receiver(s). In this case, detection or lack of detection at the same moment at the receivers with overlapping containers provides further information on the location of the individual. One the one hand, if the individual is not detected at the other receiver(s), then the probability that the individual is in the overlapping region(s) is reduced in line with the overlap in detection probability, which decreases the weight of potential locations in these areas. On the other hand, if the individual is detected at effectively the same time at multiple receiver(s), then the individual is more likely to be within the overlapping parts of their containers, and the weight of possible locations here is correspondingly elevated. The definition of ‘effectively’ is context specific but depends on the accuracy with which the clocks of different receivers are synchronised. (For example, ± 5 s might be reasonable.) In these situations, the detection container essentially just acts as a computational device by restricting calculations to the container(s) and ‘cutting’ the probability of detection to zero beyond this area. This process follows the standard rules of probability.</p>
<p>When an individual is not detected, the detection container grows into a set of ‘acoustic containers’ that contain the set of possible locations for the individual. As they grow, they may encompass other detection containers before they shrink towards the receiver at which the individual is next detected. During this time, the AC* algorithm(s) identify the possible locations of the individual within these areas. Under the most conservative approach, at each time step all positions are treated as equally likely (although normalisation within the algorithm(s) effectively down-weights time steps in which the location of the individual is more uncertain). This includes any positions within the detection containers of other receivers since, under realistic conditions, there is usually a non-zero probability that an individual can be near a receiver and yet remain undetected. However, this is typically unlikely and when the goal of the analysis is to create more precise estimates of space use, the incorporation of detection probability kernel(s) around receivers effectively reduces the probability that the individual is within their detection containers during this time. Again, to incorporate detection probability kernels in this way, it is necessary to account for overlapping detection ranges, where the probability of detection is higher and, therefore, the probability of a possible location in such an area is lower given the absence of a detection. As above, this process follows the laws of probability.</p>
<p>In summary, in the AC* algorithm(s), detection and acoustic containers describe the spatial extent of our uncertainty when an individual is detected and in the time between detections respectively. The purpose of this function is to pre-process and package the information provided by detection probability kernels in such a way as to facilitate its incorporation into the AC* algorithm(s). This improves the precision of simulated patterns of space use by down- or up-weighting areas according to a model of detection probability. This provides a reasonable overall assessment of the places in which an individual could have spend more or less time over a period of study.</p>
<p>However, it is worth noting that, within acoustic containers, unrealistic areas may be highlighted in which an individual could not have been located because of movement constraints which are not captured by container-level expansion and contraction. For example, there may be parts of a container that are highly unlikely given a detection at a nearby receiver because they are too far away from the receiver at which the individual was subsequently detected. In the AC*PF algorithm(s), the incorporation of a movement model further reduces uncertainty by accounting for the constraints imposed by an individual’s current position on its next position.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>This is one of a number of functions used to set up the AC and ACDC algorithms implemented by <code><a href="ac.html">ac</a></code> and <code><a href="acdc.html">acdc</a></code>: <code><a href="acs_setup_mobility.html">acs_setup_mobility</a></code>, <code><a href="acs_setup_containers.html">acs_setup_containers</a></code> and <code>acs_setup_detection_kernels</code>. This function is supported by <code><a href="make_matrix_receivers.html">make_matrix_receivers</a></code>, which defines receiver activity statuses; <code><a href="acs_setup_containers.html">acs_setup_containers</a></code>, which defines acoustic containers; and <code><a href="get_detection_containers_overlap.html">get_detection_containers_overlap</a></code>, which defines detection container overlaps</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edward Lavender</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#### Set up data for examples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define receiver IDs, locations and deployment dates</span></span></span>
<span class="r-in"><span><span class="co"># Focus on a subset of receivers for example speed</span></span></span>
<span class="r-in"><span><span class="va">moorings</span> <span class="op">&lt;-</span> <span class="va">dat_moorings</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># Define receiver locations as a SpatialPoints object with a UTM CRS</span></span></span>
<span class="r-in"><span><span class="va">proj_wgs84</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span>SRS_string <span class="op">=</span> <span class="st">"EPSG:4326"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">proj_utm</span>   <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span>SRS_string <span class="op">=</span> <span class="st">"EPSG:32629"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPoints</a></span><span class="op">(</span><span class="va">moorings</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"receiver_long"</span>, <span class="st">"receiver_lat"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                        <span class="va">proj_wgs84</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spTransform.html" class="external-link">spTransform</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">proj_utm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Link receiver IDs, locations and deployment dates to form a SpatialPointsDataFrame</span></span></span>
<span class="r-in"><span><span class="co"># ... Note required column names and class types.</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">moorings</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"receiver_id"</span>,</span></span>
<span class="r-in"><span>                                                  <span class="st">"receiver_start_date"</span>,</span></span>
<span class="r-in"><span>                                                  <span class="st">"receiver_end_date"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define bathymetric map of area for which AC* algorithm(s) will be implemented</span></span></span>
<span class="r-in"><span><span class="co"># ... The resolution must be sufficiently high</span></span></span>
<span class="r-in"><span><span class="co"># ... such that there are areas with non zero detection probability.</span></span></span>
<span class="r-in"><span><span class="co"># ... However, function speed will fall with large, high resolution rasters.</span></span></span>
<span class="r-in"><span><span class="co"># ... Here, we set a low resolution for example speed.</span></span></span>
<span class="r-in"><span><span class="va">surface</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="va">dat_gebco</span><span class="op">)</span>, res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">surface</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/resample.html" class="external-link">resample</a></span><span class="op">(</span><span class="va">dat_gebco</span>, <span class="va">surface</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define detection probability function</span></span></span>
<span class="r-in"><span><span class="co"># This should depend on distance alone</span></span></span>
<span class="r-in"><span><span class="co"># Detection probability should decline to 0 after detection_range</span></span></span>
<span class="r-in"><span><span class="co"># ... (defined in flapper::acs_setup_containers()).</span></span></span>
<span class="r-in"><span><span class="co"># ... Here, we assume detection_range = 425 m.</span></span></span>
<span class="r-in"><span><span class="va">calc_dpr</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="fl">425</span>, <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">2.5</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.02</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, <span class="fu">calc_dpr</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="acs_setup_detection_kernels-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get detection containers and, if applicable, information on their overlap(s)</span></span></span>
<span class="r-in"><span><span class="co"># We'll use the example containers provided in dat_containers</span></span></span>
<span class="r-in"><span><span class="co"># We'll get their overlaps via flapper::get_detection_containers_overlap</span></span></span>
<span class="r-in"><span><span class="va">overlaps</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="get_detection_containers_overlap.html">get_detection_containers_overlap</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    containers <span class="op">=</span> <span class="fu"><a href="get_detection_containers.html">get_detection_containers</a></span><span class="op">(</span>xy <span class="op">=</span> <span class="va">xy</span>, byid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>GEOS support is provided by the sf and terra packages among others</span>
<span class="r-plt img"><img src="acs_setup_detection_kernels-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (1): Implement function using default options</span></span></span>
<span class="r-in"><span><span class="va">kernels</span> <span class="op">&lt;-</span> <span class="fu">acs_setup_detection_kernels</span><span class="op">(</span>xy <span class="op">=</span> <span class="va">xy</span>,</span></span>
<span class="r-in"><span>                                       containers <span class="op">=</span> <span class="va">dat_containers</span>,</span></span>
<span class="r-in"><span>                                       overlaps <span class="op">=</span> <span class="va">overlaps</span>,</span></span>
<span class="r-in"><span>                                       calc_detection_pr <span class="op">=</span> <span class="va">calc_dpr</span>,</span></span>
<span class="r-in"><span>                                       bathy <span class="op">=</span> <span class="va">surface</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flapper::acs_setup_detection_kernels() called (@ 2023-02-19 14:52:05)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up function... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Getting receiver-specific kernels (for detection)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... For receiver 3 ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Isolating detection container ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Calculating distances from the receiver ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Calculating detection probability ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Processing kernel ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... For receiver 4 ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Isolating detection container ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Calculating distances from the receiver ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Calculating detection probability ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Processing kernel ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... For receiver 7 ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Isolating detection container ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Calculating distances from the receiver ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Calculating detection probability ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Processing kernel ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... For receiver 9 ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Isolating detection container ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Calculating distances from the receiver ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Calculating detection probability ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Processing kernel ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... For receiver 11 ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Isolating detection container ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Calculating distances from the receiver ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Calculating detection probability ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Processing kernel ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Getting receiver-specific inverse kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Getting area-wide kernels (for non-detection)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Get unique array designs... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Get area wide kernels for each array design... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 1/5... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extract detection probability kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining detection kernels to calculate the background detection probability surfaces (this is a slow step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 2/5... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extract detection probability kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining detection kernels to calculate the background detection probability surfaces (this is a slow step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 3/5... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extract detection probability kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining detection kernels to calculate the background detection probability surfaces (this is a slow step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 4/5... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extract detection probability kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining detection kernels to calculate the background detection probability surfaces (this is a slow step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 5/5... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extract detection probability kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining detection kernels to calculate the background detection probability surfaces (this is a slow step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Process detection probability kernels ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... flapper::acs_setup_detection_kernels() call completed (@ 2023-02-19 14:52:07) after ~0.03 minutes. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine list elements</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">kernels</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                               Length Class      Mode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> receiver_specific_kernels     11     -none-     list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> receiver_specific_inv_kernels 11     -none-     list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> array_design_intervals         4     data.frame list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bkg_surface_by_design          5     -none-     list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bkg_inv_surface_by_design      5     -none-     list</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine example receiver-specific kernels</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kernels</span><span class="op">$</span><span class="va">receiver_specific_kernels</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">xy</span><span class="op">[</span><span class="va">xy</span><span class="op">$</span><span class="va">receiver_id</span> <span class="op">==</span> <span class="fl">3</span>, <span class="op">]</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kernels</span><span class="op">$</span><span class="va">receiver_specific_kernels</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">xy</span><span class="op">[</span><span class="va">xy</span><span class="op">$</span><span class="va">receiver_id</span> <span class="op">==</span> <span class="fl">4</span>, <span class="op">]</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="acs_setup_detection_kernels-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine example receiver-specific inverse kernels</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kernels</span><span class="op">$</span><span class="va">receiver_specific_inv_kernels</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">xy</span><span class="op">[</span><span class="va">xy</span><span class="op">$</span><span class="va">receiver_id</span> <span class="op">==</span> <span class="fl">3</span>, <span class="op">]</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kernels</span><span class="op">$</span><span class="va">receiver_specific_inv_kernels</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">xy</span><span class="op">[</span><span class="va">xy</span><span class="op">$</span><span class="va">receiver_id</span> <span class="op">==</span> <span class="fl">4</span>, <span class="op">]</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="acs_setup_detection_kernels-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine background detection Pr surfaces</span></span></span>
<span class="r-in"><span><span class="co"># (for each unique combination of receivers that were deployed)</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">kernels</span><span class="op">$</span><span class="va">bkg_surface_by_design</span>, <span class="kw">function</span><span class="op">(</span><span class="va">bkg</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bkg</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="acs_setup_detection_kernels-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine background inverse detection Pr surfaces</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">kernels</span><span class="op">$</span><span class="va">bkg_inv_surface_by_design</span>, <span class="kw">function</span><span class="op">(</span><span class="va">bkg</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bkg</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="acs_setup_detection_kernels-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

