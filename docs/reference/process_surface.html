<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Process a Raster* by aggregation and quantify the error induced by this process — process_surface • flapper</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Process a Raster* by aggregation and quantify the error induced by this process — process_surface" />
<meta property="og:description" content="This function reduces the resolution of a raster by multiple aggregation methods and then quantifies the relative error induced by each method from the differences between the original values and the aggregated values. To implement the function, a raster (x) must be supplied as well as an aggregation factor (fact) and a named list of functions (stat) used to aggregate the raster. The raster is aggregated using each method (function) and mapped back onto the original resolution for calculation of the differences between the original raster and the aggregated raster(s). The function returns a visual statistical summary of the differences (if plot = TRUE) and a named list comprising the aggregated raster(s) and the re-sampled version(s) of those mapped back onto the original resolution." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/flapper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/edwardlavender/flapper/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Process a Raster* by aggregation and quantify the error induced by this process</h1>
    <small class="dont-index">Source: <a href='https://github.com/edwardlavender/flapper/blob/master/R/processing.R'><code>R/processing.R</code></a></small>
    <div class="hidden name"><code>process_surface.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function reduces the resolution of a <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> by multiple aggregation methods and then quantifies the relative error induced by each method from the differences between the original values and the aggregated values. To implement the function, a <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> (<code>x</code>) must be supplied as well as an aggregation factor (<code>fact</code>) and a named list of functions (<code>stat</code>) used to aggregate the <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code>. The <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> is aggregated using each method (function) and mapped back onto the original resolution for calculation of the differences between the original <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> and the aggregated <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code>(s). The function returns a visual statistical summary of the differences (if <code>plot = TRUE</code>) and a named list comprising the aggregated <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code>(s) and the re-sampled version(s) of those mapped back onto the original resolution.</p>
    </div>

    <pre class="usage"><span class='fu'>process_surface</span><span class='op'>(</span>
  <span class='va'>x</span>,
  fact <span class='op'>=</span> <span class='fl'>2L</span>,
  stat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='va'>mean</span><span class='op'>)</span>,
  <span class='va'>...</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  cl <span class='op'>=</span> <span class='cn'>NULL</span>,
  varlist <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> to be processed. For implementations preceding a call to of one of <code><a href='flapper.html'>flapper</a></code>'s particle filtering algorithms, <code>x</code> should be planar (i.e., Universal Transverse Mercator projection) with equal resolution in the x, y directions and identical units in the x, y and z directions (see <code><a href='pf.html'>pf</a></code>).</p></td>
    </tr>
    <tr>
      <th>fact</th>
      <td><p>A positive integer that defines by how much <code>x</code> should be aggregated (see <code><a href='https://rdrr.io/pkg/raster/man/aggregate.html'>aggregate</a></code>).</p></td>
    </tr>
    <tr>
      <th>stat</th>
      <td><p>A named list of functions used to aggregate <code>x</code> (see the <code>fun</code> argument of <code><a href='https://rdrr.io/pkg/raster/man/aggregate.html'>aggregate</a></code>).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code><a href='https://rdrr.io/pkg/raster/man/aggregate.html'>aggregate</a></code> to control aggregation.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>A logical input that defines whether or not to plot a summary of the differences between the original <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> (<code>x</code>) and the aggregated <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code>(s). If specified, the minimum, median and maximum difference are shown for each statistic (<code>stat</code>).</p></td>
    </tr>
    <tr>
      <th>cl, varlist</th>
      <td><p>(optional) Parallelisation options. <code>cl</code> is (a) a cluster object from <code><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></code> or (b) an integer that defines the number of child processes. <code>varlist</code> is a character vector of variables for export (see <code><a href='cl.html'>cl_export</a></code>). Exported variables must be located in the global environment. If a cluster is supplied, the connection to the cluster is closed within the function (see <code><a href='cl.html'>cl_stop</a></code>). For further information, see <code><a href='cl.html'>cl_lapply</a></code> and <code><a href='flapper-tips-parallel.html'>flapper-tips-parallel</a></code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical input that defines whether or not to print messages to the console to relay function progress.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns a plot of the differences between the original and aggregated <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code>(s), if <code>plot = TRUE</code>, and a named list of (a) the aggregated <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code>(s) (`agg_by_stat'), (b) the aggregated, resampled <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code>(s) (`agg_by_stat_rs') and (c) the summary statistics plotted.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function was motivated by the particle filtering algorithms in <code><a href='flapper.html'>flapper</a></code> (e.g., <code><a href='pf.html'>pf</a></code>). For these algorithms, it is computationally beneficial to reduce <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> resolution, where possible, by aggregation. To facilitate this process, this function quantifies the relative error induced by different aggregation functions. If appropriate, the particle filtering algorithm(s) can then be implemented using the aggregated <code><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></code> that minimises the error, with the magnitude of that error propagated via the <code>depth_error</code> parameter.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/raster/man/aggregate.html'>aggregate</a></code>, <code><a href='https://rdrr.io/pkg/raster/man/resample.html'>resample</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Edward Lavender</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Define the raster for which to implement the function</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>dat_gebco</span>
<span class='va'>blank</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, crs <span class='op'>=</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/projection.html'>crs</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, resolution <span class='op'>=</span> <span class='fl'>250</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/resample.html'>resample</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>blank</span>, method <span class='op'>=</span> <span class='st'>"bilinear"</span><span class='op'>)</span>
<span class='co'># Implement function using a list of statistics</span>
<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'>process_surface</span><span class='op'>(</span><span class='va'>x</span>, fact <span class='op'>=</span> <span class='fl'>2</span>, stat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>min <span class='op'>=</span> <span class='va'>min</span>, mean <span class='op'>=</span> <span class='va'>mean</span>, median <span class='op'>=</span> <span class='va'>median</span>, max <span class='op'>=</span> <span class='va'>max</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; flapper::process_surface() called (@ 2021-12-02 14:45:49)... 
#&gt; ... Aggregating raster... 
#&gt; ... Resampling aggregated raster(s) back onto the original resolution... 
#&gt; ... Computing differences between the original and aggregated raster(s)... 
#&gt; ... Summarising the differences between rasters across statistic(s)... </div><div class='output co'>#&gt; <span class='message'>pretty$n greater than the number of factor levels; resetting n to be the total number of factor levels.</span></div><div class='output co'>#&gt; <span class='message'>x values converted to a number for plotting.</span></div><div class='img'><img src='process_surface-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; ... flapper::process_surface() call completed (@ 2021-12-02 14:45:50) after ~0 minutes. </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                     Length Class      Mode
#&gt; agg_by_stat         4      -none-     list
#&gt; agg_by_stat_rs_diff 4      -none-     list
#&gt; summary_stats       4      data.frame list</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


